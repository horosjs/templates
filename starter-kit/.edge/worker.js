(()=>{var Uu=Object.create;var hs=Object.defineProperty;var Fu=Object.getOwnPropertyDescriptor;var Nu=Object.getOwnPropertyNames;var Du=Object.getPrototypeOf,Mu=Object.prototype.hasOwnProperty;var Bu=(t,e)=>()=>(t&&(e=t(t=0)),e);var me=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Hu=(t,e)=>{for(var r in e)hs(t,r,{get:e[r],enumerable:!0})},Vu=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Nu(e))!Mu.call(t,s)&&s!==r&&hs(t,s,{get:()=>e[s],enumerable:!(n=Fu(e,s))||n.enumerable});return t};var ye=(t,e,r)=>(r=t!=null?Uu(Du(t)):{},Vu(e||!t||!t.__esModule?hs(r,"default",{value:t,enumerable:!0}):r,t));var Go=me(S=>{"use strict";var rr=Symbol.for("react.element"),Wu=Symbol.for("react.portal"),Ju=Symbol.for("react.fragment"),Gu=Symbol.for("react.strict_mode"),Ku=Symbol.for("react.profiler"),Zu=Symbol.for("react.provider"),Qu=Symbol.for("react.context"),Xu=Symbol.for("react.forward_ref"),Yu=Symbol.for("react.suspense"),ec=Symbol.for("react.memo"),tc=Symbol.for("react.lazy"),Fo=Symbol.iterator;function rc(t){return t===null||typeof t!="object"?null:(t=Fo&&t[Fo]||t["@@iterator"],typeof t=="function"?t:null)}var Mo={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bo=Object.assign,Ho={};function vt(t,e,r){this.props=t,this.context=e,this.refs=Ho,this.updater=r||Mo}vt.prototype.isReactComponent={};vt.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vt.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Vo(){}Vo.prototype=vt.prototype;function ps(t,e,r){this.props=t,this.context=e,this.refs=Ho,this.updater=r||Mo}var ms=ps.prototype=new Vo;ms.constructor=ps;Bo(ms,vt.prototype);ms.isPureReactComponent=!0;var No=Array.isArray,zo=Object.prototype.hasOwnProperty,ys={current:null},Wo={key:!0,ref:!0,__self:!0,__source:!0};function Jo(t,e,r){var n,s={},o=null,i=null;if(e!=null)for(n in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)zo.call(e,n)&&!Wo.hasOwnProperty(n)&&(s[n]=e[n]);var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:rr,type:t,key:o,ref:i,props:s,_owner:ys.current}}function nc(t,e){return{$$typeof:rr,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function gs(t){return typeof t=="object"&&t!==null&&t.$$typeof===rr}function sc(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Do=/\/+/g;function fs(t,e){return typeof t=="object"&&t!==null&&t.key!=null?sc(""+t.key):e.toString(36)}function Jr(t,e,r,n,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case rr:case Wu:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+fs(i,0):n,No(s)?(r="",t!=null&&(r=t.replace(Do,"$&/")+"/"),Jr(s,e,r,"",function(u){return u})):s!=null&&(gs(s)&&(s=nc(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Do,"$&/")+"/")+t)),e.push(s)),1;if(i=0,n=n===""?".":n+":",No(t))for(var a=0;a<t.length;a++){o=t[a];var l=n+fs(o,a);i+=Jr(o,e,r,l,s)}else if(l=rc(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=n+fs(o,a++),i+=Jr(o,e,r,l,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Wr(t,e,r){if(t==null)return t;var n=[],s=0;return Jr(t,n,"","",function(o){return e.call(r,o,s++)}),n}function oc(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var z={current:null},Gr={transition:null},ic={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:Gr,ReactCurrentOwner:ys};S.Children={map:Wr,forEach:function(t,e,r){Wr(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Wr(t,function(){e++}),e},toArray:function(t){return Wr(t,function(e){return e})||[]},only:function(t){if(!gs(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};S.Component=vt;S.Fragment=Ju;S.Profiler=Ku;S.PureComponent=ps;S.StrictMode=Gu;S.Suspense=Yu;S.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ic;S.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Bo({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=ys.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)zo.call(e,l)&&!Wo.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:rr,type:t.type,key:s,ref:o,props:n,_owner:i}};S.createContext=function(t){return t={$$typeof:Qu,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Zu,_context:t},t.Consumer=t};S.createElement=Jo;S.createFactory=function(t){var e=Jo.bind(null,t);return e.type=t,e};S.createRef=function(){return{current:null}};S.forwardRef=function(t){return{$$typeof:Xu,render:t}};S.isValidElement=gs;S.lazy=function(t){return{$$typeof:tc,_payload:{_status:-1,_result:t},_init:oc}};S.memo=function(t,e){return{$$typeof:ec,type:t,compare:e===void 0?null:e}};S.startTransition=function(t){var e=Gr.transition;Gr.transition={};try{t()}finally{Gr.transition=e}};S.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};S.useCallback=function(t,e){return z.current.useCallback(t,e)};S.useContext=function(t){return z.current.useContext(t)};S.useDebugValue=function(){};S.useDeferredValue=function(t){return z.current.useDeferredValue(t)};S.useEffect=function(t,e){return z.current.useEffect(t,e)};S.useId=function(){return z.current.useId()};S.useImperativeHandle=function(t,e,r){return z.current.useImperativeHandle(t,e,r)};S.useInsertionEffect=function(t,e){return z.current.useInsertionEffect(t,e)};S.useLayoutEffect=function(t,e){return z.current.useLayoutEffect(t,e)};S.useMemo=function(t,e){return z.current.useMemo(t,e)};S.useReducer=function(t,e,r){return z.current.useReducer(t,e,r)};S.useRef=function(t){return z.current.useRef(t)};S.useState=function(t){return z.current.useState(t)};S.useSyncExternalStore=function(t,e,r){return z.current.useSyncExternalStore(t,e,r)};S.useTransition=function(){return z.current.useTransition()};S.version="18.2.0"});var Kr=me((Wp,Ko)=>{"use strict";Ko.exports=Go()});var Di=me(bt=>{"use strict";var yi=Kr();function _(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Z=Object.prototype.hasOwnProperty,ac=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zo={},Qo={};function gi(t){return Z.call(Qo,t)?!0:Z.call(Zo,t)?!1:ac.test(t)?Qo[t]=!0:(Zo[t]=!0,!1)}function J(t,e,r,n,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var D={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){D[t]=new J(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];D[e]=new J(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){D[t]=new J(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){D[t]=new J(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){D[t]=new J(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){D[t]=new J(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){D[t]=new J(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){D[t]=new J(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){D[t]=new J(t,5,!1,t.toLowerCase(),null,!1,!1)});var Es=/[\-:]([a-z])/g;function Rs(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Es,Rs);D[e]=new J(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Es,Rs);D[e]=new J(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Es,Rs);D[e]=new J(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){D[t]=new J(t,1,!1,t.toLowerCase(),null,!1,!1)});D.xlinkHref=new J("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){D[t]=new J(t,1,!1,t.toLowerCase(),null,!0,!0)});var Xr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lc=["Webkit","ms","Moz","O"];Object.keys(Xr).forEach(function(t){lc.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Xr[e]=Xr[t]})});var uc=/["'&<>]/;function W(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=uc.exec(t);if(e){var r="",n,s=0;for(n=e.index;n<t.length;n++){switch(t.charCodeAt(n)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}s!==n&&(r+=t.substring(s,n)),s=n+1,r+=e}t=s!==n?r+t.substring(s,n):r}return t}var cc=/([A-Z])/g,hc=/^ms-/,bs=Array.isArray;function Se(t,e){return{insertionMode:t,selectedValue:e}}function dc(t,e,r){switch(e){case"select":return Se(1,r.value!=null?r.value:r.defaultValue);case"svg":return Se(2,null);case"math":return Se(3,null);case"foreignObject":return Se(1,null);case"table":return Se(4,null);case"thead":case"tbody":case"tfoot":return Se(5,null);case"colgroup":return Se(7,null);case"tr":return Se(6,null)}return 4<=t.insertionMode||t.insertionMode===0?Se(1,null):t}var Xo=new Map;function wi(t,e,r){if(typeof r!="object")throw Error(_(62));e=!0;for(var n in r)if(Z.call(r,n)){var s=r[n];if(s!=null&&typeof s!="boolean"&&s!==""){if(n.indexOf("--")===0){var o=W(n);s=W((""+s).trim())}else{o=n;var i=Xo.get(o);i!==void 0||(i=W(o.replace(cc,"-$1").toLowerCase().replace(hc,"-ms-")),Xo.set(o,i)),o=i,s=typeof s=="number"?s===0||Z.call(Xr,n)?""+s:s+"px":W((""+s).trim())}e?(e=!1,t.push(' style="',o,":",s)):t.push(";",o,":",s)}}e||t.push('"')}function te(t,e,r,n){switch(r){case"style":wi(t,e,n);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N"){if(e=D.hasOwnProperty(r)?D[r]:null,e!==null){switch(typeof n){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(r=e.attributeName,e.type){case 3:n&&t.push(" ",r,'=""');break;case 4:n===!0?t.push(" ",r,'=""'):n!==!1&&t.push(" ",r,'="',W(n),'"');break;case 5:isNaN(n)||t.push(" ",r,'="',W(n),'"');break;case 6:!isNaN(n)&&1<=n&&t.push(" ",r,'="',W(n),'"');break;default:e.sanitizeURL&&(n=""+n),t.push(" ",r,'="',W(n),'"')}}else if(gi(r)){switch(typeof n){case"function":case"symbol":return;case"boolean":if(e=r.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push(" ",r,'="',W(n),'"')}}}function Yr(t,e,r){if(e!=null){if(r!=null)throw Error(_(60));if(typeof e!="object"||!("__html"in e))throw Error(_(61));e=e.__html,e!=null&&t.push(""+e)}}function fc(t){var e="";return yi.Children.forEach(t,function(r){r!=null&&(e+=r)}),e}function ws(t,e,r,n){t.push(ge(r));var s=r=null,o;for(o in e)if(Z.call(e,o)){var i=e[o];if(i!=null)switch(o){case"children":r=i;break;case"dangerouslySetInnerHTML":s=i;break;default:te(t,n,o,i)}}return t.push(">"),Yr(t,s,r),typeof r=="string"?(t.push(W(r)),null):r}var pc=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Yo=new Map;function ge(t){var e=Yo.get(t);if(e===void 0){if(!pc.test(t))throw Error(_(65,t));e="<"+t,Yo.set(t,e)}return e}function mc(t,e,r,n,s){switch(e){case"select":t.push(ge("select"));var o=null,i=null;for(c in r)if(Z.call(r,c)){var a=r[c];if(a!=null)switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":i=a;break;case"defaultValue":case"value":break;default:te(t,n,c,a)}}return t.push(">"),Yr(t,i,o),o;case"option":i=s.selectedValue,t.push(ge("option"));var l=a=null,u=null,c=null;for(o in r)if(Z.call(r,o)){var h=r[o];if(h!=null)switch(o){case"children":a=h;break;case"selected":u=h;break;case"dangerouslySetInnerHTML":c=h;break;case"value":l=h;default:te(t,n,o,h)}}if(i!=null)if(r=l!==null?""+l:fc(a),bs(i)){for(n=0;n<i.length;n++)if(""+i[n]===r){t.push(' selected=""');break}}else""+i===r&&t.push(' selected=""');else u&&t.push(' selected=""');return t.push(">"),Yr(t,c,a),a;case"textarea":t.push(ge("textarea")),c=i=o=null;for(a in r)if(Z.call(r,a)&&(l=r[a],l!=null))switch(a){case"children":c=l;break;case"value":o=l;break;case"defaultValue":i=l;break;case"dangerouslySetInnerHTML":throw Error(_(91));default:te(t,n,a,l)}if(o===null&&i!==null&&(o=i),t.push(">"),c!=null){if(o!=null)throw Error(_(92));if(bs(c)&&1<c.length)throw Error(_(93));o=""+c}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o!==null&&t.push(W(""+o)),null;case"input":t.push(ge("input")),l=c=a=o=null;for(i in r)if(Z.call(r,i)&&(u=r[i],u!=null))switch(i){case"children":case"dangerouslySetInnerHTML":throw Error(_(399,"input"));case"defaultChecked":l=u;break;case"defaultValue":a=u;break;case"checked":c=u;break;case"value":o=u;break;default:te(t,n,i,u)}return c!==null?te(t,n,"checked",c):l!==null&&te(t,n,"checked",l),o!==null?te(t,n,"value",o):a!==null&&te(t,n,"value",a),t.push("/>"),null;case"menuitem":t.push(ge("menuitem"));for(var d in r)if(Z.call(r,d)&&(o=r[d],o!=null))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(_(400));default:te(t,n,d,o)}return t.push(">"),null;case"title":t.push(ge("title")),o=null;for(h in r)if(Z.call(r,h)&&(i=r[h],i!=null))switch(h){case"children":o=i;break;case"dangerouslySetInnerHTML":throw Error(_(434));default:te(t,n,h,i)}return t.push(">"),o;case"listing":case"pre":t.push(ge(e)),i=o=null;for(l in r)if(Z.call(r,l)&&(a=r[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":i=a;break;default:te(t,n,l,a)}if(t.push(">"),i!=null){if(o!=null)throw Error(_(60));if(typeof i!="object"||!("__html"in i))throw Error(_(61));r=i.__html,r!=null&&(typeof r=="string"&&0<r.length&&r[0]===`
`?t.push(`
`,r):t.push(""+r))}return typeof o=="string"&&o[0]===`
`&&t.push(`
`),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(ge(e));for(var f in r)if(Z.call(r,f)&&(o=r[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(_(399,e));default:te(t,n,f,o)}return t.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return ws(t,r,e,n);case"html":return s.insertionMode===0&&t.push("<!DOCTYPE html>"),ws(t,r,e,n);default:if(e.indexOf("-")===-1&&typeof r.is!="string")return ws(t,r,e,n);t.push(ge(e)),i=o=null;for(u in r)if(Z.call(r,u)&&(a=r[u],a!=null))switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":i=a;break;case"style":wi(t,n,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:gi(u)&&typeof a!="function"&&typeof a!="symbol"&&t.push(" ",u,'="',W(a),'"')}return t.push(">"),Yr(t,i,o),o}}function ei(t,e,r){if(t.push('<!--$?--><template id="'),r===null)throw Error(_(395));return t.push(r),t.push('"></template>')}function yc(t,e,r,n){switch(r.insertionMode){case 0:case 1:return t.push('<div hidden id="'),t.push(e.segmentPrefix),e=n.toString(16),t.push(e),t.push('">');case 2:return t.push('<svg aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=n.toString(16),t.push(e),t.push('">');case 3:return t.push('<math aria-hidden="true" style="display:none" id="'),t.push(e.segmentPrefix),e=n.toString(16),t.push(e),t.push('">');case 4:return t.push('<table hidden id="'),t.push(e.segmentPrefix),e=n.toString(16),t.push(e),t.push('">');case 5:return t.push('<table hidden><tbody id="'),t.push(e.segmentPrefix),e=n.toString(16),t.push(e),t.push('">');case 6:return t.push('<table hidden><tr id="'),t.push(e.segmentPrefix),e=n.toString(16),t.push(e),t.push('">');case 7:return t.push('<table hidden><colgroup id="'),t.push(e.segmentPrefix),e=n.toString(16),t.push(e),t.push('">');default:throw Error(_(397))}}function gc(t,e){switch(e.insertionMode){case 0:case 1:return t.push("</div>");case 2:return t.push("</svg>");case 3:return t.push("</math>");case 4:return t.push("</table>");case 5:return t.push("</tbody></table>");case 6:return t.push("</tr></table>");case 7:return t.push("</colgroup></table>");default:throw Error(_(397))}}var wc=/[<\u2028\u2029]/g;function _s(t){return JSON.stringify(t).replace(wc,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function _c(t,e){return e=e===void 0?"":e,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:e+"P:",segmentPrefix:e+"S:",boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:t}}function ti(t,e,r,n){return r.generateStaticMarkup?(t.push(W(e)),!1):(e===""?t=n:(n&&t.push("<!-- -->"),t.push(W(e)),t=!0),t)}var or=Object.assign,vc=Symbol.for("react.element"),_i=Symbol.for("react.portal"),vi=Symbol.for("react.fragment"),bi=Symbol.for("react.strict_mode"),xi=Symbol.for("react.profiler"),Si=Symbol.for("react.provider"),ki=Symbol.for("react.context"),Ci=Symbol.for("react.forward_ref"),Ei=Symbol.for("react.suspense"),Ri=Symbol.for("react.suspense_list"),Ti=Symbol.for("react.memo"),Ts=Symbol.for("react.lazy"),bc=Symbol.for("react.scope"),xc=Symbol.for("react.debug_trace_mode"),Sc=Symbol.for("react.legacy_hidden"),kc=Symbol.for("react.default_value"),ri=Symbol.iterator;function xs(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case vi:return"Fragment";case _i:return"Portal";case xi:return"Profiler";case bi:return"StrictMode";case Ei:return"Suspense";case Ri:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ki:return(t.displayName||"Context")+".Consumer";case Si:return(t._context.displayName||"Context")+".Provider";case Ci:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ti:return e=t.displayName||null,e!==null?e:xs(t.type)||"Memo";case Ts:e=t._payload,t=t._init;try{return xs(t(e))}catch{}}return null}var Ii={};function ni(t,e){if(t=t.contextTypes,!t)return Ii;var r={},n;for(n in t)r[n]=e[n];return r}var Ke=null;function un(t,e){if(t!==e){t.context._currentValue2=t.parentValue,t=t.parent;var r=e.parent;if(t===null){if(r!==null)throw Error(_(401))}else{if(r===null)throw Error(_(401));un(t,r)}e.context._currentValue2=e.value}}function Pi(t){t.context._currentValue2=t.parentValue,t=t.parent,t!==null&&Pi(t)}function Ai(t){var e=t.parent;e!==null&&Ai(e),t.context._currentValue2=t.value}function Oi(t,e){if(t.context._currentValue2=t.parentValue,t=t.parent,t===null)throw Error(_(402));t.depth===e.depth?un(t,e):Oi(t,e)}function qi(t,e){var r=e.parent;if(r===null)throw Error(_(402));t.depth===r.depth?un(t,r):qi(t,r),e.context._currentValue2=e.value}function nn(t){var e=Ke;e!==t&&(e===null?Ai(t):t===null?Pi(e):e.depth===t.depth?un(e,t):e.depth>t.depth?Oi(e,t):qi(e,t),Ke=t)}var si={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function oi(t,e,r,n){var s=t.state!==void 0?t.state:null;t.updater=si,t.props=r,t.state=s;var o={queue:[],replace:!1};t._reactInternals=o;var i=e.contextType;if(t.context=typeof i=="object"&&i!==null?i._currentValue2:n,i=e.getDerivedStateFromProps,typeof i=="function"&&(i=i(r,s),s=i==null?s:or({},s,i),t.state=s),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&si.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,i=o.replace,o.queue=null,o.replace=!1,i&&e.length===1)t.state=e[0];else{for(o=i?e[0]:t.state,s=!0,i=i?1:0;i<e.length;i++){var a=e[i];a=typeof a=="function"?a.call(t,o,r,n):a,a!=null&&(s?(s=!1,o=or({},o,a)):or(o,a))}t.state=o}else o.queue=null}var Cc={id:1,overflow:""};function Ss(t,e,r){var n=t.id;t=t.overflow;var s=32-en(n)-1;n&=~(1<<s),r+=1;var o=32-en(e)+s;if(30<o){var i=s-s%5;return o=(n&(1<<i)-1).toString(32),n>>=i,s-=i,{id:1<<32-en(e)+s|r<<s|n,overflow:o+t}}return{id:1<<o|r<<s|n,overflow:t}}var en=Math.clz32?Math.clz32:Tc,Ec=Math.log,Rc=Math.LN2;function Tc(t){return t>>>=0,t===0?32:31-(Ec(t)/Rc|0)|0}function Ic(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Pc=typeof Object.is=="function"?Object.is:Ic,ke=null,Is=null,tn=null,I=null,nr=!1,sn=!1,ir=0,qe=null,cn=0;function Ge(){if(ke===null)throw Error(_(321));return ke}function ii(){if(0<cn)throw Error(_(312));return{memoizedState:null,queue:null,next:null}}function Ps(){return I===null?tn===null?(nr=!1,tn=I=ii()):(nr=!0,I=tn):I.next===null?(nr=!1,I=I.next=ii()):(nr=!0,I=I.next),I}function As(){Is=ke=null,sn=!1,tn=null,cn=0,I=qe=null}function $i(t,e){return typeof e=="function"?e(t):e}function ai(t,e,r){if(ke=Ge(),I=Ps(),nr){var n=I.queue;if(e=n.dispatch,qe!==null&&(r=qe.get(n),r!==void 0)){qe.delete(n),n=I.memoizedState;do n=t(n,r.action),r=r.next;while(r!==null);return I.memoizedState=n,[n,e]}return[I.memoizedState,e]}return t=t===$i?typeof e=="function"?e():e:r!==void 0?r(e):e,I.memoizedState=t,t=I.queue={last:null,dispatch:null},t=t.dispatch=Ac.bind(null,ke,t),[I.memoizedState,t]}function li(t,e){if(ke=Ge(),I=Ps(),e=e===void 0?null:e,I!==null){var r=I.memoizedState;if(r!==null&&e!==null){var n=r[1];e:if(n===null)n=!1;else{for(var s=0;s<n.length&&s<e.length;s++)if(!Pc(e[s],n[s])){n=!1;break e}n=!0}if(n)return r[0]}}return t=t(),I.memoizedState=[t,e],t}function Ac(t,e,r){if(25<=cn)throw Error(_(301));if(t===ke)if(sn=!0,t={action:r,next:null},qe===null&&(qe=new Map),r=qe.get(e),r===void 0)qe.set(e,t);else{for(e=r;e.next!==null;)e=e.next;e.next=t}}function Oc(){throw Error(_(394))}function Zr(){}var ui={readContext:function(t){return t._currentValue2},useContext:function(t){return Ge(),t._currentValue2},useMemo:li,useReducer:ai,useRef:function(t){ke=Ge(),I=Ps();var e=I.memoizedState;return e===null?(t={current:t},I.memoizedState=t):e},useState:function(t){return ai($i,t)},useInsertionEffect:Zr,useLayoutEffect:function(){},useCallback:function(t,e){return li(function(){return t},e)},useImperativeHandle:Zr,useEffect:Zr,useDebugValue:Zr,useDeferredValue:function(t){return Ge(),t},useTransition:function(){return Ge(),[!1,Oc]},useId:function(){var t=Is.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-en(t)-1)).toString(32)+e;var r=rn;if(r===null)throw Error(_(404));return e=ir++,t=":"+r.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return Ge(),e(t._source)},useSyncExternalStore:function(t,e,r){if(r===void 0)throw Error(_(407));return r()}},rn=null,vs=yi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function qc(t){return console.error(t),null}function sr(){}function $c(t,e,r,n,s,o,i,a,l){var u=[],c=new Set;return e={destination:null,responseState:e,progressiveChunkSize:n===void 0?12800:n,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:c,pingedTasks:u,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:s===void 0?qc:s,onAllReady:o===void 0?sr:o,onShellReady:i===void 0?sr:i,onShellError:a===void 0?sr:a,onFatalError:l===void 0?sr:l},r=on(e,0,null,r,!1,!1),r.parentFlushed=!0,t=Os(e,t,null,r,c,Ii,null,Cc),u.push(t),e}function Os(t,e,r,n,s,o,i,a){t.allPendingTasks++,r===null?t.pendingRootTasks++:r.pendingTasks++;var l={node:e,ping:function(){var u=t.pingedTasks;u.push(l),u.length===1&&Ui(t)},blockedBoundary:r,blockedSegment:n,abortSet:s,legacyContext:o,context:i,treeContext:a};return s.add(l),l}function on(t,e,r,n,s,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:n,boundary:r,lastPushedText:s,textEmbedded:o}}function ar(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function an(t,e){var r=t.onShellError;r(e),r=t.onFatalError,r(e),t.destination!==null?(t.status=2,t.destination.destroy(e)):(t.status=1,t.fatalError=e)}function ci(t,e,r,n,s){for(ke={},Is=e,ir=0,t=r(n,s);sn;)sn=!1,ir=0,cn+=1,I=null,t=r(n,s);return As(),t}function hi(t,e,r,n){var s=r.render(),o=n.childContextTypes;if(o!=null){var i=e.legacyContext;if(typeof r.getChildContext!="function")n=i;else{r=r.getChildContext();for(var a in r)if(!(a in o))throw Error(_(108,xs(n)||"Unknown",a));n=or({},i,r)}e.legacyContext=n,re(t,e,s),e.legacyContext=i}else re(t,e,s)}function di(t,e){if(t&&t.defaultProps){e=or({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function ks(t,e,r,n,s){if(typeof r=="function")if(r.prototype&&r.prototype.isReactComponent){s=ni(r,e.legacyContext);var o=r.contextType;o=new r(n,typeof o=="object"&&o!==null?o._currentValue2:s),oi(o,r,n,s),hi(t,e,o,r)}else{o=ni(r,e.legacyContext),s=ci(t,e,r,n,o);var i=ir!==0;if(typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0)oi(s,r,n,o),hi(t,e,s,r);else if(i){n=e.treeContext,e.treeContext=Ss(n,1,0);try{re(t,e,s)}finally{e.treeContext=n}}else re(t,e,s)}else if(typeof r=="string"){switch(s=e.blockedSegment,o=mc(s.chunks,r,n,t.responseState,s.formatContext),s.lastPushedText=!1,i=s.formatContext,s.formatContext=dc(i,r,n),Cs(t,e,o),s.formatContext=i,r){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:s.chunks.push("</",r,">")}s.lastPushedText=!1}else{switch(r){case Sc:case xc:case bi:case xi:case vi:re(t,e,n.children);return;case Ri:re(t,e,n.children);return;case bc:throw Error(_(343));case Ei:e:{r=e.blockedBoundary,s=e.blockedSegment,o=n.fallback,n=n.children,i=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:i,errorDigest:null},l=on(t,s.chunks.length,a,s.formatContext,!1,!1);s.children.push(l),s.lastPushedText=!1;var u=on(t,0,null,s.formatContext,!1,!1);u.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=u;try{if(Cs(t,e,n),t.responseState.generateStaticMarkup||u.lastPushedText&&u.textEmbedded&&u.chunks.push("<!-- -->"),u.status=1,ln(a,u),a.pendingTasks===0)break e}catch(c){u.status=4,a.forceClientRender=!0,a.errorDigest=ar(t,c)}finally{e.blockedBoundary=r,e.blockedSegment=s}e=Os(t,o,r,l,i,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Ci:if(n=ci(t,e,r.render,n,s),ir!==0){r=e.treeContext,e.treeContext=Ss(r,1,0);try{re(t,e,n)}finally{e.treeContext=r}}else re(t,e,n);return;case Ti:r=r.type,n=di(r,n),ks(t,e,r,n,s);return;case Si:if(s=n.children,r=r._context,n=n.value,o=r._currentValue2,r._currentValue2=n,i=Ke,Ke=n={parent:i,depth:i===null?0:i.depth+1,context:r,parentValue:o,value:n},e.context=n,re(t,e,s),t=Ke,t===null)throw Error(_(403));n=t.parentValue,t.context._currentValue2=n===kc?t.context._defaultValue:n,t=Ke=t.parent,e.context=t;return;case ki:n=n.children,n=n(r._currentValue2),re(t,e,n);return;case Ts:s=r._init,r=s(r._payload),n=di(r,n),ks(t,e,r,n,void 0);return}throw Error(_(130,r==null?r:typeof r,""))}}function re(t,e,r){if(e.node=r,typeof r=="object"&&r!==null){switch(r.$$typeof){case vc:ks(t,e,r.type,r.props,r.ref);return;case _i:throw Error(_(257));case Ts:var n=r._init;r=n(r._payload),re(t,e,r);return}if(bs(r)){fi(t,e,r);return}if(r===null||typeof r!="object"?n=null:(n=ri&&r[ri]||r["@@iterator"],n=typeof n=="function"?n:null),n&&(n=n.call(r))){if(r=n.next(),!r.done){var s=[];do s.push(r.value),r=n.next();while(!r.done);fi(t,e,s)}return}throw t=Object.prototype.toString.call(r),Error(_(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t))}typeof r=="string"?(n=e.blockedSegment,n.lastPushedText=ti(e.blockedSegment.chunks,r,t.responseState,n.lastPushedText)):typeof r=="number"&&(n=e.blockedSegment,n.lastPushedText=ti(e.blockedSegment.chunks,""+r,t.responseState,n.lastPushedText))}function fi(t,e,r){for(var n=r.length,s=0;s<n;s++){var o=e.treeContext;e.treeContext=Ss(o,n,s);try{Cs(t,e,r[s])}finally{e.treeContext=o}}}function Cs(t,e,r){var n=e.blockedSegment.formatContext,s=e.legacyContext,o=e.context;try{return re(t,e,r)}catch(l){if(As(),typeof l=="object"&&l!==null&&typeof l.then=="function"){r=l;var i=e.blockedSegment,a=on(t,i.chunks.length,null,i.formatContext,i.lastPushedText,!0);i.children.push(a),i.lastPushedText=!1,t=Os(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,r.then(t,t),e.blockedSegment.formatContext=n,e.legacyContext=s,e.context=o,nn(o)}else throw e.blockedSegment.formatContext=n,e.legacyContext=s,e.context=o,nn(o),l}}function jc(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,Li(this,e,t)}function ji(t,e,r){var n=t.blockedBoundary;t.blockedSegment.status=3,n===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.push(null))):(n.pendingTasks--,n.forceClientRender||(n.forceClientRender=!0,t=r===void 0?Error(_(432)):r,n.errorDigest=e.onError(t),n.parentFlushed&&e.clientRenderedBoundaries.push(n)),n.fallbackAbortableTasks.forEach(function(s){return ji(s,e,r)}),n.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(n=e.onAllReady,n()))}function ln(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var r=e.children[0];r.id=e.id,r.parentFlushed=!0,r.status===1&&ln(t,r)}else t.completedSegments.push(e)}function Li(t,e,r){if(e===null){if(r.parentFlushed){if(t.completedRootSegment!==null)throw Error(_(389));t.completedRootSegment=r}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=sr,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(r.parentFlushed&&r.status===1&&ln(e,r),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(jc,t),e.fallbackAbortableTasks.clear()):r.parentFlushed&&r.status===1&&(ln(e,r),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function Ui(t){if(t.status!==2){var e=Ke,r=vs.current;vs.current=ui;var n=rn;rn=t.responseState;try{var s=t.pingedTasks,o;for(o=0;o<s.length;o++){var i=s[o],a=t,l=i.blockedSegment;if(l.status===0){nn(i.context);try{re(a,i,i.node),a.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("<!-- -->"),i.abortSet.delete(i),l.status=1,Li(a,i.blockedBoundary,l)}catch(y){if(As(),typeof y=="object"&&y!==null&&typeof y.then=="function"){var u=i.ping;y.then(u,u)}else{i.abortSet.delete(i),l.status=4;var c=i.blockedBoundary,h=y,d=ar(a,h);if(c===null?an(a,h):(c.pendingTasks--,c.forceClientRender||(c.forceClientRender=!0,c.errorDigest=d,c.parentFlushed&&a.clientRenderedBoundaries.push(c))),a.allPendingTasks--,a.allPendingTasks===0){var f=a.onAllReady;f()}}}finally{}}}s.splice(0,o),t.destination!==null&&qs(t,t.destination)}catch(y){ar(t,y),an(t,y)}finally{rn=n,vs.current=r,r===ui&&nn(e)}}}function Qr(t,e,r){switch(r.parentFlushed=!0,r.status){case 0:var n=r.id=t.nextSegmentId++;return r.lastPushedText=!1,r.textEmbedded=!1,t=t.responseState,e.push('<template id="'),e.push(t.placeholderPrefix),t=n.toString(16),e.push(t),e.push('"></template>');case 1:r.status=2;var s=!0;n=r.chunks;var o=0;r=r.children;for(var i=0;i<r.length;i++){for(s=r[i];o<s.index;o++)e.push(n[o]);s=hn(t,e,s)}for(;o<n.length-1;o++)e.push(n[o]);return o<n.length&&(s=e.push(n[o])),s;default:throw Error(_(390))}}function hn(t,e,r){var n=r.boundary;if(n===null)return Qr(t,e,r);if(n.parentFlushed=!0,n.forceClientRender)return t.responseState.generateStaticMarkup||(n=n.errorDigest,e.push("<!--$!-->"),e.push("<template"),n&&(e.push(' data-dgst="'),n=W(n),e.push(n),e.push('"')),e.push("></template>")),Qr(t,e,r),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t;if(0<n.pendingTasks){n.rootSegmentID=t.nextSegmentId++,0<n.completedSegments.length&&t.partialBoundaries.push(n);var s=t.responseState,o=s.nextSuspenseID++;return s=s.boundaryPrefix+o.toString(16),n=n.id=s,ei(e,t.responseState,n),Qr(t,e,r),e.push("<!--/$-->")}if(n.byteSize>t.progressiveChunkSize)return n.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(n),ei(e,t.responseState,n.id),Qr(t,e,r),e.push("<!--/$-->");if(t.responseState.generateStaticMarkup||e.push("<!--$-->"),r=n.completedSegments,r.length!==1)throw Error(_(391));return hn(t,e,r[0]),t=t.responseState.generateStaticMarkup?!0:e.push("<!--/$-->"),t}function pi(t,e,r){return yc(e,t.responseState,r.formatContext,r.id),hn(t,e,r),gc(e,r.formatContext)}function mi(t,e,r){for(var n=r.completedSegments,s=0;s<n.length;s++)Fi(t,e,r,n[s]);if(n.length=0,t=t.responseState,n=r.id,r=r.rootSegmentID,e.push(t.startInlineScript),t.sentCompleteBoundaryFunction?e.push('$RC("'):(t.sentCompleteBoundaryFunction=!0,e.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),n===null)throw Error(_(395));return r=r.toString(16),e.push(n),e.push('","'),e.push(t.segmentPrefix),e.push(r),e.push('")<\/script>')}function Fi(t,e,r,n){if(n.status===2)return!0;var s=n.id;if(s===-1){if((n.id=r.rootSegmentID)===-1)throw Error(_(392));return pi(t,e,n)}return pi(t,e,n),t=t.responseState,e.push(t.startInlineScript),t.sentCompleteSegmentFunction?e.push('$RS("'):(t.sentCompleteSegmentFunction=!0,e.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),e.push(t.segmentPrefix),s=s.toString(16),e.push(s),e.push('","'),e.push(t.placeholderPrefix),e.push(s),e.push('")<\/script>')}function qs(t,e){try{var r=t.completedRootSegment;if(r!==null&&t.pendingRootTasks===0){hn(t,e,r),t.completedRootSegment=null;var n=t.responseState.bootstrapChunks;for(r=0;r<n.length-1;r++)e.push(n[r]);r<n.length&&e.push(n[r])}var s=t.clientRenderedBoundaries,o;for(o=0;o<s.length;o++){var i=s[o];n=e;var a=t.responseState,l=i.id,u=i.errorDigest,c=i.errorMessage,h=i.errorComponentStack;if(n.push(a.startInlineScript),a.sentClientRenderFunction?n.push('$RX("'):(a.sentClientRenderFunction=!0,n.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),l===null)throw Error(_(395));if(n.push(l),n.push('"'),u||c||h){n.push(",");var d=_s(u||"");n.push(d)}if(c||h){n.push(",");var f=_s(c||"");n.push(f)}if(h){n.push(",");var y=_s(h);n.push(y)}if(!n.push(")<\/script>")){t.destination=null,o++,s.splice(0,o);return}}s.splice(0,o);var w=t.completedBoundaries;for(o=0;o<w.length;o++)if(!mi(t,e,w[o])){t.destination=null,o++,w.splice(0,o);return}w.splice(0,o);var x=t.partialBoundaries;for(o=0;o<x.length;o++){var q=x[o];e:{s=t,i=e;var K=q.completedSegments;for(a=0;a<K.length;a++)if(!Fi(s,i,q,K[a])){a++,K.splice(0,a);var ee=!1;break e}K.splice(0,a),ee=!0}if(!ee){t.destination=null,o++,x.splice(0,o);return}}x.splice(0,o);var j=t.completedBoundaries;for(o=0;o<j.length;o++)if(!mi(t,e,j[o])){t.destination=null,o++,j.splice(0,o);return}j.splice(0,o)}finally{t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.push(null)}}function Lc(t,e){try{var r=t.abortableTasks;r.forEach(function(n){return ji(n,t,e)}),r.clear(),t.destination!==null&&qs(t,t.destination)}catch(n){ar(t,n),an(t,n)}}function Uc(){}function Ni(t,e,r,n){var s=!1,o=null,i="",a={push:function(u){return u!==null&&(i+=u),!0},destroy:function(u){s=!0,o=u}},l=!1;if(t=$c(t,_c(r,e?e.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,Uc,void 0,function(){l=!0},void 0,void 0),Ui(t),Lc(t,n),t.status===1)t.status=2,a.destroy(t.fatalError);else if(t.status!==2&&t.destination===null){t.destination=a;try{qs(t,a)}catch(u){ar(t,u),an(t,u)}}if(s)throw o;if(!l)throw Error(_(426));return i}bt.renderToNodeStream=function(){throw Error(_(207))};bt.renderToStaticMarkup=function(t,e){return Ni(t,e,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};bt.renderToStaticNodeStream=function(){throw Error(_(208))};bt.renderToString=function(t,e){return Ni(t,e,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};bt.version="18.2.0"});var Fa=me(eo=>{"use strict";var fa=Kr();function v(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var se=null,oe=0;function m(t,e){if(e.length!==0)if(512<e.length)0<oe&&(t.enqueue(new Uint8Array(se.buffer,0,oe)),se=new Uint8Array(512),oe=0),t.enqueue(e);else{var r=se.length-oe;r<e.length&&(r===0?t.enqueue(se):(se.set(e.subarray(0,r),oe),t.enqueue(se),e=e.subarray(r)),se=new Uint8Array(512),oe=0),se.set(e,oe),oe+=e.length}}function O(t,e){return m(t,e),!0}function Mi(t){se&&0<oe&&(t.enqueue(new Uint8Array(se.buffer,0,oe)),se=null,oe=0)}var pa=new TextEncoder;function b(t){return pa.encode(t)}function p(t){return pa.encode(t)}function ma(t,e){typeof t.error=="function"?t.error(e):t.close()}var Q=Object.prototype.hasOwnProperty,Fc=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bi={},Hi={};function ya(t){return Q.call(Hi,t)?!0:Q.call(Bi,t)?!1:Fc.test(t)?Hi[t]=!0:(Bi[t]=!0,!1)}function G(t,e,r,n,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var B={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){B[t]=new G(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];B[e]=new G(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){B[t]=new G(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){B[t]=new G(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){B[t]=new G(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){B[t]=new G(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){B[t]=new G(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){B[t]=new G(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){B[t]=new G(t,5,!1,t.toLowerCase(),null,!1,!1)});var zs=/[\-:]([a-z])/g;function Ws(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(zs,Ws);B[e]=new G(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(zs,Ws);B[e]=new G(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(zs,Ws);B[e]=new G(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){B[t]=new G(t,1,!1,t.toLowerCase(),null,!1,!1)});B.xlinkHref=new G("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){B[t]=new G(t,1,!1,t.toLowerCase(),null,!0,!0)});var pn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nc=["Webkit","ms","Moz","O"];Object.keys(pn).forEach(function(t){Nc.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pn[e]=pn[t]})});var Dc=/["'&<>]/;function M(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var e=Dc.exec(t);if(e){var r="",n,s=0;for(n=e.index;n<t.length;n++){switch(t.charCodeAt(n)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#x27;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}s!==n&&(r+=t.substring(s,n)),s=n+1,r+=e}t=s!==n?r+t.substring(s,n):r}return t}var Mc=/([A-Z])/g,Bc=/^ms-/,Ds=Array.isArray,Hc=p("<script>"),Vc=p("<\/script>"),zc=p('<script src="'),Wc=p('<script type="module" src="'),Vi=p('" async=""><\/script>'),Jc=/(<\/|<)(s)(cript)/gi;function Gc(t,e,r,n){return""+e+(r==="s"?"\\u0073":"\\u0053")+n}function Kc(t,e,r,n,s){t=t===void 0?"":t,e=e===void 0?Hc:p('<script nonce="'+M(e)+'">');var o=[];if(r!==void 0&&o.push(e,b((""+r).replace(Jc,Gc)),Vc),n!==void 0)for(r=0;r<n.length;r++)o.push(zc,b(M(n[r])),Vi);if(s!==void 0)for(n=0;n<s.length;n++)o.push(Wc,b(M(s[n])),Vi);return{bootstrapChunks:o,startInlineScript:e,placeholderPrefix:p(t+"P:"),segmentPrefix:p(t+"S:"),boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function we(t,e){return{insertionMode:t,selectedValue:e}}function Zc(t){return we(t==="http://www.w3.org/2000/svg"?2:t==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function Qc(t,e,r){switch(e){case"select":return we(1,r.value!=null?r.value:r.defaultValue);case"svg":return we(2,null);case"math":return we(3,null);case"foreignObject":return we(1,null);case"table":return we(4,null);case"thead":case"tbody":case"tfoot":return we(5,null);case"colgroup":return we(7,null);case"tr":return we(6,null)}return 4<=t.insertionMode||t.insertionMode===0?we(1,null):t}var Js=p("<!-- -->");function zi(t,e,r,n){return e===""?n:(n&&t.push(Js),t.push(b(M(e))),!0)}var Wi=new Map,Xc=p(' style="'),Ji=p(":"),Yc=p(";");function ga(t,e,r){if(typeof r!="object")throw Error(v(62));e=!0;for(var n in r)if(Q.call(r,n)){var s=r[n];if(s!=null&&typeof s!="boolean"&&s!==""){if(n.indexOf("--")===0){var o=b(M(n));s=b(M((""+s).trim()))}else{o=n;var i=Wi.get(o);i!==void 0||(i=p(M(o.replace(Mc,"-$1").toLowerCase().replace(Bc,"-ms-"))),Wi.set(o,i)),o=i,s=typeof s=="number"?s===0||Q.call(pn,n)?b(""+s):b(s+"px"):b(M((""+s).trim()))}e?(e=!1,t.push(Xc,o,Ji,s)):t.push(Yc,o,Ji,s)}}e||t.push(Ze)}var $e=p(" "),xt=p('="'),Ze=p('"'),Gi=p('=""');function ne(t,e,r,n){switch(r){case"style":ga(t,e,n);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N"){if(e=B.hasOwnProperty(r)?B[r]:null,e!==null){switch(typeof n){case"function":case"symbol":return;case"boolean":if(!e.acceptsBooleans)return}switch(r=b(e.attributeName),e.type){case 3:n&&t.push($e,r,Gi);break;case 4:n===!0?t.push($e,r,Gi):n!==!1&&t.push($e,r,xt,b(M(n)),Ze);break;case 5:isNaN(n)||t.push($e,r,xt,b(M(n)),Ze);break;case 6:!isNaN(n)&&1<=n&&t.push($e,r,xt,b(M(n)),Ze);break;default:e.sanitizeURL&&(n=""+n),t.push($e,r,xt,b(M(n)),Ze)}}else if(ya(r)){switch(typeof n){case"function":case"symbol":return;case"boolean":if(e=r.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-")return}t.push($e,b(r),xt,b(M(n)),Ze)}}}var je=p(">"),Ki=p("/>");function mn(t,e,r){if(e!=null){if(r!=null)throw Error(v(60));if(typeof e!="object"||!("__html"in e))throw Error(v(61));e=e.__html,e!=null&&t.push(b(""+e))}}function eh(t){var e="";return fa.Children.forEach(t,function(r){r!=null&&(e+=r)}),e}var $s=p(' selected=""');function js(t,e,r,n){t.push(_e(r));var s=r=null,o;for(o in e)if(Q.call(e,o)){var i=e[o];if(i!=null)switch(o){case"children":r=i;break;case"dangerouslySetInnerHTML":s=i;break;default:ne(t,n,o,i)}}return t.push(je),mn(t,s,r),typeof r=="string"?(t.push(b(M(r))),null):r}var Ls=p(`
`),th=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Zi=new Map;function _e(t){var e=Zi.get(t);if(e===void 0){if(!th.test(t))throw Error(v(65,t));e=p("<"+t),Zi.set(t,e)}return e}var rh=p("<!DOCTYPE html>");function nh(t,e,r,n,s){switch(e){case"select":t.push(_e("select"));var o=null,i=null;for(c in r)if(Q.call(r,c)){var a=r[c];if(a!=null)switch(c){case"children":o=a;break;case"dangerouslySetInnerHTML":i=a;break;case"defaultValue":case"value":break;default:ne(t,n,c,a)}}return t.push(je),mn(t,i,o),o;case"option":i=s.selectedValue,t.push(_e("option"));var l=a=null,u=null,c=null;for(o in r)if(Q.call(r,o)){var h=r[o];if(h!=null)switch(o){case"children":a=h;break;case"selected":u=h;break;case"dangerouslySetInnerHTML":c=h;break;case"value":l=h;default:ne(t,n,o,h)}}if(i!=null)if(r=l!==null?""+l:eh(a),Ds(i)){for(n=0;n<i.length;n++)if(""+i[n]===r){t.push($s);break}}else""+i===r&&t.push($s);else u&&t.push($s);return t.push(je),mn(t,c,a),a;case"textarea":t.push(_e("textarea")),c=i=o=null;for(a in r)if(Q.call(r,a)&&(l=r[a],l!=null))switch(a){case"children":c=l;break;case"value":o=l;break;case"defaultValue":i=l;break;case"dangerouslySetInnerHTML":throw Error(v(91));default:ne(t,n,a,l)}if(o===null&&i!==null&&(o=i),t.push(je),c!=null){if(o!=null)throw Error(v(92));if(Ds(c)&&1<c.length)throw Error(v(93));o=""+c}return typeof o=="string"&&o[0]===`
`&&t.push(Ls),o!==null&&t.push(b(M(""+o))),null;case"input":t.push(_e("input")),l=c=a=o=null;for(i in r)if(Q.call(r,i)&&(u=r[i],u!=null))switch(i){case"children":case"dangerouslySetInnerHTML":throw Error(v(399,"input"));case"defaultChecked":l=u;break;case"defaultValue":a=u;break;case"checked":c=u;break;case"value":o=u;break;default:ne(t,n,i,u)}return c!==null?ne(t,n,"checked",c):l!==null&&ne(t,n,"checked",l),o!==null?ne(t,n,"value",o):a!==null&&ne(t,n,"value",a),t.push(Ki),null;case"menuitem":t.push(_e("menuitem"));for(var d in r)if(Q.call(r,d)&&(o=r[d],o!=null))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(v(400));default:ne(t,n,d,o)}return t.push(je),null;case"title":t.push(_e("title")),o=null;for(h in r)if(Q.call(r,h)&&(i=r[h],i!=null))switch(h){case"children":o=i;break;case"dangerouslySetInnerHTML":throw Error(v(434));default:ne(t,n,h,i)}return t.push(je),o;case"listing":case"pre":t.push(_e(e)),i=o=null;for(l in r)if(Q.call(r,l)&&(a=r[l],a!=null))switch(l){case"children":o=a;break;case"dangerouslySetInnerHTML":i=a;break;default:ne(t,n,l,a)}if(t.push(je),i!=null){if(o!=null)throw Error(v(60));if(typeof i!="object"||!("__html"in i))throw Error(v(61));r=i.__html,r!=null&&(typeof r=="string"&&0<r.length&&r[0]===`
`?t.push(Ls,b(r)):t.push(b(""+r)))}return typeof o=="string"&&o[0]===`
`&&t.push(Ls),o;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(_e(e));for(var f in r)if(Q.call(r,f)&&(o=r[f],o!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(v(399,e));default:ne(t,n,f,o)}return t.push(Ki),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return js(t,r,e,n);case"html":return s.insertionMode===0&&t.push(rh),js(t,r,e,n);default:if(e.indexOf("-")===-1&&typeof r.is!="string")return js(t,r,e,n);t.push(_e(e)),i=o=null;for(u in r)if(Q.call(r,u)&&(a=r[u],a!=null))switch(u){case"children":o=a;break;case"dangerouslySetInnerHTML":i=a;break;case"style":ga(t,n,a);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:ya(u)&&typeof a!="function"&&typeof a!="symbol"&&t.push($e,b(u),xt,b(M(a)),Ze)}return t.push(je),mn(t,i,o),o}}var sh=p("</"),oh=p(">"),ih=p('<template id="'),ah=p('"></template>'),lh=p("<!--$-->"),uh=p('<!--$?--><template id="'),ch=p('"></template>'),hh=p("<!--$!-->"),dh=p("<!--/$-->"),fh=p("<template"),ph=p('"'),mh=p(' data-dgst="');p(' data-msg="');p(' data-stck="');var yh=p("></template>");function Qi(t,e,r){if(m(t,uh),r===null)throw Error(v(395));return m(t,r),O(t,ch)}var gh=p('<div hidden id="'),wh=p('">'),_h=p("</div>"),vh=p('<svg aria-hidden="true" style="display:none" id="'),bh=p('">'),xh=p("</svg>"),Sh=p('<math aria-hidden="true" style="display:none" id="'),kh=p('">'),Ch=p("</math>"),Eh=p('<table hidden id="'),Rh=p('">'),Th=p("</table>"),Ih=p('<table hidden><tbody id="'),Ph=p('">'),Ah=p("</tbody></table>"),Oh=p('<table hidden><tr id="'),qh=p('">'),$h=p("</tr></table>"),jh=p('<table hidden><colgroup id="'),Lh=p('">'),Uh=p("</colgroup></table>");function Fh(t,e,r,n){switch(r.insertionMode){case 0:case 1:return m(t,gh),m(t,e.segmentPrefix),m(t,b(n.toString(16))),O(t,wh);case 2:return m(t,vh),m(t,e.segmentPrefix),m(t,b(n.toString(16))),O(t,bh);case 3:return m(t,Sh),m(t,e.segmentPrefix),m(t,b(n.toString(16))),O(t,kh);case 4:return m(t,Eh),m(t,e.segmentPrefix),m(t,b(n.toString(16))),O(t,Rh);case 5:return m(t,Ih),m(t,e.segmentPrefix),m(t,b(n.toString(16))),O(t,Ph);case 6:return m(t,Oh),m(t,e.segmentPrefix),m(t,b(n.toString(16))),O(t,qh);case 7:return m(t,jh),m(t,e.segmentPrefix),m(t,b(n.toString(16))),O(t,Lh);default:throw Error(v(397))}}function Nh(t,e){switch(e.insertionMode){case 0:case 1:return O(t,_h);case 2:return O(t,xh);case 3:return O(t,Ch);case 4:return O(t,Th);case 5:return O(t,Ah);case 6:return O(t,$h);case 7:return O(t,Uh);default:throw Error(v(397))}}var Dh=p('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Mh=p('$RS("'),Bh=p('","'),Hh=p('")<\/script>'),Vh=p('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),zh=p('$RC("'),Wh=p('","'),Jh=p('")<\/script>'),Gh=p('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),Kh=p('$RX("'),Zh=p('"'),Qh=p(")<\/script>"),Us=p(","),Xh=/[<\u2028\u2029]/g;function Fs(t){return JSON.stringify(t).replace(Xh,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var cr=Object.assign,Yh=Symbol.for("react.element"),wa=Symbol.for("react.portal"),_a=Symbol.for("react.fragment"),va=Symbol.for("react.strict_mode"),ba=Symbol.for("react.profiler"),xa=Symbol.for("react.provider"),Sa=Symbol.for("react.context"),ka=Symbol.for("react.forward_ref"),Ca=Symbol.for("react.suspense"),Ea=Symbol.for("react.suspense_list"),Ra=Symbol.for("react.memo"),Gs=Symbol.for("react.lazy"),ed=Symbol.for("react.scope"),td=Symbol.for("react.debug_trace_mode"),rd=Symbol.for("react.legacy_hidden"),nd=Symbol.for("react.default_value"),Xi=Symbol.iterator;function Ms(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case _a:return"Fragment";case wa:return"Portal";case ba:return"Profiler";case va:return"StrictMode";case Ca:return"Suspense";case Ea:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Sa:return(t.displayName||"Context")+".Consumer";case xa:return(t._context.displayName||"Context")+".Provider";case ka:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ra:return e=t.displayName||null,e!==null?e:Ms(t.type)||"Memo";case Gs:e=t._payload,t=t._init;try{return Ms(t(e))}catch{}}return null}var Ta={};function Yi(t,e){if(t=t.contextTypes,!t)return Ta;var r={},n;for(n in t)r[n]=e[n];return r}var Xe=null;function kn(t,e){if(t!==e){t.context._currentValue=t.parentValue,t=t.parent;var r=e.parent;if(t===null){if(r!==null)throw Error(v(401))}else{if(r===null)throw Error(v(401));kn(t,r)}e.context._currentValue=e.value}}function Ia(t){t.context._currentValue=t.parentValue,t=t.parent,t!==null&&Ia(t)}function Pa(t){var e=t.parent;e!==null&&Pa(e),t.context._currentValue=t.value}function Aa(t,e){if(t.context._currentValue=t.parentValue,t=t.parent,t===null)throw Error(v(402));t.depth===e.depth?kn(t,e):Aa(t,e)}function Oa(t,e){var r=e.parent;if(r===null)throw Error(v(402));t.depth===r.depth?kn(t,r):Oa(t,r),e.context._currentValue=e.value}function _n(t){var e=Xe;e!==t&&(e===null?Pa(t):t===null?Ia(e):e.depth===t.depth?kn(e,t):e.depth>t.depth?Aa(e,t):Oa(e,t),Xe=t)}var ea={isMounted:function(){return!1},enqueueSetState:function(t,e){t=t._reactInternals,t.queue!==null&&t.queue.push(e)},enqueueReplaceState:function(t,e){t=t._reactInternals,t.replace=!0,t.queue=[e]},enqueueForceUpdate:function(){}};function ta(t,e,r,n){var s=t.state!==void 0?t.state:null;t.updater=ea,t.props=r,t.state=s;var o={queue:[],replace:!1};t._reactInternals=o;var i=e.contextType;if(t.context=typeof i=="object"&&i!==null?i._currentValue:n,i=e.getDerivedStateFromProps,typeof i=="function"&&(i=i(r,s),s=i==null?s:cr({},s,i),t.state=s),typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(e=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),e!==t.state&&ea.enqueueReplaceState(t,t.state,null),o.queue!==null&&0<o.queue.length)if(e=o.queue,i=o.replace,o.queue=null,o.replace=!1,i&&e.length===1)t.state=e[0];else{for(o=i?e[0]:t.state,s=!0,i=i?1:0;i<e.length;i++){var a=e[i];a=typeof a=="function"?a.call(t,o,r,n):a,a!=null&&(s?(s=!1,o=cr({},o,a)):cr(o,a))}t.state=o}else o.queue=null}var sd={id:1,overflow:""};function Bs(t,e,r){var n=t.id;t=t.overflow;var s=32-yn(n)-1;n&=~(1<<s),r+=1;var o=32-yn(e)+s;if(30<o){var i=s-s%5;return o=(n&(1<<i)-1).toString(32),n>>=i,s-=i,{id:1<<32-yn(e)+s|r<<s|n,overflow:o+t}}return{id:1<<o|r<<s|n,overflow:t}}var yn=Math.clz32?Math.clz32:ad,od=Math.log,id=Math.LN2;function ad(t){return t>>>=0,t===0?32:31-(od(t)/id|0)|0}function ld(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ud=typeof Object.is=="function"?Object.is:ld,Ce=null,Ks=null,gn=null,P=null,lr=!1,vn=!1,hr=0,Le=null,Cn=0;function Qe(){if(Ce===null)throw Error(v(321));return Ce}function ra(){if(0<Cn)throw Error(v(312));return{memoizedState:null,queue:null,next:null}}function Zs(){return P===null?gn===null?(lr=!1,gn=P=ra()):(lr=!0,P=gn):P.next===null?(lr=!1,P=P.next=ra()):(lr=!0,P=P.next),P}function Qs(){Ks=Ce=null,vn=!1,gn=null,Cn=0,P=Le=null}function qa(t,e){return typeof e=="function"?e(t):e}function na(t,e,r){if(Ce=Qe(),P=Zs(),lr){var n=P.queue;if(e=n.dispatch,Le!==null&&(r=Le.get(n),r!==void 0)){Le.delete(n),n=P.memoizedState;do n=t(n,r.action),r=r.next;while(r!==null);return P.memoizedState=n,[n,e]}return[P.memoizedState,e]}return t=t===qa?typeof e=="function"?e():e:r!==void 0?r(e):e,P.memoizedState=t,t=P.queue={last:null,dispatch:null},t=t.dispatch=cd.bind(null,Ce,t),[P.memoizedState,t]}function sa(t,e){if(Ce=Qe(),P=Zs(),e=e===void 0?null:e,P!==null){var r=P.memoizedState;if(r!==null&&e!==null){var n=r[1];e:if(n===null)n=!1;else{for(var s=0;s<n.length&&s<e.length;s++)if(!ud(e[s],n[s])){n=!1;break e}n=!0}if(n)return r[0]}}return t=t(),P.memoizedState=[t,e],t}function cd(t,e,r){if(25<=Cn)throw Error(v(301));if(t===Ce)if(vn=!0,t={action:r,next:null},Le===null&&(Le=new Map),r=Le.get(e),r===void 0)Le.set(e,t);else{for(e=r;e.next!==null;)e=e.next;e.next=t}}function hd(){throw Error(v(394))}function dn(){}var oa={readContext:function(t){return t._currentValue},useContext:function(t){return Qe(),t._currentValue},useMemo:sa,useReducer:na,useRef:function(t){Ce=Qe(),P=Zs();var e=P.memoizedState;return e===null?(t={current:t},P.memoizedState=t):e},useState:function(t){return na(qa,t)},useInsertionEffect:dn,useLayoutEffect:function(){},useCallback:function(t,e){return sa(function(){return t},e)},useImperativeHandle:dn,useEffect:dn,useDebugValue:dn,useDeferredValue:function(t){return Qe(),t},useTransition:function(){return Qe(),[!1,hd]},useId:function(){var t=Ks.treeContext,e=t.overflow;t=t.id,t=(t&~(1<<32-yn(t)-1)).toString(32)+e;var r=wn;if(r===null)throw Error(v(404));return e=hr++,t=":"+r.idPrefix+"R"+t,0<e&&(t+="H"+e.toString(32)),t+":"},useMutableSource:function(t,e){return Qe(),e(t._source)},useSyncExternalStore:function(t,e,r){if(r===void 0)throw Error(v(407));return r()}},wn=null,Ns=fa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function dd(t){return console.error(t),null}function ur(){}function fd(t,e,r,n,s,o,i,a,l){var u=[],c=new Set;return e={destination:null,responseState:e,progressiveChunkSize:n===void 0?12800:n,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:c,pingedTasks:u,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:s===void 0?dd:s,onAllReady:o===void 0?ur:o,onShellReady:i===void 0?ur:i,onShellError:a===void 0?ur:a,onFatalError:l===void 0?ur:l},r=bn(e,0,null,r,!1,!1),r.parentFlushed=!0,t=Xs(e,t,null,r,c,Ta,null,sd),u.push(t),e}function Xs(t,e,r,n,s,o,i,a){t.allPendingTasks++,r===null?t.pendingRootTasks++:r.pendingTasks++;var l={node:e,ping:function(){var u=t.pingedTasks;u.push(l),u.length===1&&La(t)},blockedBoundary:r,blockedSegment:n,abortSet:s,legacyContext:o,context:i,treeContext:a};return s.add(l),l}function bn(t,e,r,n,s,o){return{status:0,id:-1,index:e,parentFlushed:!1,chunks:[],children:[],formatContext:n,boundary:r,lastPushedText:s,textEmbedded:o}}function dr(t,e){if(t=t.onError(e),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function xn(t,e){var r=t.onShellError;r(e),r=t.onFatalError,r(e),t.destination!==null?(t.status=2,ma(t.destination,e)):(t.status=1,t.fatalError=e)}function ia(t,e,r,n,s){for(Ce={},Ks=e,hr=0,t=r(n,s);vn;)vn=!1,hr=0,Cn+=1,P=null,t=r(n,s);return Qs(),t}function aa(t,e,r,n){var s=r.render(),o=n.childContextTypes;if(o!=null){var i=e.legacyContext;if(typeof r.getChildContext!="function")n=i;else{r=r.getChildContext();for(var a in r)if(!(a in o))throw Error(v(108,Ms(n)||"Unknown",a));n=cr({},i,r)}e.legacyContext=n,ie(t,e,s),e.legacyContext=i}else ie(t,e,s)}function la(t,e){if(t&&t.defaultProps){e=cr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Hs(t,e,r,n,s){if(typeof r=="function")if(r.prototype&&r.prototype.isReactComponent){s=Yi(r,e.legacyContext);var o=r.contextType;o=new r(n,typeof o=="object"&&o!==null?o._currentValue:s),ta(o,r,n,s),aa(t,e,o,r)}else{o=Yi(r,e.legacyContext),s=ia(t,e,r,n,o);var i=hr!==0;if(typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0)ta(s,r,n,o),aa(t,e,s,r);else if(i){n=e.treeContext,e.treeContext=Bs(n,1,0);try{ie(t,e,s)}finally{e.treeContext=n}}else ie(t,e,s)}else if(typeof r=="string"){switch(s=e.blockedSegment,o=nh(s.chunks,r,n,t.responseState,s.formatContext),s.lastPushedText=!1,i=s.formatContext,s.formatContext=Qc(i,r,n),Vs(t,e,o),s.formatContext=i,r){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:s.chunks.push(sh,b(r),oh)}s.lastPushedText=!1}else{switch(r){case rd:case td:case va:case ba:case _a:ie(t,e,n.children);return;case Ea:ie(t,e,n.children);return;case ed:throw Error(v(343));case Ca:e:{r=e.blockedBoundary,s=e.blockedSegment,o=n.fallback,n=n.children,i=new Set;var a={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:i,errorDigest:null},l=bn(t,s.chunks.length,a,s.formatContext,!1,!1);s.children.push(l),s.lastPushedText=!1;var u=bn(t,0,null,s.formatContext,!1,!1);u.parentFlushed=!0,e.blockedBoundary=a,e.blockedSegment=u;try{if(Vs(t,e,n),u.lastPushedText&&u.textEmbedded&&u.chunks.push(Js),u.status=1,Sn(a,u),a.pendingTasks===0)break e}catch(c){u.status=4,a.forceClientRender=!0,a.errorDigest=dr(t,c)}finally{e.blockedBoundary=r,e.blockedSegment=s}e=Xs(t,o,r,l,i,e.legacyContext,e.context,e.treeContext),t.pingedTasks.push(e)}return}if(typeof r=="object"&&r!==null)switch(r.$$typeof){case ka:if(n=ia(t,e,r.render,n,s),hr!==0){r=e.treeContext,e.treeContext=Bs(r,1,0);try{ie(t,e,n)}finally{e.treeContext=r}}else ie(t,e,n);return;case Ra:r=r.type,n=la(r,n),Hs(t,e,r,n,s);return;case xa:if(s=n.children,r=r._context,n=n.value,o=r._currentValue,r._currentValue=n,i=Xe,Xe=n={parent:i,depth:i===null?0:i.depth+1,context:r,parentValue:o,value:n},e.context=n,ie(t,e,s),t=Xe,t===null)throw Error(v(403));n=t.parentValue,t.context._currentValue=n===nd?t.context._defaultValue:n,t=Xe=t.parent,e.context=t;return;case Sa:n=n.children,n=n(r._currentValue),ie(t,e,n);return;case Gs:s=r._init,r=s(r._payload),n=la(r,n),Hs(t,e,r,n,void 0);return}throw Error(v(130,r==null?r:typeof r,""))}}function ie(t,e,r){if(e.node=r,typeof r=="object"&&r!==null){switch(r.$$typeof){case Yh:Hs(t,e,r.type,r.props,r.ref);return;case wa:throw Error(v(257));case Gs:var n=r._init;r=n(r._payload),ie(t,e,r);return}if(Ds(r)){ua(t,e,r);return}if(r===null||typeof r!="object"?n=null:(n=Xi&&r[Xi]||r["@@iterator"],n=typeof n=="function"?n:null),n&&(n=n.call(r))){if(r=n.next(),!r.done){var s=[];do s.push(r.value),r=n.next();while(!r.done);ua(t,e,s)}return}throw t=Object.prototype.toString.call(r),Error(v(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t))}typeof r=="string"?(n=e.blockedSegment,n.lastPushedText=zi(e.blockedSegment.chunks,r,t.responseState,n.lastPushedText)):typeof r=="number"&&(n=e.blockedSegment,n.lastPushedText=zi(e.blockedSegment.chunks,""+r,t.responseState,n.lastPushedText))}function ua(t,e,r){for(var n=r.length,s=0;s<n;s++){var o=e.treeContext;e.treeContext=Bs(o,n,s);try{Vs(t,e,r[s])}finally{e.treeContext=o}}}function Vs(t,e,r){var n=e.blockedSegment.formatContext,s=e.legacyContext,o=e.context;try{return ie(t,e,r)}catch(l){if(Qs(),typeof l=="object"&&l!==null&&typeof l.then=="function"){r=l;var i=e.blockedSegment,a=bn(t,i.chunks.length,null,i.formatContext,i.lastPushedText,!0);i.children.push(a),i.lastPushedText=!1,t=Xs(t,e.node,e.blockedBoundary,a,e.abortSet,e.legacyContext,e.context,e.treeContext).ping,r.then(t,t),e.blockedSegment.formatContext=n,e.legacyContext=s,e.context=o,_n(o)}else throw e.blockedSegment.formatContext=n,e.legacyContext=s,e.context=o,_n(o),l}}function pd(t){var e=t.blockedBoundary;t=t.blockedSegment,t.status=3,ja(this,e,t)}function $a(t,e,r){var n=t.blockedBoundary;t.blockedSegment.status=3,n===null?(e.allPendingTasks--,e.status!==2&&(e.status=2,e.destination!==null&&e.destination.close())):(n.pendingTasks--,n.forceClientRender||(n.forceClientRender=!0,t=r===void 0?Error(v(432)):r,n.errorDigest=e.onError(t),n.parentFlushed&&e.clientRenderedBoundaries.push(n)),n.fallbackAbortableTasks.forEach(function(s){return $a(s,e,r)}),n.fallbackAbortableTasks.clear(),e.allPendingTasks--,e.allPendingTasks===0&&(n=e.onAllReady,n()))}function Sn(t,e){if(e.chunks.length===0&&e.children.length===1&&e.children[0].boundary===null){var r=e.children[0];r.id=e.id,r.parentFlushed=!0,r.status===1&&Sn(t,r)}else t.completedSegments.push(e)}function ja(t,e,r){if(e===null){if(r.parentFlushed){if(t.completedRootSegment!==null)throw Error(v(389));t.completedRootSegment=r}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=ur,e=t.onShellReady,e())}else e.pendingTasks--,e.forceClientRender||(e.pendingTasks===0?(r.parentFlushed&&r.status===1&&Sn(e,r),e.parentFlushed&&t.completedBoundaries.push(e),e.fallbackAbortableTasks.forEach(pd,t),e.fallbackAbortableTasks.clear()):r.parentFlushed&&r.status===1&&(Sn(e,r),e.completedSegments.length===1&&e.parentFlushed&&t.partialBoundaries.push(e)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function La(t){if(t.status!==2){var e=Xe,r=Ns.current;Ns.current=oa;var n=wn;wn=t.responseState;try{var s=t.pingedTasks,o;for(o=0;o<s.length;o++){var i=s[o],a=t,l=i.blockedSegment;if(l.status===0){_n(i.context);try{ie(a,i,i.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(Js),i.abortSet.delete(i),l.status=1,ja(a,i.blockedBoundary,l)}catch(y){if(Qs(),typeof y=="object"&&y!==null&&typeof y.then=="function"){var u=i.ping;y.then(u,u)}else{i.abortSet.delete(i),l.status=4;var c=i.blockedBoundary,h=y,d=dr(a,h);if(c===null?xn(a,h):(c.pendingTasks--,c.forceClientRender||(c.forceClientRender=!0,c.errorDigest=d,c.parentFlushed&&a.clientRenderedBoundaries.push(c))),a.allPendingTasks--,a.allPendingTasks===0){var f=a.onAllReady;f()}}}finally{}}}s.splice(0,o),t.destination!==null&&Ys(t,t.destination)}catch(y){dr(t,y),xn(t,y)}finally{wn=n,Ns.current=r,r===oa&&_n(e)}}}function fn(t,e,r){switch(r.parentFlushed=!0,r.status){case 0:var n=r.id=t.nextSegmentId++;return r.lastPushedText=!1,r.textEmbedded=!1,t=t.responseState,m(e,ih),m(e,t.placeholderPrefix),t=b(n.toString(16)),m(e,t),O(e,ah);case 1:r.status=2;var s=!0;n=r.chunks;var o=0;r=r.children;for(var i=0;i<r.length;i++){for(s=r[i];o<s.index;o++)m(e,n[o]);s=En(t,e,s)}for(;o<n.length-1;o++)m(e,n[o]);return o<n.length&&(s=O(e,n[o])),s;default:throw Error(v(390))}}function En(t,e,r){var n=r.boundary;if(n===null)return fn(t,e,r);if(n.parentFlushed=!0,n.forceClientRender)n=n.errorDigest,O(e,hh),m(e,fh),n&&(m(e,mh),m(e,b(M(n))),m(e,ph)),O(e,yh),fn(t,e,r);else if(0<n.pendingTasks){n.rootSegmentID=t.nextSegmentId++,0<n.completedSegments.length&&t.partialBoundaries.push(n);var s=t.responseState,o=s.nextSuspenseID++;s=p(s.boundaryPrefix+o.toString(16)),n=n.id=s,Qi(e,t.responseState,n),fn(t,e,r)}else if(n.byteSize>t.progressiveChunkSize)n.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(n),Qi(e,t.responseState,n.id),fn(t,e,r);else{if(O(e,lh),r=n.completedSegments,r.length!==1)throw Error(v(391));En(t,e,r[0])}return O(e,dh)}function ca(t,e,r){return Fh(e,t.responseState,r.formatContext,r.id),En(t,e,r),Nh(e,r.formatContext)}function ha(t,e,r){for(var n=r.completedSegments,s=0;s<n.length;s++)Ua(t,e,r,n[s]);if(n.length=0,t=t.responseState,n=r.id,r=r.rootSegmentID,m(e,t.startInlineScript),t.sentCompleteBoundaryFunction?m(e,zh):(t.sentCompleteBoundaryFunction=!0,m(e,Vh)),n===null)throw Error(v(395));return r=b(r.toString(16)),m(e,n),m(e,Wh),m(e,t.segmentPrefix),m(e,r),O(e,Jh)}function Ua(t,e,r,n){if(n.status===2)return!0;var s=n.id;if(s===-1){if((n.id=r.rootSegmentID)===-1)throw Error(v(392));return ca(t,e,n)}return ca(t,e,n),t=t.responseState,m(e,t.startInlineScript),t.sentCompleteSegmentFunction?m(e,Mh):(t.sentCompleteSegmentFunction=!0,m(e,Dh)),m(e,t.segmentPrefix),s=b(s.toString(16)),m(e,s),m(e,Bh),m(e,t.placeholderPrefix),m(e,s),O(e,Hh)}function Ys(t,e){se=new Uint8Array(512),oe=0;try{var r=t.completedRootSegment;if(r!==null&&t.pendingRootTasks===0){En(t,e,r),t.completedRootSegment=null;var n=t.responseState.bootstrapChunks;for(r=0;r<n.length-1;r++)m(e,n[r]);r<n.length&&O(e,n[r])}var s=t.clientRenderedBoundaries,o;for(o=0;o<s.length;o++){var i=s[o];n=e;var a=t.responseState,l=i.id,u=i.errorDigest,c=i.errorMessage,h=i.errorComponentStack;if(m(n,a.startInlineScript),a.sentClientRenderFunction?m(n,Kh):(a.sentClientRenderFunction=!0,m(n,Gh)),l===null)throw Error(v(395));if(m(n,l),m(n,Zh),(u||c||h)&&(m(n,Us),m(n,b(Fs(u||"")))),(c||h)&&(m(n,Us),m(n,b(Fs(c||"")))),h&&(m(n,Us),m(n,b(Fs(h)))),!O(n,Qh)){t.destination=null,o++,s.splice(0,o);return}}s.splice(0,o);var d=t.completedBoundaries;for(o=0;o<d.length;o++)if(!ha(t,e,d[o])){t.destination=null,o++,d.splice(0,o);return}d.splice(0,o),Mi(e),se=new Uint8Array(512),oe=0;var f=t.partialBoundaries;for(o=0;o<f.length;o++){var y=f[o];e:{s=t,i=e;var w=y.completedSegments;for(a=0;a<w.length;a++)if(!Ua(s,i,y,w[a])){a++,w.splice(0,a);var x=!1;break e}w.splice(0,a),x=!0}if(!x){t.destination=null,o++,f.splice(0,o);return}}f.splice(0,o);var q=t.completedBoundaries;for(o=0;o<q.length;o++)if(!ha(t,e,q[o])){t.destination=null,o++,q.splice(0,o);return}q.splice(0,o)}finally{Mi(e),t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&e.close()}}function da(t,e){try{var r=t.abortableTasks;r.forEach(function(n){return $a(n,t,e)}),r.clear(),t.destination!==null&&Ys(t,t.destination)}catch(n){dr(t,n),xn(t,n)}}eo.renderToReadableStream=function(t,e){return new Promise(function(r,n){var s,o,i=new Promise(function(c,h){o=c,s=h}),a=fd(t,Kc(e?e.identifierPrefix:void 0,e?e.nonce:void 0,e?e.bootstrapScriptContent:void 0,e?e.bootstrapScripts:void 0,e?e.bootstrapModules:void 0),Zc(e?e.namespaceURI:void 0),e?e.progressiveChunkSize:void 0,e?e.onError:void 0,o,function(){var c=new ReadableStream({type:"bytes",pull:function(h){if(a.status===1)a.status=2,ma(h,a.fatalError);else if(a.status!==2&&a.destination===null){a.destination=h;try{Ys(a,h)}catch(d){dr(a,d),xn(a,d)}}},cancel:function(){da(a)}},{highWaterMark:0});c.allReady=i,r(c)},function(c){i.catch(function(){}),n(c)},s);if(e&&e.signal){var l=e.signal,u=function(){da(a,l.reason),l.removeEventListener("abort",u)};l.addEventListener("abort",u)}La(a)})};eo.version="18.2.0"});var Da=me(Ye=>{"use strict";var St,Na;St=Di(),Na=Fa();Ye.version=St.version;Ye.renderToString=St.renderToString;Ye.renderToStaticMarkup=St.renderToStaticMarkup;Ye.renderToNodeStream=St.renderToNodeStream;Ye.renderToStaticNodeStream=St.renderToStaticNodeStream;Ye.renderToReadableStream=Na.renderToReadableStream});var He=me((Dt,Dl)=>{"use strict";var rp=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("unable to locate global object")},ct=rp();Dl.exports=Dt=ct.fetch;ct.fetch&&(Dt.default=ct.fetch.bind(ct));Dt.Headers=ct.Headers;Dt.Request=ct.Request;Dt.Response=ct.Response});var Jl=me((s0,Wl)=>{var zl=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};Wl.exports=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return zl()}try{return __global__||zl()}finally{delete Object.prototype.__global__}}()});var Gl=me((o0,sp)=>{sp.exports={name:"websocket",description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],author:"Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",contributors:["I\xF1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],version:"1.0.34",repository:{type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},homepage:"https://github.com/theturtle32/WebSocket-Node",engines:{node:">=4.0.0"},dependencies:{bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},devDependencies:{"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},config:{verbose:!1},scripts:{test:"tape test/unit/*.js",gulp:"gulp"},main:"index",directories:{lib:"./lib"},browser:"lib/browser.js",license:"Apache-2.0"}});var Zl=me((i0,Kl)=>{Kl.exports=Gl().version});var Yl=me((a0,Xl)=>{var ht;if(typeof globalThis=="object")ht=globalThis;else try{ht=Jl()}catch{}finally{if(!ht&&typeof window<"u"&&(ht=window),!ht)throw new Error("Could not determine global this")}var Pr=ht.WebSocket||ht.MozWebSocket,op=Zl();function Ql(t,e){var r;return e?r=new Pr(t,e):r=new Pr(t),r}Pr&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(t){Object.defineProperty(Ql,t,{get:function(){return Pr[t]}})});Xl.exports={w3cwebsocket:Pr?Ql:null,version:op}});var ju={};Hu(ju,{Welcome:()=>Mp});var Dp,Mp,Lu=Bu(()=>{Dp=`<svg viewBox="0 0 410 400">
<g>
  <path
    fill="currentColor" 
    d="M 195.5,11.5 C 204.33,10.1621 207.83,13.8288 206,22.5C 160.528,68.9724 114.694,115.139 68.5,161C 60,162.5 56.5,159 58,150.5C 103.674,103.993 149.507,57.6597 195.5,11.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 242.5,17.5 C 245.649,17.2114 248.649,17.7114 251.5,19C 296,63.5 340.5,108 385,152.5C 388.167,162.667 384.667,166.167 374.5,163C 330,118.5 285.5,74 241,29.5C 238.66,25.0521 239.16,21.0521 242.5,17.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 110.5,62.5 C 119.746,61.9162 122.579,65.9162 119,74.5C 97.4714,95.6948 76.3048,117.195 55.5,139C 45.3333,142.167 41.8333,138.667 45,128.5C 67.0893,106.578 88.9226,84.5781 110.5,62.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 329.5,62.5 C 332.649,62.2114 335.649,62.7114 338.5,64C 360,85.5 381.5,107 403,128.5C 406.167,138.667 402.667,142.167 392.5,139C 370.667,117.167 348.833,95.3333 327,73.5C 325.812,69.2586 326.645,65.5919 329.5,62.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 186.5,69.5 C 195.33,68.1621 198.83,71.8288 197,80.5C 156.833,121.333 116.667,162.167 76.5,203C 67.6667,204.833 64.1667,201.333 66,192.5C 106.369,151.632 146.536,110.632 186.5,69.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 252.5,74.5 C 255.649,74.2114 258.649,74.7114 261.5,76C 300.667,115.167 339.833,154.333 379,193.5C 382.167,203.667 378.667,207.167 368.5,204C 329.333,164.833 290.167,125.667 251,86.5C 248.66,82.0521 249.16,78.0521 252.5,74.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 334.5,203.5 C 342.328,202.493 345.494,205.826 344,213.5C 326.805,231.029 309.305,248.196 291.5,265C 283.667,266.5 280.5,263.333 282,255.5C 299.395,237.938 316.895,220.604 334.5,203.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 104.5,205.5 C 107.249,205.274 109.916,205.607 112.5,206.5C 129.182,223.348 145.682,240.348 162,257.5C 163.07,266.752 159.237,269.586 150.5,266C 134.333,249.167 118.167,232.333 102,215.5C 100.861,211.579 101.695,208.246 104.5,205.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 374.5,210.5 C 383,208.833 386.167,212.166 384,220.5C 337.5,266.333 291,312.167 244.5,358C 236.667,359.5 233.5,356.333 235,348.5C 281.701,302.632 328.201,256.632 374.5,210.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 51.5,240.5 C 54.6492,240.211 57.6492,240.711 60.5,242C 80.3333,262.5 100.167,283 120,303.5C 123.167,313.667 119.667,317.167 109.5,314C 89.6667,293.5 69.8333,273 50,252.5C 47.6603,248.052 48.1603,244.052 51.5,240.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 389.5,240.5 C 398,238.833 401.167,242.166 399,250.5C 364.137,285.696 329.637,321.196 295.5,357C 287,359.167 283.833,356 286,347.5C 321.067,312.269 355.567,276.602 389.5,240.5 Z"
  />
</g>
<g>
  <path
    fill="currentColor" 
    d="M 104.5,251.5 C 107.187,251.336 109.854,251.503 112.5,252C 142.97,284.137 173.803,315.971 205,347.5C 206.833,356.333 203.333,359.833 194.5,358C 164.03,325.863 133.197,294.029 102,262.5C 100.812,258.259 101.645,254.592 104.5,251.5 Z"
  />
</g>
</svg>`,Mp=`<html>
  <head>
    <style>
        body {
            margin:0;
            background-color: black;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .align {
          display: flex;
          justify-content: center;
          align-items: center;
          flex-direction: row;
          gap: 10px;
        }
        i {
          width: 50px;
          height: 50px;
        }
    </style>
    <title>Welcome to Horus</title>
  </head>
  <div class="align">
  <i>${Dp}</i>
  <h1> Welcome to Horos</h1>
  </div>
</html>`});function Lo(t){let e={};try{new URL(t).searchParams.forEach((r,n)=>{e[n]=r})}catch(r){console.error(`Failed to extract query params from url: ${t}`,r)}return e}function Uo(t,e,r){let n=[],s={},o=e.replace(/:([a-zA-Z]+)(\{[^\}]+\})?/g,(a,l,u)=>(n.push(l),u&&(s[l]=u.slice(1,-1)),`(${s[l]||"[a-zA-Z0-9-_]+"})`)),i=new RegExp(`^${o}$`);return[`${t.toUpperCase()}:${e}`,{handler:r,paramNames:n,regex:i}]}var ds=class{request;_params;_query;constructor(t,e,r){this.request=t,this._params=e,this._query=r}get params(){return this._params}get query(){return this._query}async arrayBuffer(){return this.request.arrayBuffer()}async blob(){return this.request.blob()}async formData(){return this.request.formData()}async json(){return this.request.json()}async text(){return this.request.text()}get keepalive(){return this.request.keepalive}get url(){return this.request.url}clone(){return new ds(this.request,this._params,this._query)}get body(){return this.request.body}get bodyUsed(){return this.request.bodyUsed}get cache(){return this.request.cache}get credentials(){return this.request.credentials}get destination(){return this.request.destination}get headers(){return this.request.headers}get integrity(){return this.request.integrity}get method(){return this.request.method}get mode(){return this.request.mode}get redirect(){return this.request.redirect}get referrer(){return this.request.referrer}get referrerPolicy(){return this.request.referrerPolicy}get signal(){return this.request.signal}getCookie(t){let e=this.request.headers.get("Cookie");if(!e)return t?null:{};let r=e.split(";");if(t){for(let n of r){let[s,o]=n.split("=").map(i=>i.trim());if(s===t)return o}return null}else return r.reduce((n,s)=>{let[o,i]=s.split("=").map(a=>a.trim());return n[o]=i,n},{})}};var Ma=ye(Da(),1),Ba=class{routes=new Map;middlewares=[];errorHandlers=[];notFoundHandler=()=>null;basePath;constructor(t){this.basePath=t?.basePath==="/"?"":t?.basePath||""}_register(t,e,r){let n=e==="/"?this.basePath:`${this.basePath}${e}`,s=`${t.toUpperCase()}:${n}`,[o,i]=Uo(t,n,r);this.routes.set(s,i)}get(t,e){this._register("GET",t,e)}post(t,e){this._register("POST",t,e)}put(t,e){this._register("PUT",t,e)}delete(t,e){this._register("DELETE",t,e)}patch(t,e){this._register("PATCH",t,e)}async fetch(t,e,r){let n={request:t,context:r};return this.handleRequest(n)}listen(t){addEventListener(t,e=>{let r=e,{request:n}=r,s={...r},o={request:n,context:s},i=new URL(n.url);this.basePath=i.pathname;try{e.respondWith(this.handleRequest(o))}catch(a){if(a instanceof Error)for(let l of this.errorHandlers){let u=l(a);if(u)return e.respondWith(u)}return e.respondWith(new Response("Internal Server Error",{status:500}))}})}async handleRequest(t){let{request:e,context:r}=t,n=e.method.toUpperCase(),s=Lo(e.url),o=(()=>{let i=new URL(e.url).pathname;return i.endsWith("/")?i.slice(0,-1):i})();try{let i=await this.executeMiddlewares(e,r);if(i instanceof Response)return i;for(let[a,l]of this.routes)if(a.split(":")[0]===n){let u=l.regex.exec(o);if(u){let c={};l.paramNames.forEach((d,f)=>{c[d]=u[f+1]});let h=new ds(e,c,s);return await l.handler(h,r)}}return this.notFoundHandler()||new Response("Not Found",{status:404})}catch(i){if(i instanceof Error)for(let a of this.errorHandlers){let l=a(i);if(l)return l}return new Response("Internal Server Error",{status:500})}}async render(t){if(typeof t=="string")return new Response(t,{headers:{"Content-Type":"text/html"}});{let e=await(0,Ma.renderToReadableStream)(t);return new Response(e,{headers:{"Content-Type":"text/html"}})}}redirect(t,e=302,r){return new Response(null,{...r,status:e,headers:{...r?.headers||{},Location:t}})}all(t,e,r=[]){["GET","POST","PUT","DELETE","PATCH"].forEach(n=>{r.includes(n)||this._register(n,t,e)})}proxy(t,e){return fetch(t,e)}onNotFound(t){this.notFoundHandler=t}onError(t){this.errorHandlers.push(t)}getRoutes(){return Array.from(this.routes.keys())}use(t,e){let r;if(typeof t=="function")r=t,t="*";else if(e)r=e;else throw new Error("Middleware must be provided when using a string pattern");this.middlewares.push(async(n,s,o)=>{let i=new URL(n.url).pathname;return typeof t=="string"&&(t==="*"||t.endsWith("/*")&&i.startsWith(t.slice(0,-1))||i===`${t}/`)?r(n,s,o):o()})}async executeMiddlewares(t,e){let r=-1,n,s=async()=>{if(r++,r<this.middlewares.length){let o=this.middlewares[r],i=await o(t,e,s);if(i instanceof Response){n=i;return}}};return await s(),n}cors(t="*",e){let r=e.allowHeaders||void 0,n=e.allowMethods||void 0,s=e.exposeHeaders||void 0,o=e.maxAge||void 0,i=e.credentials||void 0;this.use(t,async(a,l,u)=>{if(a.method.toUpperCase()==="OPTIONS"){let c=new Headers;return c.set("Access-Control-Allow-Origin",e.origin),Array.isArray(r)?c.set("Access-Control-Allow-Headers",r.join(",")):c.set("Access-Control-Allow-Headers",r??""),Array.isArray(n)&&c.set("Access-Control-Allow-Methods",n.join(",")),r==="*"&&c.set("Access-Control-Allow-Methods","GET, POST, PUT, DELETE, OPTIONS"),r==="*"?c.set("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept, Authorization, Set-Cookie, X-Requested, credentials"):Array.isArray(r)?c.set("Access-Control-Allow-Headers",r.join(",")):c.set("Access-Control-Allow-Headers",r??""),s&&(Array.isArray(s)?c.set("Access-Control-Expose-Headers",s.join(",")):c.set("Access-Control-Expose-Headers",s)),o&&c.set("Access-Control-Max-Age",o.toString()),i&&c.set("Access-Control-Allow-Credentials","true"),new Response(null,{headers:c})}else return u()})}};var E=class extends Error{code;rawCode;constructor(e,r,n,s){r!==void 0&&(e=`${r}: ${e}`),super(e,{cause:s}),this.code=r,this.rawCode=n,this.name="LibsqlError"}};function Ha(t){let e=md.exec(t);if(e===null)throw new E("The URL is not in a valid format","URL_INVALID");let r=e.groups,n=r.scheme,s=r.authority!==void 0?yd(r.authority):void 0,o=et(r.path),i=r.query!==void 0?wd(r.query):void 0,a=r.fragment!==void 0?et(r.fragment):void 0;return{scheme:n,authority:s,path:o,query:i,fragment:a}}var md=(()=>{let t="(?<scheme>[A-Za-z][A-Za-z.+-]*)",e="(?<authority>[^/?#]*)",r="(?<path>[^?#]*)",n="(?<query>[^#]*)",s="(?<fragment>.*)";return new RegExp(`^${t}:(//${e})?${r}(\\?${n})?(#${s})?$`,"su")})();function yd(t){let e=gd.exec(t);if(e===null)throw new E("The authority part of the URL is not in a valid format","URL_INVALID");let r=e.groups,n=et(r.host_br??r.host),s=r.port?parseInt(r.port,10):void 0,o=r.username!==void 0?{username:et(r.username),password:r.password!==void 0?et(r.password):void 0}:void 0;return{host:n,port:s,userinfo:o}}var gd=(()=>{let t="(?<username>[^:]*)(:(?<password>.*))?",e="((?<host>[^:\\[\\]]*)|(\\[(?<host_br>[^\\[\\]]*)\\]))",r="(?<port>[0-9]*)";return new RegExp(`^(${t}@)?${e}(:${r})?$`,"su")})();function wd(t){let e=t.split("&"),r=[];for(let n of e){if(n==="")continue;let s,o,i=n.indexOf("=");i<0?(s=n,o=""):(s=n.substring(0,i),o=n.substring(i+1)),r.push({key:et(s.replaceAll("+"," ")),value:et(o.replaceAll("+"," "))})}return{pairs:r}}function et(t){try{return decodeURIComponent(t)}catch(e){throw e instanceof URIError?new E(`URL component has invalid percent encoding: ${e}`,"URL_INVALID",void 0,e):e}}function fr(t,e,r){if(e===void 0)throw new E(`URL with scheme ${JSON.stringify(t+":")} requires authority (the "//" part)`,"URL_INVALID");let n=`${t}:`,s=_d(e.host),o=vd(e.port),a=`//${bd(e.userinfo)}${s}${o}`,l=r.split("/").map(encodeURIComponent).join("/");return l!==""&&!l.startsWith("/")&&(l="/"+l),new URL(`${n}${a}${l}`)}function _d(t){return t.includes(":")?`[${encodeURI(t)}]`:encodeURI(t)}function vd(t){return t!==void 0?`:${t}`:""}function bd(t){if(t===void 0)return"";let e=encodeURIComponent(t.username),r=t.password!==void 0?`:${encodeURIComponent(t.password)}`:"";return`${e}${r}@`}var Ka="3.7.5",xd=Ka,Sd=typeof atob=="function",kd=typeof btoa=="function",Ct=typeof Buffer=="function",Va=typeof TextDecoder=="function"?new TextDecoder:void 0,za=typeof TextEncoder=="function"?new TextEncoder:void 0,Cd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",pr=Array.prototype.slice.call(Cd),Rn=(t=>{let e={};return t.forEach((r,n)=>e[r]=n),e})(pr),Ed=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,H=String.fromCharCode.bind(String),Wa=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),Za=t=>t.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),Qa=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),Xa=t=>{let e,r,n,s,o="",i=t.length%3;for(let a=0;a<t.length;){if((r=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255||(s=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=r<<16|n<<8|s,o+=pr[e>>18&63]+pr[e>>12&63]+pr[e>>6&63]+pr[e&63]}return i?o.slice(0,i-3)+"===".substring(i):o},no=kd?t=>btoa(t):Ct?t=>Buffer.from(t,"binary").toString("base64"):Xa,to=Ct?t=>Buffer.from(t).toString("base64"):t=>{let r=[];for(let n=0,s=t.length;n<s;n+=4096)r.push(H.apply(null,t.subarray(n,n+4096)));return no(r.join(""))},Tn=(t,e=!1)=>e?Za(to(t)):to(t),Rd=t=>{if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?H(192|e>>>6)+H(128|e&63):H(224|e>>>12&15)+H(128|e>>>6&63)+H(128|e&63)}else{var e=65536+(t.charCodeAt(0)-55296)*1024+(t.charCodeAt(1)-56320);return H(240|e>>>18&7)+H(128|e>>>12&63)+H(128|e>>>6&63)+H(128|e&63)}},Td=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Ya=t=>t.replace(Td,Rd),Ja=Ct?t=>Buffer.from(t,"utf8").toString("base64"):za?t=>to(za.encode(t)):t=>no(Ya(t)),kt=(t,e=!1)=>e?Za(Ja(t)):Ja(t),Ga=t=>kt(t,!0),Id=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Pd=t=>{switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),r=e-65536;return H((r>>>10)+55296)+H((r&1023)+56320);case 3:return H((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return H((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},el=t=>t.replace(Id,Pd),tl=t=>{if(t=t.replace(/\s+/g,""),!Ed.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(t.length&3));let e,r="",n,s;for(let o=0;o<t.length;)e=Rn[t.charAt(o++)]<<18|Rn[t.charAt(o++)]<<12|(n=Rn[t.charAt(o++)])<<6|(s=Rn[t.charAt(o++)]),r+=n===64?H(e>>16&255):s===64?H(e>>16&255,e>>8&255):H(e>>16&255,e>>8&255,e&255);return r},so=Sd?t=>atob(Qa(t)):Ct?t=>Buffer.from(t,"base64").toString("binary"):tl,rl=Ct?t=>Wa(Buffer.from(t,"base64")):t=>Wa(so(t).split("").map(e=>e.charCodeAt(0))),nl=t=>rl(sl(t)),Ad=Ct?t=>Buffer.from(t,"base64").toString("utf8"):Va?t=>Va.decode(rl(t)):t=>el(so(t)),sl=t=>Qa(t.replace(/[-_]/g,e=>e=="-"?"+":"/")),ro=t=>Ad(sl(t)),Od=t=>{if(typeof t!="string")return!1;let e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},ol=t=>({value:t,enumerable:!1,writable:!0,configurable:!0}),il=function(){let t=(e,r)=>Object.defineProperty(String.prototype,e,ol(r));t("fromBase64",function(){return ro(this)}),t("toBase64",function(e){return kt(this,e)}),t("toBase64URI",function(){return kt(this,!0)}),t("toBase64URL",function(){return kt(this,!0)}),t("toUint8Array",function(){return nl(this)})},al=function(){let t=(e,r)=>Object.defineProperty(Uint8Array.prototype,e,ol(r));t("toBase64",function(e){return Tn(this,e)}),t("toBase64URI",function(){return Tn(this,!0)}),t("toBase64URL",function(){return Tn(this,!0)})},qd=()=>{il(),al()},Et={version:Ka,VERSION:xd,atob:so,atobPolyfill:tl,btoa:no,btoaPolyfill:Xa,fromBase64:ro,toBase64:kt,encode:kt,encodeURI:Ga,encodeURL:Ga,utob:Ya,btou:el,decode:ro,isValid:Od,fromUint8Array:Tn,toUint8Array:nl,extendString:il,extendUint8Array:al,extendBuiltins:qd};var Ee="https://github.com/libsql/libsql-client-ts#supported-urls";function Pn(t){if(t==="write")return"BEGIN IMMEDIATE";if(t==="read")return"BEGIN TRANSACTION READONLY";if(t==="deferred")return"BEGIN DEFERRED";throw RangeError('Unknown transaction mode, supported values are "write", "read" and "deferred"')}var In=class{columns;columnTypes;rows;rowsAffected;lastInsertRowid;constructor(e,r,n,s,o){this.columns=e,this.columnTypes=r,this.rows=n,this.rowsAffected=s,this.lastInsertRowid=o}toJSON(){return{columns:this.columns,columnTypes:this.columnTypes,rows:this.rows.map($d),rowsAffected:this.rowsAffected,lastInsertRowid:this.lastInsertRowid!==void 0?""+this.lastInsertRowid:null}}};function $d(t){return Array.prototype.map.call(t,jd)}function jd(t){return typeof t=="bigint"?""+t:t instanceof ArrayBuffer?Et.fromUint8Array(new Uint8Array(t)):t}function An(t,e){if(typeof t!="object")throw new TypeError(`Expected client configuration as object, got ${typeof t}`);let r=Ha(t.url),n=t.tls,s=t.authToken;for(let{key:u,value:c}of r.query?.pairs??[])if(u==="authToken")s=c||void 0;else if(u==="tls")if(c==="0")n=!1;else if(c==="1")n=!0;else throw new E(`Unknown value for the "tls" query argument: ${JSON.stringify(c)}. Supported values are "0" and "1"`,"URL_INVALID");else throw new E(`Unknown URL query parameter ${JSON.stringify(u)}`,"URL_PARAM_NOT_SUPPORTED");let o=t.syncUrl,i=r.scheme.toLowerCase(),a;if(i==="libsql")if(n===!1){if(r.authority?.port===void 0)throw new E('A "libsql:" URL with ?tls=0 must specify an explicit port',"URL_INVALID");a=e?"http":"ws"}else a=e?"https":"wss";else if(i==="http"||i==="ws")a=i,n??=!1;else if(i==="https"||i==="wss"||i==="file")a=i;else throw new E(`The client supports only "libsql:", "wss:", "ws:", "https:", "http:" and "file:" URLs, got ${JSON.stringify(r.scheme+":")}. For more information, please read ${Ee}`,"URL_SCHEME_NOT_SUPPORTED");if(r.fragment!==void 0)throw new E(`URL fragments are not supported: ${JSON.stringify("#"+r.fragment)}`,"URL_INVALID");let l=""+(t.intMode??"number");if(l!=="number"&&l!=="bigint"&&l!=="string")throw new TypeError(`Invalid value for intMode, expected "number", "bigint" or "string",             got ${JSON.stringify(l)}`);return{scheme:a,tls:n??!0,authority:r.authority,path:r.path,authToken:s,syncUrl:o,intMode:l,fetch:t.fetch}}var Ue;typeof WebSocket<"u"?Ue=WebSocket:typeof globalThis<"u"?Ue=globalThis.WebSocket:typeof window<"u"?Ue=window.WebSocket:typeof self<"u"&&(Ue=self.WebSocket);var tt=class{constructor(){this.intMode="number"}intMode};var R=class extends Error{constructor(e){super(e),this.name="ClientError"}},g=class extends R{constructor(e){super(e),this.name="ProtoError"}},Rt=class extends R{code;proto;constructor(e,r){super(e),this.name="ResponseError",this.code=r.code,this.proto=r,this.stack=void 0}},$=class extends R{constructor(e,r){r!==void 0?(super(`${e}: ${r}`),this.cause=r):super(e),this.name="ClosedError"}},Tt=class extends R{constructor(e){super(e),this.name="WebSocketUnsupportedError"}},rt=class extends R{constructor(e){super(e),this.name="WebSocketError"}},It=class extends R{status;constructor(e,r){super(e),this.status=r,this.name="HttpServerError"}};var ue=class extends R{constructor(e){super(e),this.name="ProtocolVersionError"}},V=class extends R{constructor(e){super(e),this.name="InternalError"}},fe=class extends R{constructor(e){super(e),this.name="MisuseError"}};function X(t){if(typeof t=="string")return t;throw Pt(t,"string")}function ae(t){if(t!=null){if(typeof t=="string")return t;throw Pt(t,"string or null")}}function Re(t){if(typeof t=="number")return t;throw Pt(t,"number")}function Fe(t){if(typeof t=="boolean")return t;throw Pt(t,"boolean")}function mr(t){if(Array.isArray(t))return t;throw Pt(t,"array")}function L(t){if(t!==null&&typeof t=="object"&&!Array.isArray(t))return t;throw Pt(t,"object")}function pe(t,e){return mr(t).map(r=>e(L(r)))}function Pt(t,e){if(t===void 0)return new g(`Expected ${e}, but the property was missing`);let r=typeof t;return t===null?r="null":Array.isArray(t)&&(r="array"),new g(`Expected ${e}, received ${r}`)}function nt(t,e){return e(L(t))}var oo=class{#e;#t;constructor(e){this.#e=e,this.#t=!1}begin(){this.#e.push("{"),this.#t=!0}end(){this.#e.push("}"),this.#t=!1}#r(e){this.#t?(this.#e.push('"'),this.#t=!1):this.#e.push(',"'),this.#e.push(e),this.#e.push('":')}string(e,r){this.#r(e),this.#e.push(JSON.stringify(r))}stringRaw(e,r){this.#r(e),this.#e.push('"'),this.#e.push(r),this.#e.push('"')}number(e,r){this.#r(e),this.#e.push(""+r)}boolean(e,r){this.#r(e),this.#e.push(r?"true":"false")}object(e,r,n){this.#r(e),this.begin(),n(this,r),this.end()}arrayObjects(e,r,n){this.#r(e),this.#e.push("[");for(let s=0;s<r.length;++s)s!==0&&this.#e.push(","),this.begin(),n(this,r[s]),this.end();this.#e.push("]")}};function yr(t,e){let r=[],n=new oo(r);return n.begin(),e(n,t),n.end(),r.join("")}var io=class{#e;#t;#r;constructor(e){this.#e=e,this.#t=new DataView(e.buffer,e.byteOffset,e.byteLength),this.#r=0}varint(){let e=0;for(let r=0;;r+=7){let n=this.#e[this.#r++];if(e|=(n&127)<<r,!(n&128))break}return e}varintBig(){let e=0n;for(let r=0n;;r+=7n){let n=this.#e[this.#r++];if(e|=BigInt(n&127)<<r,!(n&128))break}return e}bytes(e){let r=new Uint8Array(this.#e.buffer,this.#e.byteOffset+this.#r,e);return this.#r+=e,r}double(){let e=this.#t.getFloat64(this.#r,!0);return this.#r+=8,e}skipVarint(){for(;this.#e[this.#r++]&128;);}skip(e){this.#r+=e}eof(){return this.#r>=this.#e.byteLength}},ao=class{#e;#t;constructor(e){this.#e=e,this.#t=-1}setup(e){this.#t=e}#r(e){if(this.#t!==e)throw new g(`Expected wire type ${e}, got ${this.#t}`);this.#t=-1}bytes(){this.#r(2);let e=this.#e.varint();return this.#e.bytes(e)}string(){return new TextDecoder().decode(this.bytes())}message(e){return Ne(this.bytes(),e)}int32(){return this.#r(0),this.#e.varint()}uint32(){return this.int32()}bool(){return this.int32()!==0}uint64(){return this.#r(0),this.#e.varintBig()}sint64(){let e=this.uint64();return e>>1n^-(e&1n)}double(){return this.#r(1),this.#e.double()}maybeSkip(){if(!(this.#t<0)){if(this.#t===0)this.#e.skipVarint();else if(this.#t===1)this.#e.skip(8);else if(this.#t===2){let e=this.#e.varint();this.#e.skip(e)}else if(this.#t===5)this.#e.skip(4);else throw new g(`Unexpected wire type ${this.#t}`);this.#t=-1}}};function Ne(t,e){let r=new io(t),n=new ao(r),s=e.default();for(;!r.eof();){let o=r.varint(),i=o>>3,a=o&7;n.setup(a);let l=e[i];if(l!==void 0){let u=l(n,s);u!==void 0&&(s=u)}n.maybeSkip()}return s}var lo=class t{#e;#t;#r;#n;constructor(){this.#e=new ArrayBuffer(256),this.#t=new Uint8Array(this.#e),this.#r=new DataView(this.#e),this.#n=0}#o(e){if(this.#n+e<=this.#e.byteLength)return;let r=this.#e.byteLength;for(;r<this.#n+e;)r*=2;let n=new ArrayBuffer(r),s=new Uint8Array(n),o=new DataView(n);s.set(new Uint8Array(this.#e,0,this.#n)),this.#e=n,this.#t=s,this.#r=o}#s(e){this.#o(5),e=0|e;do{let r=e&127;e>>>=7,r|=e?128:0,this.#t[this.#n++]=r}while(e)}#i(e){this.#o(10),e=e&0xffffffffffffffffn;do{let r=Number(e&0x7fn);e>>=7n,r|=e?128:0,this.#t[this.#n++]=r}while(e)}#a(e,r){this.#s(e<<3|r)}bytes(e,r){this.#a(e,2),this.#s(r.byteLength),this.#o(r.byteLength),this.#t.set(r,this.#n),this.#n+=r.byteLength}string(e,r){this.bytes(e,new TextEncoder().encode(r))}message(e,r,n){let s=new t;n(s,r),this.bytes(e,s.data())}int32(e,r){this.#a(e,0),this.#s(r)}uint32(e,r){this.int32(e,r)}bool(e,r){this.int32(e,r?1:0)}sint64(e,r){this.#a(e,0),this.#i(r<<1n^r>>63n)}double(e,r){this.#a(e,1),this.#o(8),this.#r.setFloat64(this.#n,r,!0),this.#n+=8}data(){return new Uint8Array(this.#e,0,this.#n)}};function gr(t,e){let r=new lo;return e(r,t),r.data()}var Te=class{#e;#t;constructor(){this.#e=new Set,this.#t=new Set}alloc(){for(let r of this.#t)return this.#t.delete(r),this.#e.add(r),this.#e.has(this.#e.size-1)||this.#t.add(this.#e.size-1),r;let e=this.#e.size;return this.#e.add(e),e}free(e){if(!this.#e.delete(e))throw new V("Freeing an id that is not allocated");this.#t.delete(this.#e.size),e<this.#e.size&&this.#t.add(e)}};function T(t,e){throw new V(e)}function Ot(t){if(t===null)return null;if(typeof t=="string")return t;if(typeof t=="number"){if(!Number.isFinite(t))throw new RangeError("Only finite numbers (not Infinity or NaN) can be passed as arguments");return t}else if(typeof t=="bigint"){if(t<Fd||t>Nd)throw new RangeError("This bigint value is too large to be represented as a 64-bit integer and passed as argument");return t}else{if(typeof t=="boolean")return t?1n:0n;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(t instanceof Uint8Array)return t;if(t instanceof Date)return+t.valueOf();if(typeof t=="object")return""+t.toString();throw new TypeError("Unsupported type of value")}}var Fd=-9223372036854775808n,Nd=9223372036854775807n;function uo(t,e){if(t===null)return null;if(typeof t=="number")return t;if(typeof t=="string")return t;if(typeof t=="bigint")if(e==="number"){let r=Number(t);if(!Number.isSafeInteger(r))throw new RangeError("Received integer which is too large to be safely represented as a JavaScript number");return r}else{if(e==="bigint")return t;if(e==="string")return""+t;throw new fe("Invalid value for IntMode")}else{if(t instanceof Uint8Array)return t.slice().buffer;throw t===void 0?new g("Received unrecognized type of Value"):T(t,"Impossible type of Value")}}function st(t){return{affectedRowCount:t.affectedRowCount,lastInsertRowid:t.lastInsertRowid,columnNames:t.cols.map(e=>e.name),columnDecltypes:t.cols.map(e=>e.decltype)}}function jn(t,e){let r=st(t),n=t.rows.map(s=>ll(r.columnNames,s,e));return{...r,rows:n}}function Ln(t,e){let r=st(t),n;return t.rows.length>0&&(n=ll(r.columnNames,t.rows[0],e)),{...r,row:n}}function Un(t,e){let r=st(t),n;return t.rows.length>0&&r.columnNames.length>0&&(n=uo(t.rows[0][0],e)),{...r,value:n}}function ll(t,e,r){let n={};Object.defineProperty(n,"length",{value:e.length});for(let s=0;s<e.length;++s){let o=uo(e[s],r);Object.defineProperty(n,s,{value:o});let i=t[s];i!==void 0&&!Object.hasOwn(n,i)&&Object.defineProperty(n,i,{value:o,enumerable:!0})}return n}function Ie(t){return new Rt(t.message,t)}var De=class{#e;#t;#r;constructor(e,r){this.#e=e,this.#t=r,this.#r=void 0}_getSqlId(e){if(this.#e!==e)throw new fe("Attempted to use SQL text opened with other object");if(this.#r!==void 0)throw new $("SQL text is closed",this.#r);return this.#t}close(){this._setClosed(new R("SQL text was manually closed"))}_setClosed(e){this.#r===void 0&&(this.#r=e,this.#e._closeSql(this.#t))}get closed(){return this.#r!==void 0}};function wr(t,e){return e instanceof De?{sqlId:e._getSqlId(t)}:{sql:""+e}}var Pe=class{#e;#t;constructor(){this.#e=[],this.#t=[]}get length(){return this.#e.length+this.#t.length}push(e){this.#e.push(e)}shift(){return this.#t.length===0&&this.#e.length>0&&(this.#t=this.#e.reverse(),this.#e=[]),this.#t.pop()}first(){return this.#t.length!==0?this.#t[this.#t.length-1]:this.#e[0]}};var ot=class{sql;_args;_namedArgs;constructor(e){this.sql=e,this._args=[],this._namedArgs=new Map}bindIndexes(e){this._args.length=0;for(let r of e)this._args.push(Ot(r));return this}bindIndex(e,r){if(e!==(e|0)||e<=0)throw new RangeError("Index of a positional argument must be positive integer");for(;this._args.length<e;)this._args.push(null);return this._args[e-1]=Ot(r),this}bindName(e,r){return this._namedArgs.set(e,Ot(r)),this}unbindAll(){return this._args.length=0,this._namedArgs.clear(),this}};function Fn(t,e,r){let n,s=[],o=[];if(e instanceof ot){n=e.sql,s=e._args;for(let[l,u]of e._namedArgs.entries())o.push({name:l,value:u})}else Array.isArray(e)?(n=e[0],Array.isArray(e[1])?s=e[1].map(l=>Ot(l)):o=Object.entries(e[1]).map(([l,u])=>({name:l,value:Ot(u)}))):n=e;let{sql:i,sqlId:a}=wr(t,n);return{sql:i,sqlId:a,args:s,namedArgs:o,wantRows:r}}var _r=class{_stream;#e;_steps;#t;constructor(e,r){this._stream=e,this.#e=r,this._steps=[],this.#t=!1}step(){return new Nn(this)}execute(){if(this.#t)throw new fe("This batch has already been executed");this.#t=!0;let e={steps:this._steps.map(r=>r.proto)};return this.#e?Md(this._stream,this._steps,e):Dd(this._stream,this._steps,e)}};function Dd(t,e,r){return t._batch(r).then(n=>{for(let s=0;s<e.length;++s){let o=n.stepResults.get(s),i=n.stepErrors.get(s);e[s].callback(o,i)}})}async function Md(t,e,r){let n=await t._openCursor(r);try{let s=0,o,i=[];for(;;){let a=await n.next();if(a===void 0)break;if(a.type==="step_begin"){if(a.step<s||a.step>=e.length)throw new g("Server produced StepBeginEntry for unexpected step");if(o!==void 0)throw new g("Server produced StepBeginEntry before terminating previous step");for(let l=s;l<a.step;++l)e[l].callback(void 0,void 0);s=a.step+1,o=a,i=[]}else if(a.type==="step_end"){if(o===void 0)throw new g("Server produced StepEndEntry but no step is active");let l={cols:o.cols,rows:i,affectedRowCount:a.affectedRowCount,lastInsertRowid:a.lastInsertRowid};e[o.step].callback(l,void 0),o=void 0,i=[]}else if(a.type==="step_error"){if(o===void 0){if(a.step>=e.length)throw new g("Server produced StepErrorEntry for unexpected step");for(let l=s;l<a.step;++l)e[l].callback(void 0,void 0)}else{if(a.step!==o.step)throw new g("Server produced StepErrorEntry for unexpected step");o=void 0,i=[]}e[a.step].callback(void 0,a.error),s=a.step+1}else if(a.type==="row"){if(o===void 0)throw new g("Server produced RowEntry but no step is active");i.push(a.row)}else throw a.type==="error"?Ie(a.error):a.type==="none"?new g("Server produced unrecognized CursorEntry"):T(a,"Impossible CursorEntry")}if(o!==void 0)throw new g("Server closed Cursor before terminating active step");for(let a=s;a<e.length;++a)e[a].callback(void 0,void 0)}finally{n.close()}}var Nn=class{_batch;#e;_index;constructor(e){this._batch=e,this.#e=[],this._index=void 0}condition(e){return this.#e.push(e._proto),this}query(e){return this.#t(e,!0,jn)}queryRow(e){return this.#t(e,!0,Ln)}queryValue(e){return this.#t(e,!0,Un)}run(e){return this.#t(e,!1,st)}#t(e,r,n){if(this._index!==void 0)throw new fe("This BatchStep has already been added to the batch");let s=Fn(this._batch._stream._sqlOwner(),e,r),o;this.#e.length===0?o=void 0:this.#e.length===1?o=this.#e[0]:o={type:"and",conds:this.#e.slice()};let i={stmt:s,condition:o};return new Promise((a,l)=>{let u=(c,h)=>{c!==void 0&&h!==void 0?l(new g("Server returned both result and error")):h!==void 0?l(Ie(h)):a(c!==void 0?n(c,this._batch._stream.intMode):void 0)};this._index=this._batch._steps.length,this._batch._steps.push({proto:i,callback:u})})}},F=class t{_batch;_proto;constructor(e,r){this._batch=e,this._proto=r}static ok(e){return new t(e._batch,{type:"ok",step:ul(e)})}static error(e){return new t(e._batch,{type:"error",step:ul(e)})}static not(e){return new t(e._batch,{type:"not",cond:e._proto})}static and(e,r){for(let n of r)cl(e,n);return new t(e,{type:"and",conds:r.map(n=>n._proto)})}static or(e,r){for(let n of r)cl(e,n);return new t(e,{type:"or",conds:r.map(n=>n._proto)})}static isAutocommit(e){return e._stream.client()._ensureVersion(3,"BatchCond.isAutocommit()"),new t(e,{type:"is_autocommit"})}};function ul(t){if(t._index===void 0)throw new fe("Cannot add a condition referencing a step that has not been added to the batch");return t._index}function cl(t,e){if(e._batch!==t)throw new fe("Cannot mix BatchCond objects for different Batch objects")}function hl(t){return{paramNames:t.params.map(e=>e.name),columns:t.cols,isExplain:t.isExplain,isReadonly:t.isReadonly}}var it=class{constructor(e){this.intMode=e}query(e){return this.#e(e,!0,jn)}queryRow(e){return this.#e(e,!0,Ln)}queryValue(e){return this.#e(e,!0,Un)}run(e){return this.#e(e,!1,st)}#e(e,r,n){let s=Fn(this._sqlOwner(),e,r);return this._execute(s).then(o=>n(o,this.intMode))}batch(e=!1){return new _r(this,e)}describe(e){let r=wr(this._sqlOwner(),e);return this._describe(r).then(hl)}sequence(e){let r=wr(this._sqlOwner(),e);return this._sequence(r)}intMode};var qt=class{};var Bd=1e3,Hd=10,Dn=class extends qt{#e;#t;#r;#n;#o;#s;#i;constructor(e,r,n){super(),this.#e=e,this.#t=r,this.#r=n,this.#n=new Pe,this.#o=new Pe,this.#s=void 0,this.#i=!1}async next(){for(;;){if(this.#s!==void 0)throw new $("Cursor is closed",this.#s);for(;!this.#i&&this.#o.length<Hd;)this.#o.push(this.#a());let e=this.#n.shift();if(this.#i||e!==void 0)return e;await this.#o.shift().then(r=>{if(r!==void 0){for(let n of r.entries)this.#n.push(n);this.#i||=r.done}})}}#a(){return this.#t._sendCursorRequest(this,{type:"fetch_cursor",cursorId:this.#r,maxCount:Bd}).then(e=>e,e=>{this._setClosed(e)})}_setClosed(e){this.#s===void 0&&(this.#s=e,this.#t._sendCursorRequest(this,{type:"close_cursor",cursorId:this.#r}).catch(()=>{}),this.#t._cursorClosed(this))}close(){this._setClosed(new R("Cursor was manually closed"))}get closed(){return this.#s!==void 0}};var vr=class t extends it{#e;#t;#r;#n;#o;#s;static open(e){let r=e._streamIdAlloc.alloc(),n=new t(e,r),s=()=>{},o=a=>n.#u(a),i={type:"open_stream",streamId:r};return e._sendRequest(i,{responseCallback:s,errorCallback:o}),n}constructor(e,r){super(e.intMode),this.#e=e,this.#t=r,this.#r=new Pe,this.#n=void 0,this.#o=!1,this.#s=void 0}client(){return this.#e}_sqlOwner(){return this.#e}_execute(e){return this.#i({type:"execute",streamId:this.#t,stmt:e}).then(r=>r.result)}_batch(e){return this.#i({type:"batch",streamId:this.#t,batch:e}).then(r=>r.result)}_describe(e){return this.#e._ensureVersion(2,"describe()"),this.#i({type:"describe",streamId:this.#t,sql:e.sql,sqlId:e.sqlId}).then(r=>r.result)}_sequence(e){return this.#e._ensureVersion(2,"sequence()"),this.#i({type:"sequence",streamId:this.#t,sql:e.sql,sqlId:e.sqlId}).then(r=>{})}getAutocommit(){return this.#e._ensureVersion(3,"getAutocommit()"),this.#i({type:"get_autocommit",streamId:this.#t}).then(e=>e.isAutocommit)}#i(e){return new Promise((r,n)=>{this.#a({type:"request",request:e,responseCallback:r,errorCallback:n})})}_openCursor(e){return this.#e._ensureVersion(3,"cursor"),new Promise((r,n)=>{this.#a({type:"cursor",batch:e,cursorCallback:r,errorCallback:n})})}_sendCursorRequest(e,r){if(e!==this.#n)throw new V("Cursor not associated with the stream attempted to execute a request");return new Promise((n,s)=>{this.#s!==void 0?s(new $("Stream is closed",this.#s)):this.#e._sendRequest(r,{responseCallback:n,errorCallback:s})})}_cursorClosed(e){if(e!==this.#n)throw new V("Cursor was closed, but it was not associated with the stream");this.#n=void 0,this.#l()}#a(e){this.#s!==void 0?e.errorCallback(new $("Stream is closed",this.#s)):this.#o?e.errorCallback(new $("Stream is closing",void 0)):(this.#r.push(e),this.#l())}#l(){for(;;){let e=this.#r.first();if(e===void 0&&this.#n===void 0&&this.#o){this.#u(new R("Stream was gracefully closed"));break}else if(e?.type==="request"&&this.#n===void 0){let{request:r,responseCallback:n,errorCallback:s}=e;this.#r.shift(),this.#e._sendRequest(r,{responseCallback:n,errorCallback:s})}else if(e?.type==="cursor"&&this.#n===void 0){let{batch:r,cursorCallback:n}=e;this.#r.shift();let s=this.#e._cursorIdAlloc.alloc(),o=new Dn(this.#e,this,s),i={type:"open_cursor",streamId:this.#t,cursorId:s,batch:r},a=()=>{},l=u=>o._setClosed(u);this.#e._sendRequest(i,{responseCallback:a,errorCallback:l}),this.#n=o,n(o)}else break}}#u(e){if(this.#s!==void 0)return;for(this.#s=e,this.#n!==void 0&&this.#n._setClosed(e);;){let o=this.#r.shift();if(o!==void 0)o.errorCallback(e);else break}let r={type:"close_stream",streamId:this.#t},n=()=>this.#e._streamIdAlloc.free(this.#t),s=()=>{};this.#e._sendRequest(r,{responseCallback:n,errorCallback:s})}close(){this.#u(new R("Stream was manually closed"))}closeGracefully(){this.#o=!0,this.#l()}get closed(){return this.#s!==void 0||this.#o}};function br(t,e){e.sql!==void 0&&t.string("sql",e.sql),e.sqlId!==void 0&&t.number("sql_id",e.sqlId),t.arrayObjects("args",e.args,dl),t.arrayObjects("named_args",e.namedArgs,Vd),t.boolean("want_rows",e.wantRows)}function Vd(t,e){t.string("name",e.name),t.object("value",e.value,dl)}function $t(t,e){t.arrayObjects("steps",e.steps,zd)}function zd(t,e){e.condition!==void 0&&t.object("condition",e.condition,co),t.object("stmt",e.stmt,br)}function co(t,e){if(t.stringRaw("type",e.type),e.type==="ok"||e.type==="error")t.number("step",e.step);else if(e.type==="not")t.object("cond",e.cond,co);else if(e.type==="and"||e.type==="or")t.arrayObjects("conds",e.conds,co);else if(e.type!=="is_autocommit")throw T(e,"Impossible type of BatchCond")}function dl(t,e){if(e===null)t.stringRaw("type","null");else if(typeof e=="bigint")t.stringRaw("type","integer"),t.stringRaw("value",""+e);else if(typeof e=="number")t.stringRaw("type","float"),t.number("value",e);else if(typeof e=="string")t.stringRaw("type","text"),t.string("value",e);else if(e instanceof Uint8Array)t.stringRaw("type","blob"),t.stringRaw("base64",Et.fromUint8Array(e));else if(e!==void 0)throw T(e,"Impossible type of Value")}function fl(t,e){if(t.stringRaw("type",e.type),e.type==="hello")e.jwt!==void 0&&t.string("jwt",e.jwt);else if(e.type==="request")t.number("request_id",e.requestId),t.object("request",e.request,Wd);else throw T(e,"Impossible type of ClientMsg")}function Wd(t,e){if(t.stringRaw("type",e.type),e.type==="open_stream")t.number("stream_id",e.streamId);else if(e.type==="close_stream")t.number("stream_id",e.streamId);else if(e.type==="execute")t.number("stream_id",e.streamId),t.object("stmt",e.stmt,br);else if(e.type==="batch")t.number("stream_id",e.streamId),t.object("batch",e.batch,$t);else if(e.type==="open_cursor")t.number("stream_id",e.streamId),t.number("cursor_id",e.cursorId),t.object("batch",e.batch,$t);else if(e.type==="close_cursor")t.number("cursor_id",e.cursorId);else if(e.type==="fetch_cursor")t.number("cursor_id",e.cursorId),t.number("max_count",e.maxCount);else if(e.type==="sequence")t.number("stream_id",e.streamId),e.sql!==void 0&&t.string("sql",e.sql),e.sqlId!==void 0&&t.number("sql_id",e.sqlId);else if(e.type==="describe")t.number("stream_id",e.streamId),e.sql!==void 0&&t.string("sql",e.sql),e.sqlId!==void 0&&t.number("sql_id",e.sqlId);else if(e.type==="store_sql")t.number("sql_id",e.sqlId),t.string("sql",e.sql);else if(e.type==="close_sql")t.number("sql_id",e.sqlId);else if(e.type==="get_autocommit")t.number("stream_id",e.streamId);else throw T(e,"Impossible type of Request")}function xr(t,e){e.sql!==void 0&&t.string(1,e.sql),e.sqlId!==void 0&&t.int32(2,e.sqlId);for(let r of e.args)t.message(3,r,ml);for(let r of e.namedArgs)t.message(4,r,Jd);t.bool(5,e.wantRows)}function Jd(t,e){t.string(1,e.name),t.message(2,e.value,ml)}function jt(t,e){for(let r of e.steps)t.message(1,r,Gd)}function Gd(t,e){e.condition!==void 0&&t.message(1,e.condition,ho),t.message(2,e.stmt,xr)}function ho(t,e){if(e.type==="ok")t.uint32(1,e.step);else if(e.type==="error")t.uint32(2,e.step);else if(e.type==="not")t.message(3,e.cond,ho);else if(e.type==="and")t.message(4,e.conds,pl);else if(e.type==="or")t.message(5,e.conds,pl);else if(e.type==="is_autocommit")t.message(6,void 0,yl);else throw T(e,"Impossible type of BatchCond")}function pl(t,e){for(let r of e)t.message(1,r,ho)}function ml(t,e){if(e===null)t.message(1,void 0,yl);else if(typeof e=="bigint")t.sint64(2,e);else if(typeof e=="number")t.double(3,e);else if(typeof e=="string")t.string(4,e);else if(e instanceof Uint8Array)t.bytes(5,e);else if(e!==void 0)throw T(e,"Impossible type of Value")}function yl(t,e){}function gl(t,e){if(e.type==="hello")t.message(1,e,Kd);else if(e.type==="request")t.message(2,e,Zd);else throw T(e,"Impossible type of ClientMsg")}function Kd(t,e){e.jwt!==void 0&&t.string(1,e.jwt)}function Zd(t,e){t.int32(1,e.requestId);let r=e.request;if(r.type==="open_stream")t.message(2,r,Qd);else if(r.type==="close_stream")t.message(3,r,Xd);else if(r.type==="execute")t.message(4,r,Yd);else if(r.type==="batch")t.message(5,r,ef);else if(r.type==="open_cursor")t.message(6,r,tf);else if(r.type==="close_cursor")t.message(7,r,rf);else if(r.type==="fetch_cursor")t.message(8,r,nf);else if(r.type==="sequence")t.message(9,r,sf);else if(r.type==="describe")t.message(10,r,of);else if(r.type==="store_sql")t.message(11,r,af);else if(r.type==="close_sql")t.message(12,r,lf);else if(r.type==="get_autocommit")t.message(13,r,uf);else throw T(r,"Impossible type of Request")}function Qd(t,e){t.int32(1,e.streamId)}function Xd(t,e){t.int32(1,e.streamId)}function Yd(t,e){t.int32(1,e.streamId),t.message(2,e.stmt,xr)}function ef(t,e){t.int32(1,e.streamId),t.message(2,e.batch,jt)}function tf(t,e){t.int32(1,e.streamId),t.int32(2,e.cursorId),t.message(3,e.batch,jt)}function rf(t,e){t.int32(1,e.cursorId)}function nf(t,e){t.int32(1,e.cursorId),t.uint32(2,e.maxCount)}function sf(t,e){t.int32(1,e.streamId),e.sql!==void 0&&t.string(2,e.sql),e.sqlId!==void 0&&t.int32(3,e.sqlId)}function of(t,e){t.int32(1,e.streamId),e.sql!==void 0&&t.string(2,e.sql),e.sqlId!==void 0&&t.int32(3,e.sqlId)}function af(t,e){t.int32(1,e.sqlId),t.string(2,e.sql)}function lf(t,e){t.int32(1,e.sqlId)}function uf(t,e){t.int32(1,e.streamId)}function Me(t){let e=X(t.message),r=ae(t.code);return{message:e,code:r}}function Sr(t){let e=pe(t.cols,wl),r=mr(t.rows).map(i=>pe(i,_l)),n=Re(t.affected_row_count),s=ae(t.last_insert_rowid),o=s!==void 0?BigInt(s):void 0;return{cols:e,rows:r,affectedRowCount:n,lastInsertRowid:o}}function wl(t){let e=ae(t.name),r=ae(t.decltype);return{name:e,decltype:r}}function Mn(t){let e=new Map;mr(t.step_results).forEach((n,s)=>{n!==null&&e.set(s,Sr(L(n)))});let r=new Map;return mr(t.step_errors).forEach((n,s)=>{n!==null&&r.set(s,Me(L(n)))}),{stepResults:e,stepErrors:r}}function Bn(t){let e=X(t.type);if(e==="step_begin"){let r=Re(t.step),n=pe(t.cols,wl);return{type:"step_begin",step:r,cols:n}}else if(e==="step_end"){let r=Re(t.affected_row_count),n=ae(t.last_insert_rowid),s=n!==void 0?BigInt(n):void 0;return{type:"step_end",affectedRowCount:r,lastInsertRowid:s}}else if(e==="step_error"){let r=Re(t.step),n=Me(L(t.error));return{type:"step_error",step:r,error:n}}else{if(e==="row")return{type:"row",row:pe(t.row,_l)};if(e==="error")return{type:"error",error:Me(L(t.error))};throw new g("Unexpected type of CursorEntry")}}function Hn(t){let e=pe(t.params,cf),r=pe(t.cols,hf),n=Fe(t.is_explain),s=Fe(t.is_readonly);return{params:e,cols:r,isExplain:n,isReadonly:s}}function cf(t){return{name:ae(t.name)}}function hf(t){let e=X(t.name),r=ae(t.decltype);return{name:e,decltype:r}}function _l(t){let e=X(t.type);if(e==="null")return null;if(e==="integer"){let r=X(t.value);return BigInt(r)}else{if(e==="float")return Re(t.value);if(e==="text")return X(t.value);if(e==="blob")return Et.toUint8Array(X(t.base64));throw new g("Unexpected type of Value")}}function vl(t){let e=X(t.type);if(e==="hello_ok")return{type:"hello_ok"};if(e==="hello_error")return{type:"hello_error",error:Me(L(t.error))};if(e==="response_ok"){let r=Re(t.request_id),n=df(L(t.response));return{type:"response_ok",requestId:r,response:n}}else if(e==="response_error"){let r=Re(t.request_id),n=Me(L(t.error));return{type:"response_error",requestId:r,error:n}}else throw new g("Unexpected type of ServerMsg")}function df(t){let e=X(t.type);if(e==="open_stream")return{type:"open_stream"};if(e==="close_stream")return{type:"close_stream"};if(e==="execute")return{type:"execute",result:Sr(L(t.result))};if(e==="batch")return{type:"batch",result:Mn(L(t.result))};if(e==="open_cursor")return{type:"open_cursor"};if(e==="close_cursor")return{type:"close_cursor"};if(e==="fetch_cursor"){let r=pe(t.entries,Bn),n=Fe(t.done);return{type:"fetch_cursor",entries:r,done:n}}else{if(e==="sequence")return{type:"sequence"};if(e==="describe")return{type:"describe",result:Hn(L(t.result))};if(e==="store_sql")return{type:"store_sql"};if(e==="close_sql")return{type:"close_sql"};if(e==="get_autocommit")return{type:"get_autocommit",isAutocommit:Fe(t.is_autocommit)};throw new g("Unexpected type of Response")}}var ce={default(){return{message:"",code:void 0}},1(t,e){e.message=t.string()},2(t,e){e.code=t.string()}},Be={default(){return{cols:[],rows:[],affectedRowCount:0,lastInsertRowid:void 0}},1(t,e){e.cols.push(t.message(bl))},2(t,e){e.rows.push(t.message(xl))},3(t,e){e.affectedRowCount=Number(t.uint64())},4(t,e){e.lastInsertRowid=t.sint64()}},bl={default(){return{name:void 0,decltype:void 0}},1(t,e){e.name=t.string()},2(t,e){e.decltype=t.string()}},xl={default(){return[]},1(t,e){e.push(t.message(vf))}},Lt={default(){return{stepResults:new Map,stepErrors:new Map}},1(t,e){let[r,n]=t.message(ff);e.stepResults.set(r,n)},2(t,e){let[r,n]=t.message(pf);e.stepErrors.set(r,n)}},ff={default(){return[0,Be.default()]},1(t,e){e[0]=t.uint32()},2(t,e){e[1]=t.message(Be)}},pf={default(){return[0,ce.default()]},1(t,e){e[0]=t.uint32()},2(t,e){e[1]=t.message(ce)}},Vn={default(){return{type:"none"}},1(t){return t.message(mf)},2(t){return t.message(yf)},3(t){return t.message(gf)},4(t){return{type:"row",row:t.message(xl)}},5(t){return{type:"error",error:t.message(ce)}}},mf={default(){return{type:"step_begin",step:0,cols:[]}},1(t,e){e.step=t.uint32()},2(t,e){e.cols.push(t.message(bl))}},yf={default(){return{type:"step_end",affectedRowCount:0,lastInsertRowid:void 0}},1(t,e){e.affectedRowCount=t.uint32()},2(t,e){e.lastInsertRowid=t.uint64()}},gf={default(){return{type:"step_error",step:0,error:ce.default()}},1(t,e){e.step=t.uint32()},2(t,e){e.error=t.message(ce)}},Ut={default(){return{params:[],cols:[],isExplain:!1,isReadonly:!1}},1(t,e){e.params.push(t.message(wf))},2(t,e){e.cols.push(t.message(_f))},3(t,e){e.isExplain=t.bool()},4(t,e){e.isReadonly=t.bool()}},wf={default(){return{name:void 0}},1(t,e){e.name=t.string()}},_f={default(){return{name:"",decltype:void 0}},1(t,e){e.name=t.string()},2(t,e){e.decltype=t.string()}},vf={default(){},1(t){return null},2(t){return t.sint64()},3(t){return t.double()},4(t){return t.string()},5(t){return t.bytes()}};var Sl={default(){return{type:"none"}},1(t){return{type:"hello_ok"}},2(t){return t.message(bf)},3(t){return t.message(Sf)},4(t){return t.message(xf)}},bf={default(){return{type:"hello_error",error:ce.default()}},1(t,e){e.error=t.message(ce)}},xf={default(){return{type:"response_error",requestId:0,error:ce.default()}},1(t,e){e.requestId=t.int32()},2(t,e){e.error=t.message(ce)}},Sf={default(){return{type:"response_ok",requestId:0,response:{type:"none"}}},1(t,e){e.requestId=t.int32()},2(t,e){e.response={type:"open_stream"}},3(t,e){e.response={type:"close_stream"}},4(t,e){e.response=t.message(kf)},5(t,e){e.response=t.message(Cf)},6(t,e){e.response={type:"open_cursor"}},7(t,e){e.response={type:"close_cursor"}},8(t,e){e.response=t.message(Ef)},9(t,e){e.response={type:"sequence"}},10(t,e){e.response=t.message(Rf)},11(t,e){e.response={type:"store_sql"}},12(t,e){e.response={type:"close_sql"}},13(t,e){e.response=t.message(Tf)}},kf={default(){return{type:"execute",result:Be.default()}},1(t,e){e.result=t.message(Be)}},Cf={default(){return{type:"batch",result:Lt.default()}},1(t,e){e.result=t.message(Lt)}},Ef={default(){return{type:"fetch_cursor",entries:[],done:!1}},1(t,e){e.entries.push(t.message(Vn))},2(t,e){e.done=t.bool()}},Rf={default(){return{type:"describe",result:Ut.default()}},1(t,e){e.result=t.message(Ut)}},Tf={default(){return{type:"get_autocommit",isAutocommit:!1}},1(t,e){e.isAutocommit=t.bool()}};var kl=new Map([["hrana2",{version:2,encoding:"json"}],["hrana1",{version:1,encoding:"json"}]]),fo=new Map([["hrana3-protobuf",{version:3,encoding:"protobuf"}],["hrana3",{version:3,encoding:"json"}],["hrana2",{version:2,encoding:"json"}],["hrana1",{version:1,encoding:"json"}]]),kr=class extends tt{#e;#t;#r;#n;#o;#s;#i;#a;#l;_streamIdAlloc;_cursorIdAlloc;#u;constructor(e,r){super(),this.#e=e,this.#t=[],this.#r=!1,this.#n=void 0,this.#o=!1,this.#s=void 0,this.#i=!1,this.#a=new Map,this.#l=new Te,this._streamIdAlloc=new Te,this._cursorIdAlloc=new Te,this.#u=new Te,this.#e.binaryType="arraybuffer",this.#e.addEventListener("open",()=>this.#p()),this.#e.addEventListener("close",n=>this.#f(n)),this.#e.addEventListener("error",n=>this.#m(n)),this.#e.addEventListener("message",n=>this.#g(n)),this.#h({type:"hello",jwt:r})}#h(e){if(this.#n!==void 0)throw new V("Trying to send a message on a closed client");if(this.#r)this.#d(e);else{let r=()=>this.#d(e),n=()=>{};this.#t.push({openCallback:r,errorCallback:n})}}#p(){let e=this.#e.protocol;if(e===void 0){this.#c(new R("The `WebSocket.protocol` property is undefined. This most likely means that the WebSocket implementation provided by the environment is broken. If you are using Miniflare 2, please update to Miniflare 3, which fixes this problem."));return}else if(e==="")this.#s={version:1,encoding:"json"};else if(this.#s=fo.get(e),this.#s===void 0){this.#c(new g(`Unrecognized WebSocket subprotocol: ${JSON.stringify(e)}`));return}for(let r of this.#t)r.openCallback();this.#t.length=0,this.#r=!0}#d(e){let r=this.#s.encoding;if(r==="json"){let n=yr(e,fl);this.#e.send(n)}else if(r==="protobuf"){let n=gr(e,gl);this.#e.send(n)}else throw T(r,"Impossible encoding")}getVersion(){return new Promise((e,r)=>{if(this.#i=!0,this.#n!==void 0)r(this.#n);else if(this.#r)e(this.#s.version);else{let n=()=>e(this.#s.version);this.#t.push({openCallback:n,errorCallback:r})}})}_ensureVersion(e,r){if(this.#s===void 0||!this.#i)throw new ue(`${r} is supported only on protocol version ${e} and higher, but the version supported by the WebSocket server is not yet known. Use Client.getVersion() to wait until the version is available.`);if(this.#s.version<e)throw new ue(`${r} is supported on protocol version ${e} and higher, but the WebSocket server only supports version ${this.#s.version}`)}_sendRequest(e,r){if(this.#n!==void 0){r.errorCallback(new $("Client is closed",this.#n));return}let n=this.#l.alloc();this.#a.set(n,{...r,type:e.type}),this.#h({type:"request",requestId:n,request:e})}#m(e){let n=e.message??"WebSocket was closed due to an error";this.#c(new rt(n))}#f(e){let r=`WebSocket was closed with code ${e.code}`;e.reason&&(r+=`: ${e.reason}`),this.#c(new rt(r))}#c(e){if(this.#n===void 0){this.#n=e;for(let r of this.#t)r.errorCallback(e);this.#t.length=0;for(let[r,n]of this.#a.entries())n.errorCallback(e),this.#l.free(r);this.#a.clear(),this.#e.close()}}#g(e){if(this.#n===void 0)try{let r,n=this.#s.encoding;if(n==="json"){if(typeof e.data!="string"){this.#e.close(3003,"Only text messages are accepted with JSON encoding"),this.#c(new g("Received non-text message from server with JSON encoding"));return}r=nt(JSON.parse(e.data),vl)}else if(n==="protobuf"){if(!(e.data instanceof ArrayBuffer)){this.#e.close(3003,"Only binary messages are accepted with Protobuf encoding"),this.#c(new g("Received non-binary message from server with Protobuf encoding"));return}r=Ne(new Uint8Array(e.data),Sl)}else throw T(n,"Impossible encoding");this.#y(r)}catch(r){this.#e.close(3007,"Could not handle message"),this.#c(r)}}#y(e){if(e.type==="none")throw new g("Received an unrecognized ServerMsg");if(e.type==="hello_ok"||e.type==="hello_error"){if(this.#o)throw new g("Received a duplicated hello response");if(this.#o=!0,e.type==="hello_error")throw Ie(e.error);return}else if(!this.#o)throw new g("Received a non-hello message before a hello response");if(e.type==="response_ok"){let r=e.requestId,n=this.#a.get(r);if(this.#a.delete(r),n===void 0)throw new g("Received unexpected OK response");this.#l.free(r);try{if(n.type!==e.response.type)throw console.dir({responseState:n,msg:e}),new g("Received unexpected type of response");n.responseCallback(e.response)}catch(s){throw n.errorCallback(s),s}}else if(e.type==="response_error"){let r=e.requestId,n=this.#a.get(r);if(this.#a.delete(r),n===void 0)throw new g("Received unexpected error response");this.#l.free(r),n.errorCallback(Ie(e.error))}else throw T(e,"Impossible ServerMsg type")}openStream(){return vr.open(this)}storeSql(e){this._ensureVersion(2,"storeSql()");let r=this.#u.alloc(),n=new De(this,r),s=()=>{},o=a=>n._setClosed(a),i={type:"store_sql",sqlId:r,sql:e};return this._sendRequest(i,{responseCallback:s,errorCallback:o}),n}_closeSql(e){if(this.#n!==void 0)return;let r=()=>this.#u.free(e),n=o=>this.#c(o),s={type:"close_sql",sqlId:e};this._sendRequest(s,{responseCallback:r,errorCallback:n})}close(){this.#c(new R("Client was manually closed"))}get closed(){return this.#n!==void 0}};var po=fetch,Cr=Request,mo=Headers;var at;if(typeof queueMicrotask<"u")at=queueMicrotask;else{let t=Promise.resolve();at=e=>{t.then(e)}}var zn=class{#e;#t;#r;constructor(e){this.#e=new Uint8Array(new ArrayBuffer(e)),this.#t=0,this.#r=0}get length(){return this.#r-this.#t}data(){return this.#e.slice(this.#t,this.#r)}push(e){this.#n(e.byteLength),this.#e.set(e,this.#r),this.#r+=e.byteLength}#n(e){if(this.#r+e<=this.#e.byteLength)return;let r=this.#r-this.#t;if(r+e<=this.#e.byteLength&&2*this.#r>=this.#e.byteLength)this.#e.copyWithin(0,this.#t,this.#r);else{let n=this.#e.byteLength;do n*=2;while(r+e>n);let s=new Uint8Array(new ArrayBuffer(n));s.set(this.#e.slice(this.#t,this.#r),0),this.#e=s}this.#r=r,this.#t=0}shift(e){this.#t+=e}};function Cl(t){let e=ae(t.baton),r=ae(t.base_url),n=pe(t.results,If);return{baton:e,baseUrl:r,results:n}}function If(t){let e=X(t.type);if(e==="ok")return{type:"ok",response:Pf(L(t.response))};if(e==="error")return{type:"error",error:Me(L(t.error))};throw new g("Unexpected type of StreamResult")}function Pf(t){let e=X(t.type);if(e==="close")return{type:"close"};if(e==="execute")return{type:"execute",result:Sr(L(t.result))};if(e==="batch")return{type:"batch",result:Mn(L(t.result))};if(e==="sequence")return{type:"sequence"};if(e==="describe")return{type:"describe",result:Hn(L(t.result))};if(e==="store_sql")return{type:"store_sql"};if(e==="close_sql")return{type:"close_sql"};if(e==="get_autocommit")return{type:"get_autocommit",isAutocommit:Fe(t.is_autocommit)};throw new g("Unexpected type of StreamResponse")}function El(t){let e=ae(t.baton),r=ae(t.base_url);return{baton:e,baseUrl:r}}var Rl={default(){return{baton:void 0,baseUrl:void 0,results:[]}},1(t,e){e.baton=t.string()},2(t,e){e.baseUrl=t.string()},3(t,e){e.results.push(t.message(Af))}},Af={default(){return{type:"none"}},1(t){return{type:"ok",response:t.message(Of)}},2(t){return{type:"error",error:t.message(ce)}}},Of={default(){return{type:"none"}},1(t){return{type:"close"}},2(t){return t.message(qf)},3(t){return t.message($f)},4(t){return{type:"sequence"}},5(t){return t.message(jf)},6(t){return{type:"store_sql"}},7(t){return{type:"close_sql"}},8(t){return t.message(Lf)}},qf={default(){return{type:"execute",result:Be.default()}},1(t,e){e.result=t.message(Be)}},$f={default(){return{type:"batch",result:Lt.default()}},1(t,e){e.result=t.message(Lt)}},jf={default(){return{type:"describe",result:Ut.default()}},1(t,e){e.result=t.message(Ut)}},Lf={default(){return{type:"get_autocommit",isAutocommit:!1}},1(t,e){e.isAutocommit=t.bool()}},Tl={default(){return{baton:void 0,baseUrl:void 0}},1(t,e){e.baton=t.string()},2(t,e){e.baseUrl=t.string()}};var Wn=class extends qt{#e;#t;#r;#n;#o;#s;constructor(e,r){super(),this.#e=e,this.#t=r,this.#r=void 0,this.#n=new zn(16*1024),this.#o=void 0,this.#s=!1}async open(e){if(e.body===null)throw new g("No response body for cursor request");this.#r=e.body.getReader();let r=await this.#i(El,Tl);if(r===void 0)throw new g("Empty response to cursor request");return r}next(){return this.#i(Bn,Vn)}close(){this._setClosed(new R("Cursor was manually closed"))}_setClosed(e){this.#o===void 0&&(this.#o=e,this.#e._cursorClosed(this),this.#r!==void 0&&this.#r.cancel())}get closed(){return this.#o!==void 0}async#i(e,r){for(;;){if(this.#s)return;if(this.#o!==void 0)throw new $("Cursor is closed",this.#o);if(this.#t==="json"){let o=this.#a();if(o!==void 0){let i=new TextDecoder().decode(o),a=JSON.parse(i);return nt(a,e)}}else if(this.#t==="protobuf"){let o=this.#l();if(o!==void 0)return Ne(o,r)}else throw T(this.#t,"Impossible encoding");if(this.#r===void 0)throw new V("Attempted to read from HTTP cursor before it was opened");let{value:n,done:s}=await this.#r.read();if(s&&this.#n.length===0)this.#s=!0;else{if(s)throw new g("Unexpected end of cursor stream");this.#n.push(n)}}}#a(){let e=this.#n.data(),r=10,n=e.indexOf(r);if(n<0)return;let s=e.slice(0,n);return this.#n.shift(n+1),s}#l(){let e=this.#n.data(),r=0,n=0;for(;;){if(n>=e.byteLength)return;let o=e[n];if(r|=(o&127)<<7*n,n+=1,!(o&128))break}if(e.byteLength<n+r)return;let s=e.slice(n,n+r);return this.#n.shift(n+r),s}};function Il(t,e){e.baton!==void 0&&t.string("baton",e.baton),t.arrayObjects("requests",e.requests,Uf)}function Uf(t,e){if(t.stringRaw("type",e.type),e.type!=="close"){if(e.type==="execute")t.object("stmt",e.stmt,br);else if(e.type==="batch")t.object("batch",e.batch,$t);else if(e.type==="sequence")e.sql!==void 0&&t.string("sql",e.sql),e.sqlId!==void 0&&t.number("sql_id",e.sqlId);else if(e.type==="describe")e.sql!==void 0&&t.string("sql",e.sql),e.sqlId!==void 0&&t.number("sql_id",e.sqlId);else if(e.type==="store_sql")t.number("sql_id",e.sqlId),t.string("sql",e.sql);else if(e.type==="close_sql")t.number("sql_id",e.sqlId);else if(e.type!=="get_autocommit")throw T(e,"Impossible type of StreamRequest")}}function Pl(t,e){e.baton!==void 0&&t.string("baton",e.baton),t.object("batch",e.batch,$t)}function Al(t,e){e.baton!==void 0&&t.string(1,e.baton);for(let r of e.requests)t.message(2,r,Ff)}function Ff(t,e){if(e.type==="close")t.message(1,e,Nf);else if(e.type==="execute")t.message(2,e,Df);else if(e.type==="batch")t.message(3,e,Mf);else if(e.type==="sequence")t.message(4,e,Bf);else if(e.type==="describe")t.message(5,e,Hf);else if(e.type==="store_sql")t.message(6,e,Vf);else if(e.type==="close_sql")t.message(7,e,zf);else if(e.type==="get_autocommit")t.message(8,e,Wf);else throw T(e,"Impossible type of StreamRequest")}function Nf(t,e){}function Df(t,e){t.message(1,e.stmt,xr)}function Mf(t,e){t.message(1,e.batch,jt)}function Bf(t,e){e.sql!==void 0&&t.string(1,e.sql),e.sqlId!==void 0&&t.int32(2,e.sqlId)}function Hf(t,e){e.sql!==void 0&&t.string(1,e.sql),e.sqlId!==void 0&&t.int32(2,e.sqlId)}function Vf(t,e){t.int32(1,e.sqlId),t.string(2,e.sql)}function zf(t,e){t.int32(1,e.sqlId)}function Wf(t,e){}function Ol(t,e){e.baton!==void 0&&t.string(1,e.baton),t.message(2,e.batch,jt)}var Er=class extends it{#e;#t;#r;#n;#o;#s;#i;#a;#l;#u;#h;#p;constructor(e,r,n,s){super(e.intMode),this.#e=e,this.#t=r.toString(),this.#r=n,this.#n=s,this.#o=void 0,this.#s=new Pe,this.#i=!1,this.#l=!1,this.#u=!1,this.#h=void 0,this.#p=new Te}client(){return this.#e}_sqlOwner(){return this}storeSql(e){let r=this.#p.alloc();return this.#d({type:"store_sql",sqlId:r,sql:e}).then(()=>{},n=>this._setClosed(n)),new De(this,r)}_closeSql(e){this.#h===void 0&&this.#d({type:"close_sql",sqlId:e}).then(()=>this.#p.free(e),r=>this._setClosed(r))}_execute(e){return this.#d({type:"execute",stmt:e}).then(r=>r.result)}_batch(e){return this.#d({type:"batch",batch:e}).then(r=>r.result)}_describe(e){return this.#d({type:"describe",sql:e.sql,sqlId:e.sqlId}).then(r=>r.result)}_sequence(e){return this.#d({type:"sequence",sql:e.sql,sqlId:e.sqlId}).then(r=>{})}getAutocommit(){return this.#e._ensureVersion(3,"getAutocommit()"),this.#d({type:"get_autocommit"}).then(e=>e.isAutocommit)}#d(e){return new Promise((r,n)=>{this.#m({type:"pipeline",request:e,responseCallback:r,errorCallback:n})})}_openCursor(e){return new Promise((r,n)=>{this.#m({type:"cursor",batch:e,cursorCallback:r,errorCallback:n})})}_cursorClosed(e){if(e!==this.#a)throw new V("Cursor was closed, but it was not associated with the stream");this.#a=void 0,at(()=>this.#f())}close(){this._setClosed(new R("Stream was manually closed"))}closeGracefully(){this.#l=!0,at(()=>this.#f())}get closed(){return this.#h!==void 0||this.#l}_setClosed(e){if(this.#h===void 0){for(this.#h=e,this.#a!==void 0&&this.#a._setClosed(e),this.#e._streamClosed(this);;){let r=this.#s.shift();if(r!==void 0)r.errorCallback(e);else break}(this.#o!==void 0||this.#i)&&!this.#u&&(this.#s.push({type:"pipeline",request:{type:"close"},responseCallback:()=>{},errorCallback:()=>{}}),this.#u=!0,at(()=>this.#f()))}}#m(e){if(this.#h!==void 0)throw new $("Stream is closed",this.#h);if(this.#l)throw new $("Stream is closing",void 0);this.#s.push(e),at(()=>this.#f())}#f(){if(this.#i||this.#a!==void 0)return;if(this.#l&&this.#s.length===0){this._setClosed(new R("Stream was gracefully closed"));return}let e=this.#e._endpoint;if(e===void 0){this.#e._endpointPromise.then(()=>this.#f(),n=>this._setClosed(n));return}let r=this.#s.shift();if(r!==void 0)if(r.type==="pipeline"){let n=[r];for(;;){let s=this.#s.first();if(s!==void 0&&s.type==="pipeline")n.push(s),this.#s.shift();else if(s===void 0&&this.#l&&!this.#u){n.push({type:"pipeline",request:{type:"close"},responseCallback:()=>{},errorCallback:()=>{}}),this.#u=!0;break}else break}this.#c(e,n)}else if(r.type==="cursor")this.#g(e,r);else throw T(r,"Impossible type of QueueEntry")}#c(e,r){this.#y(()=>this.#_(r,e),n=>Gf(n,e.encoding),n=>n.baton,n=>n.baseUrl,n=>Jf(r,n),n=>r.forEach(s=>s.errorCallback(n)))}#g(e,r){let n=new Wn(this,e.encoding);this.#a=n,this.#y(()=>this.#v(r,e),s=>n.open(s),s=>s.baton,s=>s.baseUrl,s=>r.cursorCallback(n),s=>r.errorCallback(s))}#y(e,r,n,s,o,i){let a;try{let l=e(),u=this.#n;a=u(l)}catch(l){a=Promise.reject(l)}this.#i=!0,a.then(l=>l.ok?r(l):Kf(l).then(u=>{throw u})).then(l=>{this.#o=n(l),this.#t=s(l)??this.#t,o(l)}).catch(l=>{this._setClosed(l),i(l)}).finally(()=>{this.#i=!1,this.#f()})}#_(e,r){return this.#w(new URL(r.pipelinePath,this.#t),{baton:this.#o,requests:e.map(n=>n.request)},r.encoding,Il,Al)}#v(e,r){if(r.cursorPath===void 0)throw new ue(`Cursors are supported only on protocol version 3 and higher, but the HTTP server only supports version ${r.version}.`);return this.#w(new URL(r.cursorPath,this.#t),{baton:this.#o,batch:e.batch},r.encoding,Pl,Ol)}#w(e,r,n,s,o){let i,a;if(n==="json")i=yr(r,s),a="application/json";else if(n==="protobuf")i=gr(r,o),a="application/x-protobuf";else throw T(n,"Impossible encoding");let l=new mo;return l.set("content-type",a),this.#r!==void 0&&l.set("authorization",`Bearer ${this.#r}`),new Cr(e.toString(),{method:"POST",headers:l,body:i})}};function Jf(t,e){if(e.results.length!==t.length)throw new g("Server returned unexpected number of pipeline results");for(let r=0;r<t.length;++r){let n=e.results[r],s=t[r];if(n.type==="ok"){if(n.response.type!==s.request.type)throw new g("Received unexpected type of response");s.responseCallback(n.response)}else if(n.type==="error")s.errorCallback(Ie(n.error));else throw n.type==="none"?new g("Received unrecognized type of StreamResult"):T(n,"Received impossible type of StreamResult")}}async function Gf(t,e){if(e==="json"){let r=await t.json();return nt(r,Cl)}else if(e==="protobuf"){let r=await t.arrayBuffer();return Ne(new Uint8Array(r),Rl)}else throw T(e,"Impossible encoding")}async function Kf(t){let e=t.headers.get("content-type")??"text/plain";if(e==="application/json"){let n=await t.json();if("message"in n)return Ie(n)}let r=`Server returned HTTP status ${t.status}`;if(e==="text/plain"){let n=(await t.text()).trim();n!==""&&(r+=`: ${n}`)}return t.status===404&&(r+=". It seems that the libsql server is outdated, please try updating the database."),new It(r,t.status)}var Zf=[{versionPath:"v3-protobuf",pipelinePath:"v3-protobuf/pipeline",cursorPath:"v3-protobuf/cursor",version:3,encoding:"protobuf"}],yo={versionPath:"v2",pipelinePath:"v2/pipeline",cursorPath:void 0,version:2,encoding:"json"},Rr=class extends tt{#e;#t;#r;#n;#o;_endpointPromise;_endpoint;constructor(e,r,n,s=2){super(),this.#e=e,this.#t=r,this.#r=n??po,this.#n=void 0,this.#o=new Set,s==3?(this._endpointPromise=Qf(this.#r,this.#e),this._endpointPromise.then(o=>this._endpoint=o,o=>this.#s(o))):(this._endpointPromise=Promise.resolve(yo),this._endpointPromise.then(o=>this._endpoint=o,o=>this.#s(o)))}async getVersion(){return this._endpoint!==void 0?this._endpoint.version:(await this._endpointPromise).version}_ensureVersion(e,r){if(!(e<=yo.version)){if(this._endpoint===void 0)throw new ue(`${r} is supported only on protocol version ${e} and higher, but the version supported by the HTTP server is not yet known. Use Client.getVersion() to wait until the version is available.`);if(this._endpoint.version<e)throw new ue(`${r} is supported only on protocol version ${e} and higher, but the HTTP server only supports version ${this._endpoint.version}.`)}}openStream(){if(this.#n!==void 0)throw new $("Client is closed",this.#n);let e=new Er(this,this.#e,this.#t,this.#r);return this.#o.add(e),e}_streamClosed(e){this.#o.delete(e)}close(){this.#s(new R("Client was manually closed"))}get closed(){return this.#n!==void 0}#s(e){if(this.#n===void 0){this.#n=e;for(let r of Array.from(this.#o))r._setClosed(new $("Client was closed",e))}}};async function Qf(t,e){let r=t;for(let n of Zf){let s=new URL(n.versionPath,e),o=new Cr(s.toString(),{method:"GET"}),i=await r(o);if(await i.arrayBuffer(),i.ok)return n}return yo}function go(t,e,r=2){if(typeof Ue>"u")throw new Tt("WebSockets are not supported in this environment");var n=void 0;r==3?n=Array.from(fo.keys()):n=Array.from(kl.keys());let s=new Ue(t,n);return new kr(s,e)}function ql(t,e,r,n=2){return new Rr(t instanceof URL?t:new URL(t),e,r,n)}var Ft=class{#e;#t;#r;constructor(e,r){this.#e=e,this.#t=r,this.#r=void 0}execute(e){return this.batch([e]).then(r=>r[0])}async batch(e){let r=this._getStream();if(r.closed)throw new E("Cannot execute statements because the transaction is closed","TRANSACTION_CLOSED");try{let n=e.map(lt),s;if(this.#r===void 0){this._getSqlCache().apply(n);let i=r.batch(this.#t>=3),a=i.step(),l=a.run(Pn(this.#e)),u=a;s=n.map(c=>{let h=i.step().condition(F.ok(u));this.#t>=3&&h.condition(F.not(F.isAutocommit(i)));let d=h.query(c);return d.catch(()=>{}),u=h,d}),this.#r=i.execute().then(()=>l).then(()=>{});try{await this.#r}catch(c){throw this.close(),c}}else{this.#t<3&&await this.#r,this._getSqlCache().apply(n);let i=r.batch(this.#t>=3),a;s=n.map(l=>{let u=i.step();a!==void 0&&u.condition(F.ok(a)),this.#t>=3&&u.condition(F.not(F.isAutocommit(i)));let c=u.query(l);return c.catch(()=>{}),a=u,c}),await i.execute()}let o=[];for(let i of s){let a=await i;if(a===void 0)throw new E("Statement in a transaction was not executed, probably because the transaction has been rolled back","TRANSACTION_CLOSED");o.push(Nt(a))}return o}catch(n){throw U(n)}}async executeMultiple(e){let r=this._getStream();if(r.closed)throw new E("Cannot execute statements because the transaction is closed","TRANSACTION_CLOSED");try{if(this.#r===void 0){this.#r=r.run(Pn(this.#e)).then(()=>{});try{await this.#r}catch(n){throw this.close(),n}}else await this.#r;await r.sequence(e)}catch(n){throw U(n)}}async rollback(){try{let e=this._getStream();if(e.closed||this.#r===void 0)return;let r=e.run("ROLLBACK").catch(n=>{throw U(n)});e.closeGracefully(),await r}catch(e){throw U(e)}finally{this.close()}}async commit(){try{let e=this._getStream();if(e.closed)throw new E("Cannot commit the transaction because it is already closed","TRANSACTION_CLOSED");if(this.#r!==void 0)await this.#r;else return;let r=e.run("COMMIT").catch(n=>{throw U(n)});e.closeGracefully(),await r}catch(e){throw U(e)}finally{this.close()}}};async function Jn(t,e,r,n){let s=r.step(),o=s.run(Pn(t)),i=s,a=n.map(d=>{let f=r.step().condition(F.ok(i));e>=3&&f.condition(F.not(F.isAutocommit(r)));let y=f.query(d);return i=f,y}),l=r.step().condition(F.ok(i));e>=3&&l.condition(F.not(F.isAutocommit(r)));let u=l.run("COMMIT");r.step().condition(F.not(F.ok(l))).run("ROLLBACK").catch(d=>{}),await r.execute();let h=[];await o;for(let d of a){let f=await d;if(f===void 0)throw new E("Statement in a batch was not executed, probably because the transaction has been rolled back","TRANSACTION_CLOSED");h.push(Nt(f))}return await u,h}function lt(t){if(typeof t=="string")return new ot(t);let e=new ot(t.sql);if(Array.isArray(t.args))e.bindIndexes(t.args);else for(let[r,n]of Object.entries(t.args))e.bindName(r,n);return e}function Nt(t){let e=t.columnNames.map(i=>i??""),r=t.columnDecltypes.map(i=>i??""),n=t.rows,s=t.affectedRowCount,o=t.lastInsertRowid!==void 0?t.lastInsertRowid:void 0;return new In(e,r,n,s,o)}function U(t){if(t instanceof R){let e=$l(t);return new E(t.message,e,void 0,t)}return t}function $l(t){return t instanceof Rt&&t.code!==void 0?t.code:t instanceof g?"HRANA_PROTO_ERROR":t instanceof $?t.cause instanceof R?$l(t.cause):"HRANA_CLOSED_ERROR":t instanceof rt?"HRANA_WEBSOCKET_ERROR":t instanceof It?"SERVER_ERROR":t instanceof ue?"PROTOCOL_VERSION_ERROR":t instanceof V?"INTERNAL_ERROR":"UNKNOWN"}var ut=class{#e;#t;capacity;constructor(e,r){this.#e=e,this.#t=new _o,this.capacity=r}apply(e){if(this.capacity<=0)return;let r=new Set;for(let n of e){if(typeof n.sql!="string")continue;let s=n.sql,o=this.#t.get(s);if(o===void 0){for(;this.#t.size+1>this.capacity;){let[i,a]=this.#t.peekLru();if(r.has(a))break;a.close(),this.#t.delete(i)}this.#t.size+1<=this.capacity&&(o=this.#e.storeSql(s),this.#t.set(s,o))}o!==void 0&&(n.sql=o,r.add(o))}}},_o=class{#e;constructor(){this.#e=new Map}get(e){let r=this.#e.get(e);return r!==void 0&&(this.#e.delete(e),this.#e.set(e,r)),r}set(e,r){this.#e.set(e,r)}peekLru(){for(let e of this.#e.entries())return e}delete(e){this.#e.delete(e)}get size(){return this.#e.size}};function jl(t){if(t.scheme!=="wss"&&t.scheme!=="ws")throw new E(`The WebSocket client supports only "libsql:", "wss:" and "ws:" URLs, got ${JSON.stringify(t.scheme+":")}. For more information, please read ${Ee}`,"URL_SCHEME_NOT_SUPPORTED");if(t.scheme==="ws"&&t.tls)throw new E('A "ws:" URL cannot opt into TLS by using ?tls=1',"URL_INVALID");if(t.scheme==="wss"&&!t.tls)throw new E('A "wss:" URL cannot opt out of TLS by using ?tls=0',"URL_INVALID");let e=fr(t.scheme,t.authority,t.path),r;try{r=go(e,t.authToken)}catch(n){if(n instanceof Tt){let s=t.scheme==="wss"?"https":"http",o=fr(s,t.authority,t.path);throw new E(`This environment does not support WebSockets, please switch to the HTTP client by using a "${s}:" URL (${JSON.stringify(o)}). For more information, please read ${Ee}`,"WEBSOCKETS_NOT_SUPPORTED")}throw U(n)}return new vo(r,e,t.authToken,t.intMode)}var Xf=60*1e3,Yf=100,vo=class{#e;#t;#r;#n;#o;closed;protocol;constructor(e,r,n,s){this.#e=r,this.#t=n,this.#r=s,this.#n=this.#i(e),this.#o=void 0,this.closed=!1,this.protocol="ws"}async execute(e){let r=await this.#s();try{let n=lt(e);r.conn.sqlCache.apply([n]);let s=r.stream.query(n);return r.stream.closeGracefully(),Nt(await s)}catch(n){throw U(n)}finally{this._closeStream(r)}}async batch(e,r="deferred"){let n=await this.#s();try{let s=e.map(lt),o=await n.conn.client.getVersion();n.conn.sqlCache.apply(s);let i=n.stream.batch(o>=3);return await Jn(r,o,i,s)}catch(s){throw U(s)}finally{this._closeStream(n)}}async transaction(e="write"){let r=await this.#s();try{let n=await r.conn.client.getVersion();return new bo(this,r,e,n)}catch(n){throw this._closeStream(r),U(n)}}async executeMultiple(e){let r=await this.#s();try{let n=r.stream.sequence(e);r.stream.closeGracefully(),await n}catch(n){throw U(n)}finally{this._closeStream(r)}}sync(){return Promise.resolve()}async#s(){if(this.closed)throw new E("The client is closed","CLIENT_CLOSED");if(new Date().valueOf()-this.#n.openTime.valueOf()>Xf&&this.#o===void 0){let s=this.#i();this.#o=s,s.client.getVersion().then(o=>{this.#n!==s&&this.#n.streamStates.size===0&&this.#n.client.close(),this.#n=s,this.#o=void 0},o=>{this.#o=void 0})}if(this.#n.client.closed)try{this.#o!==void 0?this.#n=this.#o:this.#n=this.#i()}catch(s){throw U(s)}let n=this.#n;try{n.useSqlCache===void 0&&(n.useSqlCache=await n.client.getVersion()>=2,n.useSqlCache&&(n.sqlCache.capacity=Yf));let s=n.client.openStream();s.intMode=this.#r;let o={conn:n,stream:s};return n.streamStates.add(o),o}catch(s){throw U(s)}}#i(e){try{return e??=go(this.#e,this.#t),{client:e,useSqlCache:void 0,sqlCache:new ut(e,0),openTime:new Date,streamStates:new Set}}catch(r){throw U(r)}}_closeStream(e){e.stream.close();let r=e.conn;r.streamStates.delete(e),r.streamStates.size===0&&r!==this.#n&&r.client.close()}close(){this.#n.client.close(),this.closed=!0}},bo=class extends Ft{#e;#t;constructor(e,r,n,s){super(n,s),this.#e=e,this.#t=r}_getStream(){return this.#t.stream}_getSqlCache(){return this.#t.conn.sqlCache}close(){this.#e._closeStream(this.#t)}get closed(){return this.#t.stream.closed}};function Ll(t){if(t.scheme!=="https"&&t.scheme!=="http")throw new E(`The HTTP client supports only "libsql:", "https:" and "http:" URLs, got ${JSON.stringify(t.scheme+":")}. For more information, please read ${Ee}`,"URL_SCHEME_NOT_SUPPORTED");if(t.scheme==="http"&&t.tls)throw new E('A "http:" URL cannot opt into TLS by using ?tls=1',"URL_INVALID");if(t.scheme==="https"&&!t.tls)throw new E('A "https:" URL cannot opt out of TLS by using ?tls=0',"URL_INVALID");let e=fr(t.scheme,t.authority,t.path);return new xo(e,t.authToken,t.intMode,t.fetch)}var Ul=30,xo=class{#e;protocol;constructor(e,r,n,s){this.#e=ql(e,r,s),this.#e.intMode=n,this.protocol="http"}async execute(e){try{let r=lt(e),n,s=this.#e.openStream();try{n=s.query(r)}finally{s.closeGracefully()}return Nt(await n)}catch(r){throw U(r)}}async batch(e,r="deferred"){try{let n=e.map(lt),s=await this.#e.getVersion(),o,i=this.#e.openStream();try{new ut(i,Ul).apply(n);let l=i.batch(!1);o=Jn(r,s,l,n)}finally{i.closeGracefully()}return await o}catch(n){throw U(n)}}async transaction(e="write"){try{let r=await this.#e.getVersion();return new So(this.#e.openStream(),e,r)}catch(r){throw U(r)}}async executeMultiple(e){try{let r,n=this.#e.openStream();try{r=n.sequence(e)}finally{n.closeGracefully()}await r}catch(r){throw U(r)}}sync(){return Promise.resolve()}close(){this.#e.close()}get closed(){return this.#e.closed}},So=class extends Ft{#e;#t;constructor(e,r,n){super(r,n),this.#e=e,this.#t=new ut(e,Ul)}_getStream(){return this.#e}_getSqlCache(){return this.#t}close(){this.#e.close()}get closed(){return this.#e.closed}};function Fl(t){return ep(An(t,!0))}function ep(t){if(t.scheme==="ws"||t.scheme==="wss")return jl(t);if(t.scheme==="http"||t.scheme==="https")return Ll(t);throw new E(`The client that uses Web standard APIs supports only "libsql:", "wss:", "ws:", "https:" and "http:" URLs, got ${JSON.stringify(t.scheme+":")}. For more information, please read ${Ee}`,"URL_SCHEME_NOT_SUPPORTED")}var tp=class{_db;constructor({host:t,token:e}){let r=`libsql://${t}.turso.io`;this._db=Fl({url:r,authToken:e})}get db(){return this._db}};function Nl(t){let e=new tp(t);return new Proxy(e,{get(r,n){if(Reflect.has(r,n))return Reflect.get(r,n);if(Reflect.has(r.db,n)){let s=Reflect.get(r.db,n);return typeof s=="function"?s.bind(r.db):s}}})}var Ml=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Promise.resolve().then(()=>ye(He())).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};var Tr=class extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}},Gn=class extends Tr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}},Kn=class extends Tr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}},Zn=class extends Tr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}};var np=function(t,e,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function a(c){try{u(n.next(c))}catch(h){i(h)}}function l(c){try{u(n.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})},Ir=class{constructor(e,{headers:r={},customFetch:n}={}){this.url=e,this.headers=r,this.fetch=Ml(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return np(this,void 0,void 0,function*(){try{let{headers:s,method:o,body:i}=r,a={},l;i&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",l=i):typeof i=="string"?(a["Content-Type"]="text/plain",l=i):typeof FormData<"u"&&i instanceof FormData?l=i:(a["Content-Type"]="application/json",l=JSON.stringify(i)));let u=yield this.fetch(`${this.url}/${e}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:l}).catch(f=>{throw new Gn(f)}),c=u.headers.get("x-relay-error");if(c&&c==="true")throw new Kn(u);if(!u.ok)throw new Zn(u);let h=((n=u.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),d;return h==="application/json"?d=yield u.json():h==="application/octet-stream"?d=yield u.blob():h==="multipart/form-data"?d=yield u.formData():d=yield u.text(),{data:d,error:null}}catch(s){return{data:null,error:s}}})}};var Bl=ye(He()),Mt=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Bl.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let n=this.fetch,s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var i,a,l;let u=null,c=null,h=null,d=o.status,f=o.statusText;if(o.ok){if(this.method!=="HEAD"){let q=await o.text();q===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=q:c=JSON.parse(q))}let w=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),x=(a=o.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");w&&x&&x.length>1&&(h=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{let w=await o.text();try{u=JSON.parse(w),Array.isArray(u)&&o.status===404&&(c=[],u=null,d=200,f="OK")}catch{o.status===404&&w===""?(d=204,f="No Content"):u={message:w}}if(u&&this.isMaybeSingle&&(!((l=u?.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,d=200,f="OK"),u&&this.shouldThrowOnError)throw u}return{error:u,data:c,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(s=s.catch(o=>{var i,a,l;return{error:{message:`${(i=o?.name)!==null&&i!==void 0?i:"FetchError"}: ${o?.message}`,details:`${(a=o?.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=o?.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,r)}};var Bt=class extends Mt{select(e){let r=!1,n=(e??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:r=!0,nullsFirst:n,foreignTable:s}={}){let o=s?`${s}.order`:"order",i=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${i?`${i},`:""}${e}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r}={}){let n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,r,{foreignTable:n}={}){let s=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:o=!1,format:i="text"}={}){let a=[e?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,o?"wal":null].filter(Boolean).join("|"),l=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`,i==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};var he=class extends Bt{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){let n=r.map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:n,type:s}={}){let o="";s==="plain"?o="pl":s==="phrase"?o="ph":s==="websearch"&&(o="w");let i=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${o}fts${i}.${r}`),this}match(e){return Object.entries(e).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(e,r,n){return this.url.searchParams.append(e,`not.${r}.${n}`),this}or(e,{foreignTable:r}={}){let n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,r,n){return this.url.searchParams.append(e,`${r}.${n}`),this}};var Ht=class{constructor(e,{headers:r={},schema:n,fetch:s}){this.url=e,this.headers=r,this.schema=n,this.fetch=s}select(e,{head:r=!1,count:n}={}){let s=r?"HEAD":"GET",o=!1,i=(e??"*").split("").map(a=>/\s/.test(a)&&!o?"":(a==='"'&&(o=!o),a)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new he({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:r,defaultToNull:n=!0}={}){let s="POST",o=[];if(this.headers.Prefer&&o.push(this.headers.Prefer),r&&o.push(`count=${r}`),n||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){let i=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(i.length>0){let a=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new he({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:o=!0}={}){let i="POST",a=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),o||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){let l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){let u=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new he({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:r}={}){let n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new he({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let r="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new he({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var Hl="1.8.5";var Vl={"X-Client-Info":`postgrest-js/${Hl}`};var Vt=class t{constructor(e,{headers:r={},schema:n,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},Vl),r),this.schemaName=n,this.fetch=s}from(e){let r=new URL(`${this.url}/${e}`);return new Ht(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new t(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,count:s}={}){let o,i=new URL(`${this.url}/rpc/${e}`),a;n?(o="HEAD",Object.entries(r).forEach(([u,c])=>{i.searchParams.append(u,`${c}`)})):(o="POST",a=r);let l=Object.assign({},this.headers);return s&&(l.Prefer=`count=${s}`),new he({method:o,url:i,headers:l,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}};var ou=ye(Yl());var eu="2.8.4";var tu={"X-Client-Info":`realtime-js/${eu}`},ru="1.0.0",Xn=1e4,nu=1e3,zt;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(zt||(zt={}));var Y;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Y||(Y={}));var le;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(le||(le={}));var Qn;(function(t){t.websocket="websocket"})(Qn||(Qn={}));var Ve;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ve||(Ve={}));var dt=class{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var Ar=class{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){let r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){let s=r.getUint8(1),o=r.getUint8(2),i=this.HEADER_LENGTH+2,a=n.decode(e.slice(i,i+s));i=i+s;let l=n.decode(e.slice(i,i+o));i=i+o;let u=JSON.parse(n.decode(e.slice(i,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}};var ft=class{constructor(e,r,n={},s=Xn){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}};var ko;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ko||(ko={}));var Wt=class t{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{let{onJoin:o,onLeave:i,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=t.syncState(this.state,s,o,i),this.pendingDiffs.forEach(l=>{this.state=t.syncDiff(this.state,l,o,i)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{let{onJoin:o,onLeave:i,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=t.syncDiff(this.state,s,o,i),a())}),this.onJoin((s,o,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:i})}),this.onLeave((s,o,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){let o=this.cloneDeep(e),i=this.transformState(r),a={},l={};return this.map(o,(u,c)=>{i[u]||(l[u]=c)}),this.map(i,(u,c)=>{let h=o[u];if(h){let d=c.map(x=>x.presence_ref),f=h.map(x=>x.presence_ref),y=c.filter(x=>f.indexOf(x.presence_ref)<0),w=h.filter(x=>d.indexOf(x.presence_ref)<0);y.length>0&&(a[u]=y),w.length>0&&(l[u]=w)}else a[u]=c}),this.syncDiff(o,{joins:a,leaves:l},n,s)}static syncDiff(e,r,n,s){let{joins:o,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(o,(a,l)=>{var u;let c=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),c.length>0){let h=e[a].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}n(a,c,l)}),this.map(i,(a,l)=>{let u=e[a];if(!u)return;let c=l.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{let s=e[n];return"metas"in s?r[n]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var A;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(A||(A={}));var Eo=(t,e,r={})=>{var n;let s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((o,i)=>(o[i]=ip(i,t,e,s),o),{})},ip=(t,e,r,n)=>{let s=e.find(a=>a.name===t),o=s?.type,i=r[t];return o&&!n.includes(o)?su(o,i):Co(i)},su=(t,e)=>{if(t.charAt(0)==="_"){let r=t.slice(1,t.length);return cp(e,r)}switch(t){case A.bool:return ap(e);case A.float4:case A.float8:case A.int2:case A.int4:case A.int8:case A.numeric:case A.oid:return lp(e);case A.json:case A.jsonb:return up(e);case A.timestamp:return hp(e);case A.abstime:case A.date:case A.daterange:case A.int4range:case A.int8range:case A.money:case A.reltime:case A.text:case A.time:case A.timestamptz:case A.timetz:case A.tsrange:case A.tstzrange:return Co(e);default:return Co(e)}},Co=t=>t,ap=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},lp=t=>{if(typeof t=="string"){let e=parseFloat(t);if(!Number.isNaN(e))return e}return t},up=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},cp=(t,e)=>{if(typeof t!="string")return t;let r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let o,i=t.slice(1,r);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(a=>su(e,a))}return t},hp=t=>typeof t=="string"?t.replace(" ","T"):t;var Ro;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ro||(Ro={}));var To;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes"})(To||(To={}));var Io;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Io||(Io={}));var Jt=class t{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Y.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},r.config),this.timeout=this.socket.timeout,this.joinPush=new ft(this,le.join,this.params,this.timeout),this.rejoinTimer=new dt(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Y.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Y.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Y.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Y.errored,this.rejoinTimer.scheduleTimeout())}),this._on(le.reply,{},(s,o)=>{this._trigger(this._replyEventName(o),s)}),this.presence=new Wt(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:o,presence:i}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));let a={},l={broadcast:o,presence:i,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&s!==void 0?s:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:l},a)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",({postgres_changes:u})=>{var c;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{let h=this.bindings.postgres_changes,d=(c=h?.length)!==null&&c!==void 0?c:0,f=[];for(let y=0;y<d;y++){let w=h[y],{filter:{event:x,schema:q,table:K,filter:ee}}=w,j=u&&u[y];if(j&&j.event===x&&j.schema===q&&j.table===K&&j.filter===ee)f.push(Object.assign(Object.assign({},w),{id:j.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this._on(e,r,n)}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){let{event:o,payload:i}=e,a={method:"POST",headers:{apikey:(n=this.socket.accessToken)!==null&&n!==void 0?n:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=r.timeout)!==null&&s!==void 0?s:this.timeout)).ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,a,l;let u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(i=this.params)===null||i===void 0?void 0:i.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&o("ok"),u.receive("ok",()=>o("ok")),u.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Y.leaving;let r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(le.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{let s=new ft(this,le.leave,{},e);s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,r,n){let s=new AbortController,o=setTimeout(()=>s.abort(),n),i=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(o),i}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new ft(this,e,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,o;let i=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:c}=le;if(n&&[a,l,u,c].indexOf(i)>=0&&n!==this._joinRef())return;let d=this._onMessage(i,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var y,w,x;return((y=f.filter)===null||y===void 0?void 0:y.event)==="*"||((x=(w=f.filter)===null||w===void 0?void 0:w.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===i}).map(f=>f.callback(d,n)):(o=this.bindings[i])===null||o===void 0||o.filter(f=>{var y,w,x,q,K,ee;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in f){let j=f.id,zr=(y=f.filter)===null||y===void 0?void 0:y.event;return j&&((w=r.ids)===null||w===void 0?void 0:w.includes(j))&&(zr==="*"||zr?.toLocaleLowerCase()===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{let j=(K=(q=f?.filter)===null||q===void 0?void 0:q.event)===null||K===void 0?void 0:K.toLocaleLowerCase();return j==="*"||j===((ee=r?.event)===null||ee===void 0?void 0:ee.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===i}).map(f=>{if(typeof d=="object"&&"ids"in d){let y=d.data,{schema:w,table:x,commit_timestamp:q,type:K,errors:ee}=y;d=Object.assign(Object.assign({},{schema:w,table:x,commit_timestamp:q,eventType:K,new:{},old:{},errors:ee}),this._getPayloadRecords(y))}f.callback(d,n)})}_isClosed(){return this.state===Y.closed}_isJoined(){return this.state===Y.joined}_isJoining(){return this.state===Y.joining}_isLeaving(){return this.state===Y.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){let s=e.toLocaleLowerCase(),o={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(e,r){let n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&t.isEqual(s.filter,r))}),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(let n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(le.close,{},e)}_onError(e){this._on(le.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Y.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Eo(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Eo(e.columns,e.old_record)),r}};var fp=()=>{},Gt=class{constructor(e,r){var n;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=tu,this.params={},this.timeout=Xn,this.transport=ou.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=fp,this.conn=null,this.sendBuffer=[],this.serializer=new Ar,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=o=>{let i;return o?i=o:typeof fetch>"u"?i=(...a)=>Promise.resolve().then(()=>ye(He())).then(({default:l})=>l(...a)):i=fetch,(...a)=>i(...a)},this.endPoint=`${e}/${Qn.websocket}`,r?.params&&(this.params=r.params),r?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r?.timeout&&(this.timeout=r.timeout),r?.logger&&(this.logger=r.logger),r?.transport&&(this.transport=r.transport),r?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);let s=(n=r?.params)===null||n===void 0?void 0:n.apikey;s&&(this.accessToken=s),this.reconnectAfterMs=r?.reconnectAfterMs?r.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=r?.encode?r.encode:(o,i)=>i(JSON.stringify(o)),this.decode=r?.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new dt(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r?.fetch)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,r){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){let r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){let e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case zt.connecting:return Ve.Connecting;case zt.open:return Ve.Open;case zt.closing:return Ve.Closing;default:return Ve.Closed}}isConnected(){return this.connectionState()===Ve.Open}channel(e,r={config:{}}){let n=new Jt(`realtime:${e}`,r,this);return this.channels.push(n),n}push(e){let{topic:r,event:n,payload:s,ref:o}=e,i=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${n} (${o})`,s),this.isConnected()?i():this.sendBuffer.push(i)}setAuth(e){this.accessToken=e,this.channels.forEach(r=>{e&&r.updateJoinPayload({access_token:e}),r.joinedOnce&&r._isJoined()&&r._push(le.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r._joinRef()!==e._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ru}))}_onConnMessage(e){this.decode(e.data,r=>{let{topic:n,event:s,payload:o,ref:i}=r;(i&&i===this.pendingHeartbeatRef||s===o?.type)&&(this.pendingHeartbeatRef=null),this.log("receive",`${o.status||""} ${n} ${s} ${i&&"("+i+")"||""}`,o),this.channels.filter(a=>a._isMember(n)).forEach(a=>a._trigger(s,o,i)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(le.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;let n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(nu,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}};var Kt=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function N(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var Yn=class extends Kt{constructor(e,r){super(e),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}},Or=class extends Kt{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}};var pp=function(t,e,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function a(c){try{u(n.next(c))}catch(h){i(h)}}function l(c){try{u(n.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})},es=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Promise.resolve().then(()=>ye(He())).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},iu=()=>pp(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Promise.resolve().then(()=>ye(He()))).Response:Response});var Zt=function(t,e,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function a(c){try{u(n.next(c))}catch(h){i(h)}}function l(c){try{u(n.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})},Po=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),mp=(t,e)=>Zt(void 0,void 0,void 0,function*(){let r=yield iu();t instanceof r?t.json().then(n=>{e(new Yn(Po(n),t.status||500))}).catch(n=>{e(new Or(Po(n),n))}):e(new Or(Po(t),t))}),yp=(t,e,r,n)=>{let s={method:t,headers:e?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};function ts(t,e,r,n,s,o){return Zt(this,void 0,void 0,function*(){return new Promise((i,a)=>{t(r,yp(e,n,s,o)).then(l=>{if(!l.ok)throw l;return n?.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>mp(l,a))})})}function qr(t,e,r,n){return Zt(this,void 0,void 0,function*(){return ts(t,"GET",e,r,n)})}function ve(t,e,r,n,s){return Zt(this,void 0,void 0,function*(){return ts(t,"POST",e,n,s,r)})}function au(t,e,r,n,s){return Zt(this,void 0,void 0,function*(){return ts(t,"PUT",e,n,s,r)})}function rs(t,e,r,n,s){return Zt(this,void 0,void 0,function*(){return ts(t,"DELETE",e,n,s,r)})}var de=function(t,e,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function a(c){try{u(n.next(c))}catch(h){i(h)}}function l(c){try{u(n.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})},gp={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},lu={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},$r=class{constructor(e,r={},n,s){this.url=e,this.headers=r,this.bucketId=n,this.fetch=es(s)}uploadOrUpdate(e,r,n,s){return de(this,void 0,void 0,function*(){try{let o,i=Object.assign(Object.assign({},lu),s),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",i.cacheControl)):(o=n,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType);let l=this._removeEmptyFolders(r),u=this._getFinalPath(l),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:o,headers:a},i?.duplex?{duplex:i.duplex}:{}));return c.ok?{data:{path:l},error:null}:{data:null,error:yield c.json()}}catch(o){if(N(o))return{data:null,error:o};throw o}})}upload(e,r,n){return de(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,s){return de(this,void 0,void 0,function*(){let o=this._removeEmptyFolders(e),i=this._getFinalPath(o),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",r);try{let l,u=Object.assign({upsert:lu.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);let h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:c});return h.ok?{data:{path:o},error:null}:{data:null,error:yield h.json()}}catch(l){if(N(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e){return de(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),n=yield ve(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:this.headers}),s=new URL(this.url+n.url),o=s.searchParams.get("token");if(!o)throw new Kt("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:o},error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}update(e,r,n){return de(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r){return de(this,void 0,void 0,function*(){try{return{data:yield ve(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r},{headers:this.headers}),error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}copy(e,r){return de(this,void 0,void 0,function*(){try{return{data:{path:(yield ve(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r},{headers:this.headers})).Key},error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,n){return de(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),o=yield ve(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers}),i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return de(this,void 0,void 0,function*(){try{let s=yield ve(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${o}`):null})),error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}download(e,r){return de(this,void 0,void 0,function*(){let s=typeof r?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(r?.transform||{}),i=o?`?${o}`:"";try{let a=this._getFinalPath(e);return{data:yield(yield qr(this.fetch,`${this.url}/${s}/${a}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(N(a))return{data:null,error:a};throw a}})}getPublicUrl(e,r){let n=this._getFinalPath(e),s=[],o=r?.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&s.push(o);let a=typeof r?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(r?.transform||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${u}`)}}}remove(e){return de(this,void 0,void 0,function*(){try{return{data:yield rs(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}list(e,r,n){return de(this,void 0,void 0,function*(){try{let s=Object.assign(Object.assign(Object.assign({},gp),r),{prefix:e||""});return{data:yield ve(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}};var uu="2.5.4";var cu={"X-Client-Info":`storage-js/${uu}`};var Qt=function(t,e,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function a(c){try{u(n.next(c))}catch(h){i(h)}}function l(c){try{u(n.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})},jr=class{constructor(e,r={},n){this.url=e,this.headers=Object.assign(Object.assign({},cu),r),this.fetch=es(n)}listBuckets(){return Qt(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}getBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield qr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Qt(this,void 0,void 0,function*(){try{return{data:yield ve(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return Qt(this,void 0,void 0,function*(){try{return{data:yield au(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield ve(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qt(this,void 0,void 0,function*(){try{return{data:yield rs(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}})}};var Lr=class extends jr{constructor(e,r={},n){super(e,r,n)}from(e){return new $r(this.url,this.headers,e,this.fetch)}};var hu="2.38.4";var Ur="";typeof Deno<"u"?Ur="deno":typeof document<"u"?Ur="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ur="react-native":Ur="node";var du={"X-Client-Info":`supabase-js-${Ur}/${hu}`};var ns=ye(He()),wp=function(t,e,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function a(c){try{u(n.next(c))}catch(h){i(h)}}function l(c){try{u(n.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})},_p=t=>{let e;return t?e=t:typeof fetch>"u"?e=ns.default:e=fetch,(...r)=>e(...r)},vp=()=>typeof Headers>"u"?ns.Headers:Headers,fu=(t,e,r)=>{let n=_p(r),s=vp();return(o,i)=>wp(void 0,void 0,void 0,function*(){var a;let l=(a=yield e())!==null&&a!==void 0?a:t,u=new s(i?.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(o,Object.assign(Object.assign({},i),{headers:u}))})};function pu(t){return t.replace(/\/$/,"")}function mu(t,e){let{db:r,auth:n,realtime:s,global:o}=t,{db:i,auth:a,realtime:l,global:u}=e;return{db:Object.assign(Object.assign({},i),r),auth:Object.assign(Object.assign({},a),n),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},u),o)}}function yu(t){return Math.round(Date.now()/1e3)+t}function gu(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}var be=()=>typeof document<"u",pt={tested:!1,writable:!1},ze=()=>{if(!be())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(pt.tested)return pt.writable;let t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),pt.tested=!0,pt.writable=!0}catch{pt.tested=!0,pt.writable=!1}return pt.writable};function ss(t){let e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,o)=>{e[o]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}var os=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Promise.resolve().then(()=>ye(He())).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},wu=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",We=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Nr=async(t,e)=>{let r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},is=async(t,e)=>{await t.removeItem(e)};function bp(t){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="",n,s,o,i,a,l,u,c=0;for(t=t.replace("-","+").replace("_","/");c<t.length;)i=e.indexOf(t.charAt(c++)),a=e.indexOf(t.charAt(c++)),l=e.indexOf(t.charAt(c++)),u=e.indexOf(t.charAt(c++)),n=i<<2|a>>4,s=(a&15)<<4|l>>2,o=(l&3)<<6|u,r=r+String.fromCharCode(n),l!=64&&s!=0&&(r=r+String.fromCharCode(s)),u!=64&&o!=0&&(r=r+String.fromCharCode(o));return r}var Fr=class t{constructor(){this.promise=new t.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}};Fr.promiseConstructor=Promise;function Ao(t){let e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,r=t.split(".");if(r.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(r[1]))throw new Error("JWT is not valid: payload is not in base64url format");let n=r[1];return JSON.parse(bp(n))}async function _u(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function vu(t,e){return new Promise((n,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{let i=await t(o);if(!e(o,null,i)){n(i);return}}catch(i){if(!e(o,i)){s(i);return}}})()})}function xp(t){return("0"+t.toString(16)).substr(-2)}function mt(){let e=new Uint32Array(56);if(typeof crypto>"u"){let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length,s="";for(let o=0;o<56;o++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,xp).join("")}async function Sp(t){let r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}function kp(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yt(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;let r=await Sp(t);return kp(r)}var Dr=class extends Error{constructor(e,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r}};function k(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}var as=class extends Dr{constructor(e,r){super(e,r),this.name="AuthApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}};function bu(t){return k(t)&&t.name==="AuthApiError"}var Xt=class extends Dr{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}},Je=class extends Dr{constructor(e,r,n){super(e),this.name=r,this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}},Ae=class extends Je{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}},Yt=class extends Je{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}},gt=class extends Je{constructor(e){super(e,"AuthInvalidCredentialsError",400)}},wt=class extends Je{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},Mr=class extends Je{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},er=class extends Je{constructor(e,r){super(e,"AuthRetryableFetchError",r)}};function Oo(t){return k(t)&&t.name==="AuthRetryableFetchError"}var Cp=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r},Br=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Ep=[502,503,504];async function xu(t){if(!wu(t))throw new er(Br(t),0);if(Ep.includes(t.status))throw new er(Br(t),t.status);let e;try{e=await t.json()}catch(r){throw new Xt(Br(r),r)}throw new as(Br(e),t.status||500)}var Rp=(t,e,r,n)=>{let s={method:t,headers:e?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function C(t,e,r,n){var s;let o=Object.assign({},n?.headers);n?.jwt&&(o.Authorization=`Bearer ${n.jwt}`);let i=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(i.redirect_to=n.redirectTo);let a=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await Tp(t,e,r+a,{headers:o,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function Tp(t,e,r,n,s,o){let i=Rp(e,n,s,o),a;try{a=await t(r,i)}catch(l){throw console.error(l),new er(Br(l),0)}if(a.ok||await xu(a),n?.noResolveJson)return a;try{return await a.json()}catch(l){await xu(l)}}function Oe(t){var e;let r=null;Ip(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=yu(t.expires_in)));let n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function xe(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Su(t){return{data:t,error:null}}function ku(t){let{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:o}=t,i=Cp(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:o},l=Object.assign({},i);return{data:{properties:a,user:l},error:null}}function Cu(t){return t}function Ip(t){return t.access_token&&t.refresh_token&&t.expires_in}var Pp=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r},tr=class{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=os(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r="global"){try{return await C(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(k(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await C(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:xe})}catch(n){if(k(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{let{options:r}=e,n=Pp(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await C(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:ku,redirectTo:r?.redirectTo})}catch(r){if(k(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await C(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:xe})}catch(r){if(k(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,o,i,a,l;try{let u={nextPage:null,lastPage:0,total:0},c=await C(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:Cu});if(c.error)throw c.error;let h=await c.json(),d=(i=c.headers.get("x-total-count"))!==null&&i!==void 0?i:0,f=(l=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(y=>{let w=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(y.split(";")[1].split("=")[1]);u[`${x}Page`]=w}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(k(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await C(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:xe})}catch(r){if(k(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){try{return await C(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:xe})}catch(n){if(k(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){try{return await C(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:xe})}catch(n){if(k(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{let{data:r,error:n}=await C(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(k(r))return{data:null,error:r};throw r}}async _deleteFactor(e){try{return{data:await C(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(k(r))return{data:null,error:r};throw r}}};var ls="2.57.0";var Eu="http://localhost:9999",Ru="supabase.auth.token";var Tu={"X-Client-Info":`gotrue-js/${ls}`},qo=10;var Iu={getItem:t=>ze()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{ze()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{ze()&&globalThis.localStorage.removeItem(t)}};function $o(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function Pu(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var Ap={debug:!!(globalThis&&ze()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},us=class extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}};Pu();var Op={url:Eu,storageKey:Ru,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Tu,flowType:"implicit",debug:!1},Hr=30*1e3,Au=3;async function qp(t,e,r){return await r()}var _t=class t{constructor(e){var r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=t.nextInstanceID,t.nextInstanceID+=1,this.instanceID>0&&be()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let n=Object.assign(Object.assign({},Op),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new tr({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=os(n.fetch),this.lock=n.lock||qp,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:ze()?this.storage=Iu:(this.memoryStorage={},this.storage=$o(this.memoryStorage)):(this.memoryStorage={},this.storage=$o(this.memoryStorage)),be()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ls}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{let e=be()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){let{data:r,error:n}=await this._getSessionFromURL(e);if(n)return this._debug("#_initialize()","error detecting session from URL",n),await this._removeSession(),{error:n};let{session:s,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return k(e)?{error:e}:{error:new Xt("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var r,n,s;try{await this._removeSession();let o;if("email"in e){let{email:c,password:h,options:d}=e,f=null,y=null;if(this.flowType==="pkce"){let w=mt();await We(this.storage,`${this.storageKey}-code-verifier`,w),f=await yt(w),y=w===f?"plain":"s256"}o=await C(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:c,password:h,data:(r=d?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:y},xform:Oe})}else if("phone"in e){let{phone:c,password:h,options:d}=e;o=await C(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(n=d?.data)!==null&&n!==void 0?n:{},channel:(s=d?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Oe})}else throw new gt("You must provide either an email or phone number and a password");let{data:i,error:a}=o;if(a||!i)return{data:{user:null,session:null},error:a};let l=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(o){if(k(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{await this._removeSession();let r;if("email"in e){let{email:o,password:i,options:a}=e;r=await C(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Oe})}else if("phone"in e){let{phone:o,password:i,options:a}=e;r=await C(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Oe})}else throw new gt("You must provide either an email or phone number and a password");let{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Yt}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:{user:n.user,session:n.session},error:s})}catch(r){if(k(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,s,o;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){let r=await Nr(this.storage,`${this.storageKey}-code-verifier`),{data:n,error:s}=await C(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Oe});return await is(this.storage,`${this.storageKey}-code-verifier`),s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Yt}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:n,error:s})}async signInWithIdToken(e){await this._removeSession();try{let{options:r,provider:n,token:s,access_token:o,nonce:i}=e,a=await C(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Oe}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Yt}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(r){if(k(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,s,o,i;try{if(await this._removeSession(),"email"in e){let{email:a,options:l}=e,u=null,c=null;if(this.flowType==="pkce"){let d=mt();await We(this.storage,`${this.storageKey}-code-verifier`,d),u=await yt(d),c=d===u?"plain":"s256"}let{error:h}=await C(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){let{phone:a,options:l}=e,{data:u,error:c}=await C(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l?.data)!==null&&s!==void 0?s:{},create_user:(o=l?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(i=l?.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u?.message_id},error:c}}throw new gt("You must provide either an email or phone number.")}catch(a){if(k(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,n;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let s,o;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,o=(n=e.options)===null||n===void 0?void 0:n.captchaToken);let{data:i,error:a}=await C(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:Oe});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");let l=i.session,u=i.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(k(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var r,n,s;try{await this._removeSession();let o=null,i=null;if(this.flowType==="pkce"){let a=mt();await We(this.storage,`${this.storageKey}-code-verifier`,a),o=await yt(a),i=a===o?"plain":"s256"}return await C(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:i}),headers:this.headers,xform:Su})}catch(o){if(k(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Ae;let{error:s}=await C(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(k(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();let r=`${this.url}/resend`;if("email"in e){let{email:n,type:s,options:o}=e,{error:i}=await C(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){let{phone:n,type:s,options:o}=e,{data:i,error:a}=await C(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:i?.message_id},error:a}}throw new gt("You must provide either an email or phone number and a type")}catch(r){if(k(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){let s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null,r=await Nr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let n=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n)return{data:{session:e},error:null};let{session:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await C(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:xe}):await this._useSession(async r=>{var n,s;let{data:o,error:i}=r;if(i)throw i;return await C(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0,xform:xe})})}catch(r){if(k(r))return{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{let{data:s,error:o}=n;if(o)throw o;if(!s.session)throw new Ae;let i=s.session,a=null,l=null;if(this.flowType==="pkce"&&e.email!=null){let h=mt();await We(this.storage,`${this.storageKey}-code-verifier`,h),a=await yt(h),l=h===a?"plain":"s256"}let{data:u,error:c}=await C(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:i.access_token,xform:xe});if(c)throw c;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(k(n))return{data:{user:null},error:n};throw n}}_decodeJWT(e){return Ao(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ae;let r=Date.now()/1e3,n=r,s=!0,o=null,i=Ao(e.access_token);if(i.exp&&(n=i.exp,s=n<=r),s){let{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};o=a}else{let{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;o={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(k(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){let{data:i,error:a}=r;if(a)throw a;e=(n=i.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new Ae;let{session:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(k(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e){try{if(!be())throw new wt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new wt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Mr("Not a valid PKCE flow url.");let r=ss(window.location.href);if(e){if(!r.code)throw new Mr("No code detected.");let{data:K,error:ee}=await this._exchangeCodeForSession(r.code);if(ee)throw ee;let j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:K.session,redirectType:null},error:null}}if(r.error||r.error_description||r.error_code)throw new wt(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});let{provider_token:n,provider_refresh_token:s,access_token:o,refresh_token:i,expires_in:a,expires_at:l,token_type:u}=r;if(!o||!a||!i||!u)throw new wt("No session defined in URL");let c=Math.round(Date.now()/1e3),h=parseInt(a),d=c+h;l&&(d=parseInt(l));let f=d-c;f*1e3<=Hr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);let y=d-h;c-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,d,c):c-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",y,d,c);let{data:w,error:x}=await this._getUser(o);if(x)throw x;let q={provider_token:n,provider_refresh_token:s,access_token:o,expires_in:h,expires_at:d,refresh_token:i,token_type:u,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:q,redirectType:r.type},error:null}}catch(r){if(k(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantFlow(){let e=ss(window.location.href);return!!(be()&&(e.access_token||e.error_description))}async _isPKCEFlow(){let e=ss(window.location.href),r=await Nr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;let{data:s,error:o}=r;if(o)return{error:o};let i=(n=s.session)===null||n===void 0?void 0:n.access_token;if(i){let{error:a}=await this.admin.signOut(i,e);if(a&&!(bu(a)&&(a.status===404||a.status===401)))return{error:a}}return e!=="others"&&(await this._removeSession(),await is(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){let r=gu(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{let{data:{session:o},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;if(this.flowType==="pkce"){let o=mt();await We(this.storage,`${this.storageKey}-code-verifier`,o),n=await yt(o),s=o===n?"plain":"s256"}try{return await C(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(k(o))return{data:null,error:o};throw o}}async _refreshAccessToken(e){let r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{let n=Date.now();return await vu(async s=>(await _u(s*200),this._debug(r,"refreshing attempt",s),await C(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Oe})),(s,o,i)=>i&&i.error&&Oo(i.error)&&Date.now()+(s+1)*200-n<Hr)}catch(n){if(this._debug(r,"error",n),k(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){let n=await this._getUrlForProvider(e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),be()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let n=await Nr(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}let s=Math.round(Date.now()/1e3),o=((e=n.expires_at)!==null&&e!==void 0?e:1/0)<s+qo;if(this._debug(r,`session has${o?"":" not"} expired with margin of ${qo}s`),o){if(this.autoRefreshToken&&n.refresh_token){let{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Oo(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Ae;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Fr;let{data:o,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!o.session)throw new Ae;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);let a={session:o.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(o){if(this._debug(s,"error",o),k(o)){let i={session:null,error:o};return(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){let s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});let o=[],i=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){o.push(l)}});if(await Promise.all(i),o.length>0){for(let a=0;a<o.length;a+=1)console.error(o[a]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await this._persistSession(e)}_persistSession(e){return this._debug("#_persistSession()",e),We(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await is(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&be()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),Hr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async r=>{let{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let s=Math.floor((n.expires_at*1e3-e)/Hr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Hr}ms, refresh threshold is ${Au} ticks`),s<=Au&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof us)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!be()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r){let n=[`provider=${encodeURIComponent(e)}`];if(r?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){let s=mt();await We(this.storage,`${this.storageKey}-code-verifier`,s);let o=await yt(s),i=s===o?"plain":"s256";this._debug("PKCE","code verifier",`${s.substring(0,5)}...`,"code challenge",o,"method",i);let a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(a.toString())}if(r?.queryParams){let s=new URLSearchParams(r.queryParams);n.push(s.toString())}return`${this.url}/authorize?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;let{data:s,error:o}=r;return o?{data:null,error:o}:await C(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(k(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;let{data:o,error:i}=r;if(i)return{data:null,error:i};let{data:a,error:l}=await C(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(!((s=a?.totp)===null||s===void 0)&&s.qr_code&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(r){if(k(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;let{data:s,error:o}=r;if(o)return{data:null,error:o};let{data:i,error:a}=await C(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})})}catch(r){if(k(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;let{data:s,error:o}=r;return o?{data:null,error:o}:await C(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(k(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){let{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){let{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};let n=e?.factors||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified");return{data:{all:n,totp:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;let{data:{session:s},error:o}=e;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let i=this._decodeJWT(s.access_token),a=null;i.aal&&(a=i.aal);let l=a;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");let c=i.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}};_t.nextInstanceID=0;var cs=class extends _t{constructor(e){super(e)}};var $p=function(t,e,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function a(c){try{u(n.next(c))}catch(h){i(h)}}function l(c){try{u(n.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((n=n.apply(t,e||[])).next())})},jp={headers:du},Lp={schema:"public"},Up={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Fp={},Vr=class{constructor(e,r,n){var s,o,i,a,l,u,c,h;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");let d=pu(e);this.realtimeUrl=`${d}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${d}/auth/v1`,this.storageUrl=`${d}/storage/v1`,this.functionsUrl=`${d}/functions/v1`;let f=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,y={db:Lp,realtime:Fp,auth:Object.assign(Object.assign({},Up),{storageKey:f}),global:jp},w=mu(n??{},y);this.storageKey=(o=(s=w.auth)===null||s===void 0?void 0:s.storageKey)!==null&&o!==void 0?o:"",this.headers=(a=(i=w.global)===null||i===void 0?void 0:i.headers)!==null&&a!==void 0?a:{},this.auth=this._initSupabaseAuthClient((l=w.auth)!==null&&l!==void 0?l:{},this.headers,(u=w.global)===null||u===void 0?void 0:u.fetch),this.fetch=fu(r,this._getAccessToken.bind(this),(c=w.global)===null||c===void 0?void 0:c.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},w.realtime)),this.rest=new Vt(`${d}/rest/v1`,{headers:this.headers,schema:(h=w.db)===null||h===void 0?void 0:h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Ir(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Lr(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return $p(this,void 0,void 0,function*(){let{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:o,flowType:i,debug:a},l,u){let c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new cs({url:this.authUrl,headers:Object.assign(Object.assign({},c),l),storageKey:o,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,flowType:i,debug:a,fetch:u})}_initRealtimeClient(e){return new Gt(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.realtime.setAuth(n??null),this.changedAccessToken=n):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var Ou=(t,e,r)=>new Vr(t,e,r);var Np=class{_client;constructor({url:t,key:e,options:r}){this._client=Ou(t,e,r)}get client(){return this._client}};function qu(t){let e=new Np(t);return new Proxy(e,{get(r,n){if(Reflect.has(r,n))return Reflect.get(r,n);if(Reflect.has(r.client,n)){let s=Reflect.get(r.client,n);return typeof s=="function"?s.bind(r.client):s}}})}async function $u(t,e){let r=t.headers.get("Cookie");if(!r)return e?null:{};let n=r.split(";");if(e){for(let s of n){let[o,i]=s.split("=").map(a=>a.trim());if(o===e)return i}return null}else return n.reduce((s,o)=>{let[i,a]=o.split("=").map(l=>l.trim());return s[i]=a,s},{})}var hv=ye(Kr());var jo={supabase:{url:"",key:""},turso:{host:"",token:""}};(async function(){try{let t=new Ba({basePath:"/"});t.use("*",(e,r,n)=>(console.log("Global middleware"),e.method.toUpperCase()==="OPTIONS"?new Response("CORS preflight response"):(r.user={name:"horos",id:1},n()))),t.get("/",async(e,r)=>{let{Welcome:n}=await Promise.resolve().then(()=>(Lu(),ju));return t.render(n)}),t.get("/context",async(e,r)=>new Response(JSON.stringify(r.user))),t.use("*",async(e,r,n)=>(e.url.endsWith("turso")&&console.log("turso-specific middleware"),n())),t.get("/turso",async(e,r)=>{let s=await new Nl(jo.turso).execute("SELECT * FROM users");return new Response(JSON.stringify(s))}),t.get("/cookies",async(e,r)=>{let n=$u(e);return new Response(JSON.stringify(n))}),t.get("/supabase",async(e,r)=>{let n=new qu(jo.supabase),{data:s,error:o}=await n.from("YOUR_TABLE_NAME").select("*");return new Response(JSON.stringify(s))}),t.get("/musico/:zappa{.+.png$}",async(e,r)=>t.redirect("https://upload.wikimedia.org/wikipedia/commons/c/c4/Zappa_16011977_01_300.jpg")),t.get("/pagina/:id",async(e,r)=>{let n=e.params.id,s=e.query.sort,o=`
    <html>
      <body>
        <h1>User ID: ${n}</h1>
        <p>Sort By: ${s}</p>
      </body>
    </html>`;return t.render(o)}),t.get("/jsx",async(e,r)=>{function n(i){return i.firstName+" "+i.lastName}let o=`<h1> Hello, ${n({firstName:"Bilbo",lastName:"Bolseiro"})}! </h1>`;return t.render(o)}),t.get("/cookies",async(e,r)=>{let n=e.query.name,s=e.getCookie(n),o=new Response(JSON.stringify(s));return o=deleteCookie(o,{name:"horos"}),o}),t.get("/app-routes",async(e,r)=>{let n=t.getRoutes();return new Response(JSON.stringify(n))}),t.onNotFound(e=>{let r="<h1>404 Not Found</h1>";return t.render(r)}),t.get("/broke",async(e,r)=>{throw new Error("custom error message")}),t.onError(e=>{console.log("Global Error Handler:",e)}),t.listen("fetch")}catch(t){return new Response(t.message||t.toString(),{status:500})}})();})();
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom-server-legacy.browser.production.min.js:
  (**
   * @license React
   * react-dom-server-legacy.browser.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom-server.browser.production.min.js:
  (**
   * @license React
   * react-dom-server.browser.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
